diff --git a/bin/syncqt b/bin/syncqt
index bc2ccf3..8b4ce6f 100755
--- a/bin/syncqt
+++ b/bin/syncqt
@@ -992,7 +992,11 @@ foreach my $lib (@modules_to_sync) {
                         my $header_copies = 0;
                         #figure out if it is a public header
                         my $public_header = $header;
-                        if($allheadersprivate || $public_header =~ /_p.h$/ || $public_header =~ /_pch.h$/) {
+                        my $qpa_header = 0;
+                        if($public_header =~ /^qplatform/) {
+                            $public_header = 0;
+                            $qpa_header = 1;
+                        } elsif($allheadersprivate || $public_header =~ /_p.h$/ || $public_header =~ /_pch.h$/) {
                             $public_header = 0;
                         } else {
                             foreach (@ignore_for_master_contents) {
@@ -1040,13 +1044,20 @@ foreach my $lib (@modules_to_sync) {
                                     $header_copies++ if(syncHeader($lib, "$out_basedir/include/$lib/$explicitheaders{$lib}{basename($header)}", "$out_basedir/include/$lib/$header", 0, $ts));
                                 }
 
-                            } elsif ($create_private_headers) {
+                            } elsif ($create_private_headers && !$qpa_header) {
                                 if ($module_version) {
                                     @headers = ( "$out_basedir/include/$lib/$module_version/$lib/private/$header" );
                                 } else {
                                     @headers = ( "$out_basedir/include/$lib/private/$header" );
                                 }
+                            } elsif ($create_private_headers) {
+                                if ($module_version) {
+                                    @headers = ( "$out_basedir/include/$lib/$module_version/$lib/qpa/$header" );
+                                } else {
+                                    @headers = ( "$out_basedir/include/$lib/qpa/$header" );
+                                }
                             }
+
                             foreach(@headers) { #sync them
                                 $header_copies++ if(syncHeader($lib, $_, $iheader, $copy_headers && !$shadow, $ts));
                             }
@@ -1317,6 +1328,8 @@ if($check_includes) {
                         my $public_header = $header;
                         if($public_header =~ /_p.h$/ || $public_header =~ /_pch.h$/) {
                             $public_header = 0;
+                        } elsif ($public_header =~ /^qplatform/) {
+                            $public_header = 0;
                         } else {
                             foreach (@ignore_for_master_contents) {
                                 $public_header = 0 if($header eq $_);
diff --git a/examples/opengl/hellowindow/main.cpp b/examples/opengl/hellowindow/main.cpp
index 9723e8f..e1fde9b 100644
--- a/examples/opengl/hellowindow/main.cpp
+++ b/examples/opengl/hellowindow/main.cpp
@@ -39,7 +39,7 @@
 ****************************************************************************/
 
 #include <QGuiApplication>
-#include <QPlatformIntegration>
+#include <qpa/qplatformintegration.h>
 #include <private/qguiapplication_p.h>
 #include <QScreen>
 #include <QThread>
diff --git a/src/gui/accessible/accessible.pri b/src/gui/accessible/accessible.pri
index 70ac033..abffa2a 100644
--- a/src/gui/accessible/accessible.pri
+++ b/src/gui/accessible/accessible.pri
@@ -6,7 +6,7 @@ contains(QT_CONFIG, accessibility) {
         accessible/qaccessible2.h \
         accessible/qaccessibleobject.h \
         accessible/qaccessibleplugin.h \
-        accessible/qplatformaccessibility_qpa.h
+        accessible/qplatformaccessibility.h
 
     SOURCES += accessible/qaccessible.cpp \
         accessible/qaccessible2.cpp \
diff --git a/src/gui/accessible/qaccessible.cpp b/src/gui/accessible/qaccessible.cpp
index 0231846..af75693 100644
--- a/src/gui/accessible/qaccessible.cpp
+++ b/src/gui/accessible/qaccessible.cpp
@@ -48,8 +48,8 @@
 #include "qaccessiblebridge.h"
 #include <QtGui/QGuiApplication>
 #include <private/qguiapplication_p.h>
-#include "qplatformaccessibility_qpa.h"
-#include "qplatformintegration_qpa.h"
+#include <qpa/qplatformaccessibility.h>
+#include <qpa/qplatformintegration.h>
 
 #include <QtCore/qdebug.h>
 #include <QtCore/qmetaobject.h>
diff --git a/src/gui/accessible/qplatformaccessibility.h b/src/gui/accessible/qplatformaccessibility.h
new file mode 100644
index 0000000..b1efd7c
--- /dev/null
+++ b/src/gui/accessible/qplatformaccessibility.h
@@ -0,0 +1,84 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+#ifndef QPLATFORMACCESSIBILITY_H
+#define QPLATFORMACCESSIBILITY_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qobject.h>
+#ifndef QT_NO_ACCESSIBILITY
+
+#include <QtGui/qaccessible.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class Q_GUI_EXPORT QPlatformAccessibility
+{
+public:
+    QPlatformAccessibility();
+
+    virtual ~QPlatformAccessibility();
+    virtual void notifyAccessibilityUpdate(QAccessibleEvent *event);
+    virtual void setRootObject(QObject *o);
+    virtual void initialize();
+    virtual void cleanup();
+
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QT_NO_ACCESSIBILITY
+
+#endif // QPLATFORMACCESSIBILITY_H
diff --git a/src/gui/accessible/qplatformaccessibility_qpa.cpp b/src/gui/accessible/qplatformaccessibility_qpa.cpp
index 91b5de1..7ea5a5d 100644
--- a/src/gui/accessible/qplatformaccessibility_qpa.cpp
+++ b/src/gui/accessible/qplatformaccessibility_qpa.cpp
@@ -38,7 +38,7 @@
 ** $QT_END_LICENSE$
 **
 ****************************************************************************/
-#include "qplatformaccessibility_qpa.h"
+#include "qplatformaccessibility.h"
 #include <private/qfactoryloader_p.h>
 #include "qaccessibleplugin.h"
 #include "qaccessibleobject.h"
diff --git a/src/gui/accessible/qplatformaccessibility_qpa.h b/src/gui/accessible/qplatformaccessibility_qpa.h
deleted file mode 100644
index b1efd7c..0000000
--- a/src/gui/accessible/qplatformaccessibility_qpa.h
+++ /dev/null
@@ -1,84 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-#ifndef QPLATFORMACCESSIBILITY_H
-#define QPLATFORMACCESSIBILITY_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qobject.h>
-#ifndef QT_NO_ACCESSIBILITY
-
-#include <QtGui/qaccessible.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class Q_GUI_EXPORT QPlatformAccessibility
-{
-public:
-    QPlatformAccessibility();
-
-    virtual ~QPlatformAccessibility();
-    virtual void notifyAccessibilityUpdate(QAccessibleEvent *event);
-    virtual void setRootObject(QObject *o);
-    virtual void initialize();
-    virtual void cleanup();
-
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QT_NO_ACCESSIBILITY
-
-#endif // QPLATFORMACCESSIBILITY_H
diff --git a/src/gui/image/image.pri b/src/gui/image/image.pri
index 34a33aa..737b7fc 100644
--- a/src/gui/image/image.pri
+++ b/src/gui/image/image.pri
@@ -21,7 +21,7 @@ HEADERS += \
         image/qpixmap_blitter_p.h \
         image/qpixmapcache.h \
         image/qpixmapcache_p.h \
-        image/qplatformpixmap_qpa.h \
+        image/qplatformpixmap.h \
         image/qimagepixmapcleanuphooks_p.h \
 
 SOURCES += \
diff --git a/src/gui/image/qbitmap.cpp b/src/gui/image/qbitmap.cpp
index f3c26dd..499f9f4 100644
--- a/src/gui/image/qbitmap.cpp
+++ b/src/gui/image/qbitmap.cpp
@@ -40,8 +40,8 @@
 ****************************************************************************/
 
 #include "qbitmap.h"
-#include "qplatformpixmap_qpa.h"
-#include "qplatformintegration_qpa.h"
+#include <qpa/qplatformpixmap.h>
+#include <qpa/qplatformintegration.h>
 #include "qimage.h"
 #include "qscreen.h"
 #include "qvariant.h"
diff --git a/src/gui/image/qimage.cpp b/src/gui/image/qimage.cpp
index b8ec7de..91b2122 100644
--- a/src/gui/image/qimage.cpp
+++ b/src/gui/image/qimage.cpp
@@ -50,13 +50,13 @@
 #include "qstringlist.h"
 #include "qvariant.h"
 #include "qimagepixmapcleanuphooks_p.h"
-#include "qplatformintegration_qpa.h"
+#include <qpa/qplatformintegration.h>
 #include <private/qguiapplication_p.h>
 #include <ctype.h>
 #include <stdlib.h>
 #include <limits.h>
 #include <math.h>
-#include <qplatformpixmap_qpa.h>
+#include <qpa/qplatformpixmap.h>
 #include <private/qdrawhelper_p.h>
 #include <private/qmemrotate_p.h>
 #include <private/qimagescale_p.h>
diff --git a/src/gui/image/qimagepixmapcleanuphooks.cpp b/src/gui/image/qimagepixmapcleanuphooks.cpp
index b118f5f..5489348 100644
--- a/src/gui/image/qimagepixmapcleanuphooks.cpp
+++ b/src/gui/image/qimagepixmapcleanuphooks.cpp
@@ -40,7 +40,7 @@
 ****************************************************************************/
 
 #include "qimagepixmapcleanuphooks_p.h"
-#include "qplatformpixmap_qpa.h"
+#include <qpa/qplatformpixmap.h>
 #include "private/qimage_p.h"
 
 
diff --git a/src/gui/image/qnativeimage.cpp b/src/gui/image/qnativeimage.cpp
index 96d7a04..c562b0b 100644
--- a/src/gui/image/qnativeimage.cpp
+++ b/src/gui/image/qnativeimage.cpp
@@ -41,7 +41,7 @@
 
 #include <qdebug.h>
 #include "qnativeimage_p.h"
-#include "qplatformscreen_qpa.h"
+#include <qpa/qplatformscreen.h>
 #include "private/qguiapplication_p.h"
 #include "qscreen.h"
 
diff --git a/src/gui/image/qpixmap.cpp b/src/gui/image/qpixmap.cpp
index cefb8ed..248caf7 100644
--- a/src/gui/image/qpixmap.cpp
+++ b/src/gui/image/qpixmap.cpp
@@ -42,7 +42,7 @@
 #include <qglobal.h>
 
 #include "qpixmap.h"
-#include "qplatformpixmap_qpa.h"
+#include <qpa/qplatformpixmap.h>
 #include "qimagepixmapcleanuphooks_p.h"
 
 #include "qbitmap.h"
@@ -63,7 +63,7 @@
 #include "qthread.h"
 #include "qdebug.h"
 
-# include "qplatformintegration_qpa.h"
+#include <qpa/qplatformintegration.h>
 
 #include "qpixmap_raster_p.h"
 #include "private/qhexstring_p.h"
diff --git a/src/gui/image/qpixmap_blitter_p.h b/src/gui/image/qpixmap_blitter_p.h
index 9539737..174277f 100644
--- a/src/gui/image/qpixmap_blitter_p.h
+++ b/src/gui/image/qpixmap_blitter_p.h
@@ -42,7 +42,7 @@
 #ifndef QPIXMAP_BLITTER_P_H
 #define QPIXMAP_BLITTER_P_H
 
-#include <qplatformpixmap_qpa.h>
+#include <qpa/qplatformpixmap.h>
 #include <private/qpaintengine_blitter_p.h>
 
 #ifndef QT_NO_BLITTABLE
diff --git a/src/gui/image/qpixmap_raster_p.h b/src/gui/image/qpixmap_raster_p.h
index 864fad4..8e1a8cc 100644
--- a/src/gui/image/qpixmap_raster_p.h
+++ b/src/gui/image/qpixmap_raster_p.h
@@ -53,7 +53,7 @@
 // We mean it.
 //
 
-#include <QtGui/qplatformpixmap_qpa.h>
+#include <qpa/qplatformpixmap.h>
 
 
 QT_BEGIN_NAMESPACE
diff --git a/src/gui/image/qpixmap_win.cpp b/src/gui/image/qpixmap_win.cpp
index 66a829f..c25393c 100644
--- a/src/gui/image/qpixmap_win.cpp
+++ b/src/gui/image/qpixmap_win.cpp
@@ -40,7 +40,7 @@
 ****************************************************************************/
 
 #include "qpixmap.h"
-#include "qplatformpixmap_qpa.h"
+#include <qpa/qplatformpixmap.h>
 #include "qpixmap_raster_p.h"
 
 #include <qglobal.h>
diff --git a/src/gui/image/qplatformpixmap.cpp b/src/gui/image/qplatformpixmap.cpp
index 073c267..769cf5f 100644
--- a/src/gui/image/qplatformpixmap.cpp
+++ b/src/gui/image/qplatformpixmap.cpp
@@ -39,8 +39,8 @@
 **
 ****************************************************************************/
 
-#include "qplatformpixmap_qpa.h"
-#include "qplatformintegration_qpa.h"
+#include "qplatformpixmap.h"
+#include <qpa/qplatformintegration.h>
 #include <QtCore/qbuffer.h>
 #include <QtGui/qbitmap.h>
 #include <QtGui/qimagereader.h>
diff --git a/src/gui/image/qplatformpixmap.h b/src/gui/image/qplatformpixmap.h
new file mode 100644
index 0000000..154c507
--- /dev/null
+++ b/src/gui/image/qplatformpixmap.h
@@ -0,0 +1,162 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPIXMAPDATA_P_H
+#define QPIXMAPDATA_P_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtGui/qpixmap.h>
+#include <QtCore/qatomic.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QImageReader;
+
+class Q_GUI_EXPORT QPlatformPixmap
+{
+public:
+    enum PixelType {
+        // WARNING: Do not change the first two
+        // Must match QPixmap::Type
+        PixmapType, BitmapType
+    };
+
+    enum ClassId { RasterClass, DirectFBClass,
+                   BlitterClass, CustomClass = 1024 };
+
+    QPlatformPixmap(PixelType pixelType, int classId);
+    virtual ~QPlatformPixmap();
+
+    virtual QPlatformPixmap *createCompatiblePlatformPixmap() const;
+
+    virtual void resize(int width, int height) = 0;
+    virtual void fromImage(const QImage &image,
+                           Qt::ImageConversionFlags flags) = 0;
+    virtual void fromImageReader(QImageReader *imageReader,
+                                 Qt::ImageConversionFlags flags);
+
+    virtual bool fromFile(const QString &filename, const char *format,
+                          Qt::ImageConversionFlags flags);
+    virtual bool fromData(const uchar *buffer, uint len, const char *format,
+                          Qt::ImageConversionFlags flags);
+
+    virtual void copy(const QPlatformPixmap *data, const QRect &rect);
+    virtual bool scroll(int dx, int dy, const QRect &rect);
+
+    virtual int metric(QPaintDevice::PaintDeviceMetric metric) const = 0;
+    virtual void fill(const QColor &color) = 0;
+
+    virtual bool hasAlphaChannel() const = 0;
+    virtual QPixmap transformed(const QTransform &matrix,
+                                Qt::TransformationMode mode) const;
+
+    virtual QImage toImage() const = 0;
+    virtual QImage toImage(const QRect &rect) const;
+    virtual QPaintEngine* paintEngine() const = 0;
+
+    inline int serialNumber() const { return ser_no; }
+
+    inline PixelType pixelType() const { return type; }
+    inline ClassId classId() const { return static_cast<ClassId>(id); }
+
+    virtual QImage* buffer();
+
+    inline int width() const { return w; }
+    inline int height() const { return h; }
+    inline int colorCount() const { return metric(QPaintDevice::PdmNumColors); }
+    inline int depth() const { return d; }
+    inline bool isNull() const { return is_null; }
+    inline qint64 cacheKey() const {
+        int classKey = id;
+        if (classKey >= 1024)
+            classKey = -(classKey >> 10);
+        return ((((qint64) classKey) << 56)
+                | (((qint64) ser_no) << 32)
+                | ((qint64) detach_no));
+    }
+
+    static QPlatformPixmap *create(int w, int h, PixelType type);
+
+protected:
+
+    void setSerialNumber(int serNo);
+    int w;
+    int h;
+    int d;
+    bool is_null;
+
+private:
+    friend class QPixmap;
+    friend class QImagePixmapCleanupHooks; // Needs to set is_cached
+    friend class QOpenGLTextureCache; //Needs to check the reference count
+    friend class QExplicitlySharedDataPointer<QPlatformPixmap>;
+
+    QAtomicInt ref;
+    int detach_no;
+
+    PixelType type;
+    int id;
+    int ser_no;
+    uint is_cached;
+};
+
+#  define QT_XFORM_TYPE_MSBFIRST 0
+#  define QT_XFORM_TYPE_LSBFIRST 1
+extern bool qt_xForm_helper(const QTransform&, int, int, int, uchar*, int, int, int, const uchar*, int, int, int);
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPIXMAPDATA_P_H
diff --git a/src/gui/image/qplatformpixmap_qpa.h b/src/gui/image/qplatformpixmap_qpa.h
deleted file mode 100644
index 154c507..0000000
--- a/src/gui/image/qplatformpixmap_qpa.h
+++ /dev/null
@@ -1,162 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPIXMAPDATA_P_H
-#define QPIXMAPDATA_P_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtGui/qpixmap.h>
-#include <QtCore/qatomic.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QImageReader;
-
-class Q_GUI_EXPORT QPlatformPixmap
-{
-public:
-    enum PixelType {
-        // WARNING: Do not change the first two
-        // Must match QPixmap::Type
-        PixmapType, BitmapType
-    };
-
-    enum ClassId { RasterClass, DirectFBClass,
-                   BlitterClass, CustomClass = 1024 };
-
-    QPlatformPixmap(PixelType pixelType, int classId);
-    virtual ~QPlatformPixmap();
-
-    virtual QPlatformPixmap *createCompatiblePlatformPixmap() const;
-
-    virtual void resize(int width, int height) = 0;
-    virtual void fromImage(const QImage &image,
-                           Qt::ImageConversionFlags flags) = 0;
-    virtual void fromImageReader(QImageReader *imageReader,
-                                 Qt::ImageConversionFlags flags);
-
-    virtual bool fromFile(const QString &filename, const char *format,
-                          Qt::ImageConversionFlags flags);
-    virtual bool fromData(const uchar *buffer, uint len, const char *format,
-                          Qt::ImageConversionFlags flags);
-
-    virtual void copy(const QPlatformPixmap *data, const QRect &rect);
-    virtual bool scroll(int dx, int dy, const QRect &rect);
-
-    virtual int metric(QPaintDevice::PaintDeviceMetric metric) const = 0;
-    virtual void fill(const QColor &color) = 0;
-
-    virtual bool hasAlphaChannel() const = 0;
-    virtual QPixmap transformed(const QTransform &matrix,
-                                Qt::TransformationMode mode) const;
-
-    virtual QImage toImage() const = 0;
-    virtual QImage toImage(const QRect &rect) const;
-    virtual QPaintEngine* paintEngine() const = 0;
-
-    inline int serialNumber() const { return ser_no; }
-
-    inline PixelType pixelType() const { return type; }
-    inline ClassId classId() const { return static_cast<ClassId>(id); }
-
-    virtual QImage* buffer();
-
-    inline int width() const { return w; }
-    inline int height() const { return h; }
-    inline int colorCount() const { return metric(QPaintDevice::PdmNumColors); }
-    inline int depth() const { return d; }
-    inline bool isNull() const { return is_null; }
-    inline qint64 cacheKey() const {
-        int classKey = id;
-        if (classKey >= 1024)
-            classKey = -(classKey >> 10);
-        return ((((qint64) classKey) << 56)
-                | (((qint64) ser_no) << 32)
-                | ((qint64) detach_no));
-    }
-
-    static QPlatformPixmap *create(int w, int h, PixelType type);
-
-protected:
-
-    void setSerialNumber(int serNo);
-    int w;
-    int h;
-    int d;
-    bool is_null;
-
-private:
-    friend class QPixmap;
-    friend class QImagePixmapCleanupHooks; // Needs to set is_cached
-    friend class QOpenGLTextureCache; //Needs to check the reference count
-    friend class QExplicitlySharedDataPointer<QPlatformPixmap>;
-
-    QAtomicInt ref;
-    int detach_no;
-
-    PixelType type;
-    int id;
-    int ser_no;
-    uint is_cached;
-};
-
-#  define QT_XFORM_TYPE_MSBFIRST 0
-#  define QT_XFORM_TYPE_LSBFIRST 1
-extern bool qt_xForm_helper(const QTransform&, int, int, int, uchar*, int, int, int, const uchar*, int, int, int);
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPIXMAPDATA_P_H
diff --git a/src/gui/kernel/kernel.pri b/src/gui/kernel/kernel.pri
index 3c1b6b4..525871c 100644
--- a/src/gui/kernel/kernel.pri
+++ b/src/gui/kernel/kernel.pri
@@ -10,27 +10,27 @@ HEADERS += \
         kernel/qgenericplugin_qpa.h \
         kernel/qwindowsysteminterface_qpa.h \
         kernel/qwindowsysteminterface_qpa_p.h \
-        kernel/qplatformintegration_qpa.h \
-        kernel/qplatformdrag_qpa.h \
-        kernel/qplatformscreen_qpa.h \
-        kernel/qplatformscreen_qpa_p.h \
-        kernel/qplatforminputcontext_qpa.h \
-        kernel/qplatforminputcontext_qpa_p.h \
-        kernel/qplatformintegrationfactory_qpa_p.h \
-        kernel/qplatformintegrationplugin_qpa.h \
-        kernel/qplatformtheme_qpa.h\
-        kernel/qplatformthemefactory_qpa_p.h \
-        kernel/qplatformthemeplugin_qpa.h \
-        kernel/qplatformwindow_qpa.h \
-        kernel/qplatformcursor_qpa.h \
-        kernel/qplatformclipboard_qpa.h \
-        kernel/qplatformnativeinterface_qpa.h \
+        kernel/qplatformintegration.h \
+        kernel/qplatformdrag.h \
+        kernel/qplatformscreen.h \
+        kernel/qplatformscreen_p.h \
+        kernel/qplatforminputcontext.h \
+        kernel/qplatforminputcontext_p.h \
+        kernel/qplatformintegrationfactory_p.h \
+        kernel/qplatformintegrationplugin.h \
+        kernel/qplatformtheme.h\
+        kernel/qplatformthemefactory_p.h \
+        kernel/qplatformthemeplugin.h \
+        kernel/qplatformwindow.h \
+        kernel/qplatformcursor.h \
+        kernel/qplatformclipboard.h \
+        kernel/qplatformnativeinterface.h \
         kernel/qsurfaceformat.h \
         kernel/qguiapplication.h \
         kernel/qguiapplication_p.h \
         kernel/qwindow_p.h \
         kernel/qwindow.h \
-        kernel/qplatformsurface_qpa.h \
+        kernel/qplatformsurface.h \
         kernel/qsurface.h \
         kernel/qclipboard.h \
         kernel/qcursor.h \
@@ -55,10 +55,10 @@ HEADERS += \
         kernel/qstylehints.h \
         kernel/qtouchdevice.h \
         kernel/qtouchdevice_p.h \
-        kernel/qplatformsharedgraphicscache_qpa.h \
-        kernel/qplatformdialoghelper_qpa.h \
-        kernel/qplatformservices_qpa.h \
-        kernel/qplatformscreenpageflipper_qpa.h
+        kernel/qplatformsharedgraphicscache.h \
+        kernel/qplatformdialoghelper.h \
+        kernel/qplatformservices.h \
+        kernel/qplatformscreenpageflipper.h
 
 SOURCES += \
         kernel/qclipboard_qpa.cpp \
@@ -107,7 +107,7 @@ SOURCES += \
 
 contains(QT_CONFIG, opengl)|contains(QT_CONFIG, opengles2) {
     HEADERS += \
-            kernel/qplatformopenglcontext_qpa.h \
+            kernel/qplatformopenglcontext.h \
             kernel/qopenglcontext.h \
             kernel/qopenglcontext_p.h
 
diff --git a/src/gui/kernel/qclipboard_qpa.cpp b/src/gui/kernel/qclipboard_qpa.cpp
index 187e092..284775c 100644
--- a/src/gui/kernel/qclipboard_qpa.cpp
+++ b/src/gui/kernel/qclipboard_qpa.cpp
@@ -45,8 +45,8 @@
 
 #include "qmimedata.h"
 #include "private/qguiapplication_p.h"
-#include "qplatformclipboard_qpa.h"
-#include "qplatformintegration_qpa.h"
+#include <qpa/qplatformclipboard.h>
+#include <qpa/qplatformintegration.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/kernel/qcursor_qpa.cpp b/src/gui/kernel/qcursor_qpa.cpp
index 1c719c8..cc9163f 100644
--- a/src/gui/kernel/qcursor_qpa.cpp
+++ b/src/gui/kernel/qcursor_qpa.cpp
@@ -42,7 +42,7 @@
 #include <qcursor.h>
 #include <qscreen.h>
 #include <private/qcursor_p.h>
-#include <qplatformcursor_qpa.h>
+#include <qpa/qplatformcursor.h>
 #include <private/qguiapplication_p.h>
 #include <qbitmap.h>
 
diff --git a/src/gui/kernel/qdnd.cpp b/src/gui/kernel/qdnd.cpp
index 1ed4a96..8182719 100644
--- a/src/gui/kernel/qdnd.cpp
+++ b/src/gui/kernel/qdnd.cpp
@@ -59,8 +59,8 @@
 #include "qimagewriter.h"
 #include "qdebug.h"
 #include <ctype.h>
-#include <qplatformintegration_qpa.h>
-#include <qplatformdrag_qpa.h>
+#include <qpa/qplatformintegration.h>
+#include <qpa/qplatformdrag.h>
 
 #include <private/qguiapplication_p.h>
 
diff --git a/src/gui/kernel/qguiapplication.cpp b/src/gui/kernel/qguiapplication.cpp
index 27e84b7..631592a 100644
--- a/src/gui/kernel/qguiapplication.cpp
+++ b/src/gui/kernel/qguiapplication.cpp
@@ -42,14 +42,14 @@
 #include "qguiapplication.h"
 
 #include "private/qguiapplication_p.h"
-#include "private/qplatformintegrationfactory_qpa_p.h"
+#include <qpa/qplatformintegrationfactory_p.h>
 #include "private/qevent_p.h"
 #include "qfont.h"
-#include "qplatformfontdatabase_qpa.h"
-#include "qplatformwindow_qpa.h"
-#include "qplatformnativeinterface_qpa.h"
-#include "qplatformtheme_qpa.h"
-#include "qplatformintegration_qpa.h"
+#include <qpa/qplatformfontdatabase.h>
+#include <qpa/qplatformwindow.h>
+#include <qpa/qplatformnativeinterface.h>
+#include <qpa/qplatformtheme.h>
+#include <qpa/qplatformintegration.h>
 
 #include <QtCore/QAbstractEventDispatcher>
 #include <QtCore/QVariant>
@@ -64,14 +64,14 @@
 #include <private/qscreen_p.h>
 #include <private/qdrawhelper_p.h>
 
-#include <QtGui/QPlatformIntegration>
+#include <qpa/qplatformintegration.h>
 #include <QtGui/QGenericPluginFactory>
 #include <QtGui/qstylehints.h>
 #include <QtGui/qinputpanel.h>
 #include <QtGui/qpixmapcache.h>
-#include <QtGui/qplatformtheme_qpa.h>
-#include <QtGui/qplatforminputcontext_qpa.h>
-#include <private/qplatforminputcontext_qpa_p.h>
+#include <qpa/qplatformtheme.h>
+#include <qpa/qplatforminputcontext.h>
+#include <qpa/qplatforminputcontext_p.h>
 
 #include <QWindowSystemInterface>
 #include "private/qwindowsysteminterface_qpa_p.h"
@@ -79,11 +79,11 @@
 #include "private/qcursor_p.h"
 
 #include "private/qdnd_p.h"
-#include <private/qplatformthemefactory_qpa_p.h>
-#include "qplatformdrag_qpa.h"
+#include <qpa/qplatformthemefactory_p.h>
+#include <qpa/qplatformdrag.h>
 
 #ifndef QT_NO_CURSOR
-#include "qplatformcursor_qpa.h"
+#include <qpa/qplatformcursor.h>
 #endif
 
 #include <QtGui/QPixmap>
diff --git a/src/gui/kernel/qguiapplication_p.h b/src/gui/kernel/qguiapplication_p.h
index 78641de..cb3587b 100644
--- a/src/gui/kernel/qguiapplication_p.h
+++ b/src/gui/kernel/qguiapplication_p.h
@@ -53,7 +53,7 @@
 #include "private/qwindowsysteminterface_qpa_p.h"
 #include "private/qshortcutmap_p.h"
 
-#include "qplatformdrag_qpa.h"
+#include <qpa/qplatformdrag.h>
 
 QT_BEGIN_HEADER
 
diff --git a/src/gui/kernel/qinputmethod.cpp b/src/gui/kernel/qinputmethod.cpp
index 0e0bc72..a699938 100644
--- a/src/gui/kernel/qinputmethod.cpp
+++ b/src/gui/kernel/qinputmethod.cpp
@@ -43,7 +43,7 @@
 #include <private/qinputmethod_p.h>
 #include <qguiapplication.h>
 #include <qtimer.h>
-#include <private/qplatforminputcontext_qpa_p.h>
+#include <qpa/qplatforminputcontext_p.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/kernel/qinputmethod_p.h b/src/gui/kernel/qinputmethod_p.h
index 1e55b00..ad3d214 100644
--- a/src/gui/kernel/qinputmethod_p.h
+++ b/src/gui/kernel/qinputmethod_p.h
@@ -46,8 +46,8 @@
 #include <private/qobject_p.h>
 #include <QtCore/QWeakPointer>
 #include <QTransform>
-#include <qplatforminputcontext_qpa.h>
-#include <qplatformintegration_qpa.h>
+#include <qpa/qplatforminputcontext.h>
+#include <qpa/qplatformintegration.h>
 #include <private/qguiapplication_p.h>
 
 QT_BEGIN_HEADER
diff --git a/src/gui/kernel/qkeysequence.cpp b/src/gui/kernel/qkeysequence.cpp
index 4946a1d..e88d901 100644
--- a/src/gui/kernel/qkeysequence.cpp
+++ b/src/gui/kernel/qkeysequence.cpp
@@ -41,7 +41,7 @@
 
 #include "qkeysequence.h"
 #include "qkeysequence_p.h"
-#include "qplatformtheme_qpa.h"
+#include <qpa/qplatformtheme.h>
 #include "private/qguiapplication_p.h"
 
 #ifndef QT_NO_SHORTCUT
diff --git a/src/gui/kernel/qopenglcontext.cpp b/src/gui/kernel/qopenglcontext.cpp
index 4668f9e..b99a4db 100644
--- a/src/gui/kernel/qopenglcontext.cpp
+++ b/src/gui/kernel/qopenglcontext.cpp
@@ -39,8 +39,8 @@
 **
 ****************************************************************************/
 
-#include "qplatformopenglcontext_qpa.h"
-#include "qplatformintegration_qpa.h"
+#include <qpa/qplatformopenglcontext.h>
+#include <qpa/qplatformintegration.h>
 #include "qopenglcontext.h"
 #include "qopenglcontext_p.h"
 #include "qwindow.h"
diff --git a/src/gui/kernel/qplatformclipboard.h b/src/gui/kernel/qplatformclipboard.h
new file mode 100644
index 0000000..95c8103
--- /dev/null
+++ b/src/gui/kernel/qplatformclipboard.h
@@ -0,0 +1,85 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMCLIPBOARD_QPA_H
+#define QPLATFORMCLIPBOARD_QPA_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <qplatformdefs.h>
+
+#ifndef QT_NO_CLIPBOARD
+
+#include <QtGui/QClipboard>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class Q_GUI_EXPORT QPlatformClipboard
+{
+public:
+    virtual ~QPlatformClipboard();
+
+    virtual QMimeData *mimeData(QClipboard::Mode mode = QClipboard::Clipboard);
+    virtual void setMimeData(QMimeData *data, QClipboard::Mode mode = QClipboard::Clipboard);
+    virtual bool supportsMode(QClipboard::Mode mode) const;
+    virtual bool ownsMode(QClipboard::Mode mode) const;
+    void emitChanged(QClipboard::Mode mode);
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QT_NO_CLIPBOARD
+
+#endif //QPLATFORMCLIPBOARD_QPA_H
diff --git a/src/gui/kernel/qplatformclipboard_qpa.cpp b/src/gui/kernel/qplatformclipboard_qpa.cpp
index 7273450..5a29606 100644
--- a/src/gui/kernel/qplatformclipboard_qpa.cpp
+++ b/src/gui/kernel/qplatformclipboard_qpa.cpp
@@ -38,7 +38,7 @@
 ** $QT_END_LICENSE$
 **
 ****************************************************************************/
-#include "qplatformclipboard_qpa.h"
+#include "qplatformclipboard.h"
 
 #ifndef QT_NO_CLIPBOARD
 
diff --git a/src/gui/kernel/qplatformclipboard_qpa.h b/src/gui/kernel/qplatformclipboard_qpa.h
deleted file mode 100644
index 95c8103..0000000
--- a/src/gui/kernel/qplatformclipboard_qpa.h
+++ /dev/null
@@ -1,85 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMCLIPBOARD_QPA_H
-#define QPLATFORMCLIPBOARD_QPA_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <qplatformdefs.h>
-
-#ifndef QT_NO_CLIPBOARD
-
-#include <QtGui/QClipboard>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class Q_GUI_EXPORT QPlatformClipboard
-{
-public:
-    virtual ~QPlatformClipboard();
-
-    virtual QMimeData *mimeData(QClipboard::Mode mode = QClipboard::Clipboard);
-    virtual void setMimeData(QMimeData *data, QClipboard::Mode mode = QClipboard::Clipboard);
-    virtual bool supportsMode(QClipboard::Mode mode) const;
-    virtual bool ownsMode(QClipboard::Mode mode) const;
-    void emitChanged(QClipboard::Mode mode);
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QT_NO_CLIPBOARD
-
-#endif //QPLATFORMCLIPBOARD_QPA_H
diff --git a/src/gui/kernel/qplatformcursor.h b/src/gui/kernel/qplatformcursor.h
new file mode 100644
index 0000000..1f339c8
--- /dev/null
+++ b/src/gui/kernel/qplatformcursor.h
@@ -0,0 +1,111 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtOpenVG module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+#ifndef QPLATFORMCURSOR_QPA_H
+#define QPLATFORMCURSOR_QPA_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/QList>
+#include <QtGui/QImage>
+#include <QtGui/QMouseEvent>
+#include <QtCore/QWeakPointer>
+#include <QtCore/QObject>
+#include <qpa/qplatformscreen.h>
+#include <QtGui/QCursor>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+// Cursor graphics management
+class Q_GUI_EXPORT QPlatformCursorImage {
+public:
+    QPlatformCursorImage(const uchar *data, const uchar *mask, int width, int height, int hotX, int hotY)
+    { set(data, mask, width, height, hotX, hotY); }
+    QImage * image() { return &cursorImage; }
+    QPoint hotspot() const { return hot; }
+    void set(const uchar *data, const uchar *mask, int width, int height, int hotX, int hotY);
+    void set(const QImage &image, int hx, int hy);
+    void set(Qt::CursorShape);
+private:
+    static void createSystemCursor(int id);
+    QImage cursorImage;
+    QPoint hot;
+};
+
+class QPlatformCursor;
+
+class Q_GUI_EXPORT QPlatformCursorPrivate {
+public:
+    static QList<QPlatformCursor *> getInstances();
+};
+
+class Q_GUI_EXPORT QPlatformCursor : public QObject {
+public:
+    QPlatformCursor();
+
+    // input methods
+    virtual void pointerEvent(const QMouseEvent & event) { Q_UNUSED(event); }
+    virtual void changeCursor(QCursor * windowCursor, QWindow * window) = 0;
+    virtual QPoint pos() const;
+    virtual void setPos(const QPoint &pos);
+
+private:
+    Q_DECLARE_PRIVATE(QPlatformCursor)
+    friend void qt_qpa_set_cursor(QWidget * w, bool force);
+    friend class QApplicationPrivate;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMCURSOR_QPA_H
diff --git a/src/gui/kernel/qplatformcursor_qpa.cpp b/src/gui/kernel/qplatformcursor_qpa.cpp
index 5ea080c..40b7967 100644
--- a/src/gui/kernel/qplatformcursor_qpa.cpp
+++ b/src/gui/kernel/qplatformcursor_qpa.cpp
@@ -38,13 +38,13 @@
 ** $QT_END_LICENSE$
 **
 ****************************************************************************/
-#include "qplatformcursor_qpa.h"
+#include "qplatformcursor.h"
 
 #include <QPainter>
 #include <QBitmap>
 #include <QGuiApplication>
 #include <QScreen>
-#include <QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 #include <private/qguiapplication_p.h>
 
 #include <QDebug>
diff --git a/src/gui/kernel/qplatformcursor_qpa.h b/src/gui/kernel/qplatformcursor_qpa.h
deleted file mode 100644
index fb3e460..0000000
--- a/src/gui/kernel/qplatformcursor_qpa.h
+++ /dev/null
@@ -1,111 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtOpenVG module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-#ifndef QPLATFORMCURSOR_QPA_H
-#define QPLATFORMCURSOR_QPA_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/QList>
-#include <QtGui/QImage>
-#include <QtGui/QMouseEvent>
-#include <QtCore/QWeakPointer>
-#include <QtCore/QObject>
-#include <QtGui/QPlatformScreen>
-#include <QtGui/QCursor>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-// Cursor graphics management
-class Q_GUI_EXPORT QPlatformCursorImage {
-public:
-    QPlatformCursorImage(const uchar *data, const uchar *mask, int width, int height, int hotX, int hotY)
-    { set(data, mask, width, height, hotX, hotY); }
-    QImage * image() { return &cursorImage; }
-    QPoint hotspot() const { return hot; }
-    void set(const uchar *data, const uchar *mask, int width, int height, int hotX, int hotY);
-    void set(const QImage &image, int hx, int hy);
-    void set(Qt::CursorShape);
-private:
-    static void createSystemCursor(int id);
-    QImage cursorImage;
-    QPoint hot;
-};
-
-class QPlatformCursor;
-
-class Q_GUI_EXPORT QPlatformCursorPrivate {
-public:
-    static QList<QPlatformCursor *> getInstances();
-};
-
-class Q_GUI_EXPORT QPlatformCursor : public QObject {
-public:
-    QPlatformCursor();
-
-    // input methods
-    virtual void pointerEvent(const QMouseEvent & event) { Q_UNUSED(event); }
-    virtual void changeCursor(QCursor * windowCursor, QWindow * window) = 0;
-    virtual QPoint pos() const;
-    virtual void setPos(const QPoint &pos);
-
-private:
-    Q_DECLARE_PRIVATE(QPlatformCursor)
-    friend void qt_qpa_set_cursor(QWidget * w, bool force);
-    friend class QApplicationPrivate;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMCURSOR_QPA_H
diff --git a/src/gui/kernel/qplatformdialoghelper.h b/src/gui/kernel/qplatformdialoghelper.h
new file mode 100644
index 0000000..5cd3ab0
--- /dev/null
+++ b/src/gui/kernel/qplatformdialoghelper.h
@@ -0,0 +1,320 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMDIALOGHELPER_H
+#define QPLATFORMDIALOGHELPER_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/QtGlobal>
+#include <QtCore/QObject>
+#include <QtCore/QList>
+#include <QtCore/QSharedDataPointer>
+#include <QtCore/QSharedPointer>
+#include <QtCore/QDir>
+#include <QtGui/QRgb>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QString;
+class QColor;
+class QFont;
+class QWindow;
+class QVariant;
+class QUrl;
+class QColorDialogOptionsPrivate;
+class QFontDialogOptionsPrivate;
+class QFileDialogOptionsPrivate;
+
+class Q_GUI_EXPORT QPlatformDialogHelper : public QObject
+{
+    Q_OBJECT
+public:
+    enum StyleHint {
+        SnapToDefaultButton
+    };
+    enum DialogCode { Rejected, Accepted };
+
+    QPlatformDialogHelper();
+    virtual ~QPlatformDialogHelper();
+
+    virtual QVariant styleHint(StyleHint hint) const;
+
+    virtual void platformNativeDialogModalHelp() = 0;
+    virtual void _q_platformRunNativeAppModalPanel() = 0;
+
+    virtual void deleteNativeDialog_sys() = 0;
+    virtual bool show_sys(Qt::WindowFlags windowFlags,
+                          Qt::WindowModality windowModality,
+                          QWindow *parent) = 0;
+    virtual void hide_sys() = 0;
+
+    virtual DialogCode dialogResultCode_sys() = 0;
+
+    static QVariant defaultStyleHint(QPlatformDialogHelper::StyleHint hint);
+
+Q_SIGNALS:
+    void launchNativeAppModalPanel();
+    void accept();
+    void reject();
+
+protected Q_SLOTS:
+    void emitLaunchNativeAppModalPanel();
+};
+
+class Q_GUI_EXPORT QColorDialogOptions
+{
+public:
+    enum ColorDialogOption {
+        ShowAlphaChannel    = 0x00000001,
+        NoButtons           = 0x00000002,
+        DontUseNativeDialog = 0x00000004
+    };
+
+    Q_DECLARE_FLAGS(ColorDialogOptions, ColorDialogOption)
+
+    QColorDialogOptions();
+    QColorDialogOptions(const QColorDialogOptions &rhs);
+    QColorDialogOptions &operator=(const QColorDialogOptions &rhs);
+    ~QColorDialogOptions();
+
+    QString windowTitle() const;
+    void setWindowTitle(const QString &);
+
+    void setOption(ColorDialogOption option, bool on = true);
+    bool testOption(ColorDialogOption option) const;
+    void setOptions(ColorDialogOptions options);
+    ColorDialogOptions options() const;
+
+    static int customColorCount();
+    static QRgb customColor(int index);
+    static QRgb *customColors();
+    static void setCustomColor(int index, QRgb color);
+
+    static QRgb *standardColors();
+    static QRgb standardColor(int index);
+    static void setStandardColor(int index, QRgb color);
+
+private:
+    QSharedDataPointer<QColorDialogOptionsPrivate> d;
+};
+
+class Q_GUI_EXPORT QPlatformColorDialogHelper : public QPlatformDialogHelper
+{
+    Q_OBJECT
+public:
+    const QSharedPointer<QColorDialogOptions> &options() const;
+    void setOptions(const QSharedPointer<QColorDialogOptions> &options);
+
+    virtual void setCurrentColor_sys(const QColor &) = 0;
+    virtual QColor currentColor_sys() const = 0;
+
+Q_SIGNALS:
+    void currentColorChanged(const QColor &color);
+    void colorSelected(const QColor &color);
+
+private:
+    QSharedPointer<QColorDialogOptions> m_options;
+};
+
+class Q_GUI_EXPORT QFontDialogOptions
+{
+public:
+    enum FontDialogOption {
+        NoButtons           = 0x00000001,
+        DontUseNativeDialog = 0x00000002
+    };
+
+    Q_DECLARE_FLAGS(FontDialogOptions, FontDialogOption)
+
+    QFontDialogOptions();
+    QFontDialogOptions(const QFontDialogOptions &rhs);
+    QFontDialogOptions &operator=(const QFontDialogOptions &rhs);
+    ~QFontDialogOptions();
+
+    QString windowTitle() const;
+    void setWindowTitle(const QString &);
+
+    void setOption(FontDialogOption option, bool on = true);
+    bool testOption(FontDialogOption option) const;
+    void setOptions(FontDialogOptions options);
+    FontDialogOptions options() const;
+
+private:
+    QSharedDataPointer<QFontDialogOptionsPrivate> d;
+};
+
+class Q_GUI_EXPORT QPlatformFontDialogHelper : public QPlatformDialogHelper
+{
+    Q_OBJECT
+public:
+    virtual void setCurrentFont_sys(const QFont &) = 0;
+    virtual QFont currentFont_sys() const = 0;
+
+    const QSharedPointer<QFontDialogOptions> &options() const;
+    void setOptions(const QSharedPointer<QFontDialogOptions> &options);
+
+Q_SIGNALS:
+    void currentFontChanged(const QFont &font);
+    void fontSelected(const QFont &font);
+
+private:
+    QSharedPointer<QFontDialogOptions> m_options;
+};
+
+class Q_GUI_EXPORT QFileDialogOptions
+{
+public:
+    enum ViewMode { Detail, List };
+    enum FileMode { AnyFile, ExistingFile, Directory, ExistingFiles, DirectoryOnly };
+    enum AcceptMode { AcceptOpen, AcceptSave };
+    enum DialogLabel { LookIn, FileName, FileType, Accept, Reject, DialogLabelCount };
+
+    enum FileDialogOption
+    {
+        ShowDirsOnly          = 0x00000001,
+        DontResolveSymlinks   = 0x00000002,
+        DontConfirmOverwrite  = 0x00000004,
+        DontUseSheet          = 0x00000008,
+        DontUseNativeDialog   = 0x00000010,
+        ReadOnly              = 0x00000020,
+        HideNameFilterDetails = 0x00000040
+    };
+    Q_DECLARE_FLAGS(FileDialogOptions, FileDialogOption)
+
+    QFileDialogOptions();
+    QFileDialogOptions(const QFileDialogOptions &rhs);
+    QFileDialogOptions &operator=(const QFileDialogOptions &rhs);
+    ~QFileDialogOptions();
+
+    QString windowTitle() const;
+    void setWindowTitle(const QString &);
+
+    void setOption(FileDialogOption option, bool on = true);
+    bool testOption(FileDialogOption option) const;
+    void setOptions(FileDialogOptions options);
+    FileDialogOptions options() const;
+
+    QDir::Filters filter() const;
+    void setFilter(QDir::Filters filters);
+
+    void setViewMode(ViewMode mode);
+    ViewMode viewMode() const;
+
+    void setFileMode(FileMode mode);
+    FileMode fileMode() const;
+
+    void setAcceptMode(AcceptMode mode);
+    AcceptMode acceptMode() const;
+
+    void setSidebarUrls(const QList<QUrl> &urls);
+    QList<QUrl> sidebarUrls() const;
+
+    void setNameFilters(const QStringList &filters);
+    QStringList nameFilters() const;
+
+    void setDefaultSuffix(const QString &suffix);
+    QString defaultSuffix() const;
+
+    void setHistory(const QStringList &paths);
+    QStringList history() const;
+
+    void setLabelText(DialogLabel label, const QString &text);
+    QString labelText(DialogLabel label) const;
+    bool isLabelExplicitlySet(DialogLabel label);
+
+    QString initialDirectory() const;
+    void setInitialDirectory(const QString &);
+
+    QString initiallySelectedNameFilter() const;
+    void setInitiallySelectedNameFilter(const QString &);
+
+    QStringList initiallySelectedFiles() const;
+    void setInitiallySelectedFiles(const QStringList &);
+
+private:
+    QSharedDataPointer<QFileDialogOptionsPrivate> d;
+};
+
+class Q_GUI_EXPORT QPlatformFileDialogHelper : public QPlatformDialogHelper
+{
+    Q_OBJECT
+public:
+    virtual bool defaultNameFilterDisables() const = 0;
+    virtual void setDirectory_sys(const QString &directory) = 0;
+    virtual QString directory_sys() const = 0;
+    virtual void selectFile_sys(const QString &filename) = 0;
+    virtual QStringList selectedFiles_sys() const = 0;
+    virtual void setFilter_sys() = 0;
+    virtual void selectNameFilter_sys(const QString &filter) = 0;
+    virtual QString selectedNameFilter_sys() const = 0;
+
+    const QSharedPointer<QFileDialogOptions> &options() const;
+    void setOptions(const QSharedPointer<QFileDialogOptions> &options);
+
+Q_SIGNALS:
+    void fileSelected(const QString &file);
+    void filesSelected(const QStringList &files);
+    void currentChanged(const QString &path);
+    void directoryEntered(const QString &directory);
+    void filterSelected(const QString &filter);
+
+private:
+    QSharedPointer<QFileDialogOptions> m_options;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMDIALOGHELPER_H
diff --git a/src/gui/kernel/qplatformdialoghelper_qpa.cpp b/src/gui/kernel/qplatformdialoghelper_qpa.cpp
index f2114d1..ec9906c 100644
--- a/src/gui/kernel/qplatformdialoghelper_qpa.cpp
+++ b/src/gui/kernel/qplatformdialoghelper_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformdialoghelper_qpa.h"
+#include "qplatformdialoghelper.h"
 
 #include <QtCore/QVariant>
 #include <QtCore/QSharedData>
diff --git a/src/gui/kernel/qplatformdialoghelper_qpa.h b/src/gui/kernel/qplatformdialoghelper_qpa.h
deleted file mode 100644
index 5cd3ab0..0000000
--- a/src/gui/kernel/qplatformdialoghelper_qpa.h
+++ /dev/null
@@ -1,320 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMDIALOGHELPER_H
-#define QPLATFORMDIALOGHELPER_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/QtGlobal>
-#include <QtCore/QObject>
-#include <QtCore/QList>
-#include <QtCore/QSharedDataPointer>
-#include <QtCore/QSharedPointer>
-#include <QtCore/QDir>
-#include <QtGui/QRgb>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QString;
-class QColor;
-class QFont;
-class QWindow;
-class QVariant;
-class QUrl;
-class QColorDialogOptionsPrivate;
-class QFontDialogOptionsPrivate;
-class QFileDialogOptionsPrivate;
-
-class Q_GUI_EXPORT QPlatformDialogHelper : public QObject
-{
-    Q_OBJECT
-public:
-    enum StyleHint {
-        SnapToDefaultButton
-    };
-    enum DialogCode { Rejected, Accepted };
-
-    QPlatformDialogHelper();
-    virtual ~QPlatformDialogHelper();
-
-    virtual QVariant styleHint(StyleHint hint) const;
-
-    virtual void platformNativeDialogModalHelp() = 0;
-    virtual void _q_platformRunNativeAppModalPanel() = 0;
-
-    virtual void deleteNativeDialog_sys() = 0;
-    virtual bool show_sys(Qt::WindowFlags windowFlags,
-                          Qt::WindowModality windowModality,
-                          QWindow *parent) = 0;
-    virtual void hide_sys() = 0;
-
-    virtual DialogCode dialogResultCode_sys() = 0;
-
-    static QVariant defaultStyleHint(QPlatformDialogHelper::StyleHint hint);
-
-Q_SIGNALS:
-    void launchNativeAppModalPanel();
-    void accept();
-    void reject();
-
-protected Q_SLOTS:
-    void emitLaunchNativeAppModalPanel();
-};
-
-class Q_GUI_EXPORT QColorDialogOptions
-{
-public:
-    enum ColorDialogOption {
-        ShowAlphaChannel    = 0x00000001,
-        NoButtons           = 0x00000002,
-        DontUseNativeDialog = 0x00000004
-    };
-
-    Q_DECLARE_FLAGS(ColorDialogOptions, ColorDialogOption)
-
-    QColorDialogOptions();
-    QColorDialogOptions(const QColorDialogOptions &rhs);
-    QColorDialogOptions &operator=(const QColorDialogOptions &rhs);
-    ~QColorDialogOptions();
-
-    QString windowTitle() const;
-    void setWindowTitle(const QString &);
-
-    void setOption(ColorDialogOption option, bool on = true);
-    bool testOption(ColorDialogOption option) const;
-    void setOptions(ColorDialogOptions options);
-    ColorDialogOptions options() const;
-
-    static int customColorCount();
-    static QRgb customColor(int index);
-    static QRgb *customColors();
-    static void setCustomColor(int index, QRgb color);
-
-    static QRgb *standardColors();
-    static QRgb standardColor(int index);
-    static void setStandardColor(int index, QRgb color);
-
-private:
-    QSharedDataPointer<QColorDialogOptionsPrivate> d;
-};
-
-class Q_GUI_EXPORT QPlatformColorDialogHelper : public QPlatformDialogHelper
-{
-    Q_OBJECT
-public:
-    const QSharedPointer<QColorDialogOptions> &options() const;
-    void setOptions(const QSharedPointer<QColorDialogOptions> &options);
-
-    virtual void setCurrentColor_sys(const QColor &) = 0;
-    virtual QColor currentColor_sys() const = 0;
-
-Q_SIGNALS:
-    void currentColorChanged(const QColor &color);
-    void colorSelected(const QColor &color);
-
-private:
-    QSharedPointer<QColorDialogOptions> m_options;
-};
-
-class Q_GUI_EXPORT QFontDialogOptions
-{
-public:
-    enum FontDialogOption {
-        NoButtons           = 0x00000001,
-        DontUseNativeDialog = 0x00000002
-    };
-
-    Q_DECLARE_FLAGS(FontDialogOptions, FontDialogOption)
-
-    QFontDialogOptions();
-    QFontDialogOptions(const QFontDialogOptions &rhs);
-    QFontDialogOptions &operator=(const QFontDialogOptions &rhs);
-    ~QFontDialogOptions();
-
-    QString windowTitle() const;
-    void setWindowTitle(const QString &);
-
-    void setOption(FontDialogOption option, bool on = true);
-    bool testOption(FontDialogOption option) const;
-    void setOptions(FontDialogOptions options);
-    FontDialogOptions options() const;
-
-private:
-    QSharedDataPointer<QFontDialogOptionsPrivate> d;
-};
-
-class Q_GUI_EXPORT QPlatformFontDialogHelper : public QPlatformDialogHelper
-{
-    Q_OBJECT
-public:
-    virtual void setCurrentFont_sys(const QFont &) = 0;
-    virtual QFont currentFont_sys() const = 0;
-
-    const QSharedPointer<QFontDialogOptions> &options() const;
-    void setOptions(const QSharedPointer<QFontDialogOptions> &options);
-
-Q_SIGNALS:
-    void currentFontChanged(const QFont &font);
-    void fontSelected(const QFont &font);
-
-private:
-    QSharedPointer<QFontDialogOptions> m_options;
-};
-
-class Q_GUI_EXPORT QFileDialogOptions
-{
-public:
-    enum ViewMode { Detail, List };
-    enum FileMode { AnyFile, ExistingFile, Directory, ExistingFiles, DirectoryOnly };
-    enum AcceptMode { AcceptOpen, AcceptSave };
-    enum DialogLabel { LookIn, FileName, FileType, Accept, Reject, DialogLabelCount };
-
-    enum FileDialogOption
-    {
-        ShowDirsOnly          = 0x00000001,
-        DontResolveSymlinks   = 0x00000002,
-        DontConfirmOverwrite  = 0x00000004,
-        DontUseSheet          = 0x00000008,
-        DontUseNativeDialog   = 0x00000010,
-        ReadOnly              = 0x00000020,
-        HideNameFilterDetails = 0x00000040
-    };
-    Q_DECLARE_FLAGS(FileDialogOptions, FileDialogOption)
-
-    QFileDialogOptions();
-    QFileDialogOptions(const QFileDialogOptions &rhs);
-    QFileDialogOptions &operator=(const QFileDialogOptions &rhs);
-    ~QFileDialogOptions();
-
-    QString windowTitle() const;
-    void setWindowTitle(const QString &);
-
-    void setOption(FileDialogOption option, bool on = true);
-    bool testOption(FileDialogOption option) const;
-    void setOptions(FileDialogOptions options);
-    FileDialogOptions options() const;
-
-    QDir::Filters filter() const;
-    void setFilter(QDir::Filters filters);
-
-    void setViewMode(ViewMode mode);
-    ViewMode viewMode() const;
-
-    void setFileMode(FileMode mode);
-    FileMode fileMode() const;
-
-    void setAcceptMode(AcceptMode mode);
-    AcceptMode acceptMode() const;
-
-    void setSidebarUrls(const QList<QUrl> &urls);
-    QList<QUrl> sidebarUrls() const;
-
-    void setNameFilters(const QStringList &filters);
-    QStringList nameFilters() const;
-
-    void setDefaultSuffix(const QString &suffix);
-    QString defaultSuffix() const;
-
-    void setHistory(const QStringList &paths);
-    QStringList history() const;
-
-    void setLabelText(DialogLabel label, const QString &text);
-    QString labelText(DialogLabel label) const;
-    bool isLabelExplicitlySet(DialogLabel label);
-
-    QString initialDirectory() const;
-    void setInitialDirectory(const QString &);
-
-    QString initiallySelectedNameFilter() const;
-    void setInitiallySelectedNameFilter(const QString &);
-
-    QStringList initiallySelectedFiles() const;
-    void setInitiallySelectedFiles(const QStringList &);
-
-private:
-    QSharedDataPointer<QFileDialogOptionsPrivate> d;
-};
-
-class Q_GUI_EXPORT QPlatformFileDialogHelper : public QPlatformDialogHelper
-{
-    Q_OBJECT
-public:
-    virtual bool defaultNameFilterDisables() const = 0;
-    virtual void setDirectory_sys(const QString &directory) = 0;
-    virtual QString directory_sys() const = 0;
-    virtual void selectFile_sys(const QString &filename) = 0;
-    virtual QStringList selectedFiles_sys() const = 0;
-    virtual void setFilter_sys() = 0;
-    virtual void selectNameFilter_sys(const QString &filter) = 0;
-    virtual QString selectedNameFilter_sys() const = 0;
-
-    const QSharedPointer<QFileDialogOptions> &options() const;
-    void setOptions(const QSharedPointer<QFileDialogOptions> &options);
-
-Q_SIGNALS:
-    void fileSelected(const QString &file);
-    void filesSelected(const QStringList &files);
-    void currentChanged(const QString &path);
-    void directoryEntered(const QString &directory);
-    void filterSelected(const QString &filter);
-
-private:
-    QSharedPointer<QFileDialogOptions> m_options;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMDIALOGHELPER_H
diff --git a/src/gui/kernel/qplatformdrag.h b/src/gui/kernel/qplatformdrag.h
new file mode 100644
index 0000000..14282c5
--- /dev/null
+++ b/src/gui/kernel/qplatformdrag.h
@@ -0,0 +1,122 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMDRAG_H
+#define QPLATFORMDRAG_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qglobal.h>
+#include <QtGui/QPixmap>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QMimeData;
+class QMouseEvent;
+class QDrag;
+class QObject;
+class QEvent;
+class QPlatformDragPrivate;
+
+class Q_GUI_EXPORT QPlatformDropQtResponse
+{
+public:
+    QPlatformDropQtResponse(bool accepted, Qt::DropAction acceptedAction);
+    bool isAccepted() const;
+    Qt::DropAction acceptedAction() const;
+
+private:
+    bool m_accepted;
+    Qt::DropAction m_accepted_action;
+
+};
+
+class Q_GUI_EXPORT QPlatformDragQtResponse : public QPlatformDropQtResponse
+{
+public:
+    QPlatformDragQtResponse(bool accepted, Qt::DropAction acceptedAction, QRect answerRect);
+
+    QRect answerRect() const;
+
+private:
+    QRect m_answer_rect;
+};
+
+class Q_GUI_EXPORT QPlatformDrag
+{
+    Q_DECLARE_PRIVATE(QPlatformDrag)
+public:
+    QPlatformDrag();
+    virtual ~QPlatformDrag();
+
+    QDrag *currentDrag() const;
+    virtual QMimeData *platformDropData() = 0;
+
+    virtual Qt::DropAction drag(QDrag *m_drag) = 0;
+    void updateAction(Qt::DropAction action);
+
+    Qt::DropAction defaultAction(Qt::DropActions possibleActions, Qt::KeyboardModifiers modifiers) const;
+
+    static QPixmap defaultPixmap();
+
+private:
+    QPlatformDragPrivate *d_ptr;
+
+    Q_DISABLE_COPY(QPlatformDrag)
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif
diff --git a/src/gui/kernel/qplatformdrag_qpa.cpp b/src/gui/kernel/qplatformdrag_qpa.cpp
index d9fc3a2..8367ad8 100644
--- a/src/gui/kernel/qplatformdrag_qpa.cpp
+++ b/src/gui/kernel/qplatformdrag_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformdrag_qpa.h"
+#include "qplatformdrag.h"
 
 #include <QtGui/private/qdnd_p.h>
 #include <QtGui/QKeyEvent>
diff --git a/src/gui/kernel/qplatformdrag_qpa.h b/src/gui/kernel/qplatformdrag_qpa.h
deleted file mode 100644
index 14282c5..0000000
--- a/src/gui/kernel/qplatformdrag_qpa.h
+++ /dev/null
@@ -1,122 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMDRAG_H
-#define QPLATFORMDRAG_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qglobal.h>
-#include <QtGui/QPixmap>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QMimeData;
-class QMouseEvent;
-class QDrag;
-class QObject;
-class QEvent;
-class QPlatformDragPrivate;
-
-class Q_GUI_EXPORT QPlatformDropQtResponse
-{
-public:
-    QPlatformDropQtResponse(bool accepted, Qt::DropAction acceptedAction);
-    bool isAccepted() const;
-    Qt::DropAction acceptedAction() const;
-
-private:
-    bool m_accepted;
-    Qt::DropAction m_accepted_action;
-
-};
-
-class Q_GUI_EXPORT QPlatformDragQtResponse : public QPlatformDropQtResponse
-{
-public:
-    QPlatformDragQtResponse(bool accepted, Qt::DropAction acceptedAction, QRect answerRect);
-
-    QRect answerRect() const;
-
-private:
-    QRect m_answer_rect;
-};
-
-class Q_GUI_EXPORT QPlatformDrag
-{
-    Q_DECLARE_PRIVATE(QPlatformDrag)
-public:
-    QPlatformDrag();
-    virtual ~QPlatformDrag();
-
-    QDrag *currentDrag() const;
-    virtual QMimeData *platformDropData() = 0;
-
-    virtual Qt::DropAction drag(QDrag *m_drag) = 0;
-    void updateAction(Qt::DropAction action);
-
-    Qt::DropAction defaultAction(Qt::DropActions possibleActions, Qt::KeyboardModifiers modifiers) const;
-
-    static QPixmap defaultPixmap();
-
-private:
-    QPlatformDragPrivate *d_ptr;
-
-    Q_DISABLE_COPY(QPlatformDrag)
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif
diff --git a/src/gui/kernel/qplatforminputcontext.h b/src/gui/kernel/qplatforminputcontext.h
new file mode 100644
index 0000000..696146b
--- /dev/null
+++ b/src/gui/kernel/qplatforminputcontext.h
@@ -0,0 +1,109 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMINPUTCONTEXT_H
+#define QPLATFORMINPUTCONTEXT_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtGui/qinputpanel.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+class QPlatformInputContextPrivate;
+
+class Q_GUI_EXPORT QPlatformInputContext : public QObject
+{
+    Q_OBJECT
+    Q_DECLARE_PRIVATE(QPlatformInputContext)
+
+public:
+    QPlatformInputContext();
+    virtual ~QPlatformInputContext();
+
+    virtual bool isValid() const;
+
+    virtual void reset();
+    virtual void commit();
+    virtual void update(Qt::InputMethodQueries);
+    virtual void invokeAction(QInputMethod::Action, int cursorPosition);
+    virtual bool filterEvent(const QEvent *event);
+    virtual QRectF keyboardRect() const;
+    void emitKeyboardRectChanged();
+
+    virtual bool isAnimating() const;
+    void emitAnimatingChanged();
+
+    virtual void showInputPanel();
+    virtual void hideInputPanel();
+    virtual bool isInputPanelVisible() const;
+    void emitInputPanelVisibleChanged();
+
+    virtual QLocale locale() const;
+    void emitLocaleChanged();
+    virtual Qt::LayoutDirection inputDirection() const;
+    void emitInputDirectionChanged(Qt::LayoutDirection newDirection);
+
+    virtual void setFocusObject(QObject *object);
+    bool inputMethodAccepted() const;
+
+private:
+    friend class QGuiApplication;
+    friend class QGuiApplicationPrivate;
+    friend class QInputMethod;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMINPUTCONTEXT_H
diff --git a/src/gui/kernel/qplatforminputcontext_p.h b/src/gui/kernel/qplatforminputcontext_p.h
new file mode 100644
index 0000000..dc12d26
--- /dev/null
+++ b/src/gui/kernel/qplatforminputcontext_p.h
@@ -0,0 +1,67 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMINPUTCONTEXT_P_H
+#define QPLATFORMINPUTCONTEXT_P_H
+
+#include <private/qobject_p.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+class QPlatformInputContextPrivate: public QObjectPrivate
+{
+public:
+    QPlatformInputContextPrivate() {}
+    ~QPlatformInputContextPrivate() {}
+
+    static void setInputMethodAccepted(bool accepted);
+    static bool inputMethodAccepted();
+
+    static bool s_inputMethodAccepted;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif
diff --git a/src/gui/kernel/qplatforminputcontext_qpa.cpp b/src/gui/kernel/qplatforminputcontext_qpa.cpp
index 5383908..0a8633b 100644
--- a/src/gui/kernel/qplatforminputcontext_qpa.cpp
+++ b/src/gui/kernel/qplatforminputcontext_qpa.cpp
@@ -39,11 +39,11 @@
 **
 ****************************************************************************/
 
-#include <qplatforminputcontext_qpa.h>
+#include "qplatforminputcontext.h"
 #include <qguiapplication.h>
 #include <QRect>
 #include "private/qkeymapper_p.h"
-#include "private/qplatforminputcontext_qpa_p.h"
+#include <qpa/qplatforminputcontext_p.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/kernel/qplatforminputcontext_qpa.h b/src/gui/kernel/qplatforminputcontext_qpa.h
deleted file mode 100644
index 696146b..0000000
--- a/src/gui/kernel/qplatforminputcontext_qpa.h
+++ /dev/null
@@ -1,109 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMINPUTCONTEXT_H
-#define QPLATFORMINPUTCONTEXT_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtGui/qinputpanel.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-class QPlatformInputContextPrivate;
-
-class Q_GUI_EXPORT QPlatformInputContext : public QObject
-{
-    Q_OBJECT
-    Q_DECLARE_PRIVATE(QPlatformInputContext)
-
-public:
-    QPlatformInputContext();
-    virtual ~QPlatformInputContext();
-
-    virtual bool isValid() const;
-
-    virtual void reset();
-    virtual void commit();
-    virtual void update(Qt::InputMethodQueries);
-    virtual void invokeAction(QInputMethod::Action, int cursorPosition);
-    virtual bool filterEvent(const QEvent *event);
-    virtual QRectF keyboardRect() const;
-    void emitKeyboardRectChanged();
-
-    virtual bool isAnimating() const;
-    void emitAnimatingChanged();
-
-    virtual void showInputPanel();
-    virtual void hideInputPanel();
-    virtual bool isInputPanelVisible() const;
-    void emitInputPanelVisibleChanged();
-
-    virtual QLocale locale() const;
-    void emitLocaleChanged();
-    virtual Qt::LayoutDirection inputDirection() const;
-    void emitInputDirectionChanged(Qt::LayoutDirection newDirection);
-
-    virtual void setFocusObject(QObject *object);
-    bool inputMethodAccepted() const;
-
-private:
-    friend class QGuiApplication;
-    friend class QGuiApplicationPrivate;
-    friend class QInputMethod;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMINPUTCONTEXT_H
diff --git a/src/gui/kernel/qplatforminputcontext_qpa_p.h b/src/gui/kernel/qplatforminputcontext_qpa_p.h
deleted file mode 100644
index dc12d26..0000000
--- a/src/gui/kernel/qplatforminputcontext_qpa_p.h
+++ /dev/null
@@ -1,67 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMINPUTCONTEXT_P_H
-#define QPLATFORMINPUTCONTEXT_P_H
-
-#include <private/qobject_p.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-class QPlatformInputContextPrivate: public QObjectPrivate
-{
-public:
-    QPlatformInputContextPrivate() {}
-    ~QPlatformInputContextPrivate() {}
-
-    static void setInputMethodAccepted(bool accepted);
-    static bool inputMethodAccepted();
-
-    static bool s_inputMethodAccepted;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif
diff --git a/src/gui/kernel/qplatformintegration.h b/src/gui/kernel/qplatformintegration.h
new file mode 100644
index 0000000..fb62daf
--- /dev/null
+++ b/src/gui/kernel/qplatformintegration.h
@@ -0,0 +1,155 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMINTEGRATION_H
+#define QPLATFORMINTEGRATION_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtGui/qwindowdefs.h>
+#include <qpa/qplatformscreen.h>
+#include <QtGui/qsurfaceformat.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformWindow;
+class QWindow;
+class QPlatformBackingStore;
+class QPlatformFontDatabase;
+class QPlatformClipboard;
+class QPlatformNativeInterface;
+class QPlatformDrag;
+class QPlatformOpenGLContext;
+class QGuiGLFormat;
+class QAbstractEventDispatcher;
+class QPlatformInputContext;
+class QPlatformAccessibility;
+class QPlatformTheme;
+class QPlatformDialogHelper;
+class QPlatformSharedGraphicsCache;
+class QPlatformServices;
+
+class Q_GUI_EXPORT QPlatformIntegration
+{
+public:
+    enum Capability {
+        ThreadedPixmaps = 1,
+        OpenGL = 2,
+        ThreadedOpenGL = 3,
+        SharedGraphicsCache = 4,
+        BufferQueueingOpenGL = 5
+
+    };
+
+    virtual ~QPlatformIntegration() { }
+
+    virtual bool hasCapability(Capability cap) const;
+
+    virtual QPlatformPixmap *createPlatformPixmap(QPlatformPixmap::PixelType type) const;
+    virtual QPlatformWindow *createPlatformWindow(QWindow *window) const = 0;
+    virtual QPlatformBackingStore *createPlatformBackingStore(QWindow *window) const = 0;
+#ifndef QT_NO_OPENGL
+    virtual QPlatformOpenGLContext *createPlatformOpenGLContext(QOpenGLContext *context) const;
+#endif
+    virtual QPlatformSharedGraphicsCache *createPlatformSharedGraphicsCache(const char *cacheId) const;
+    virtual QPaintEngine *createImagePaintEngine(QPaintDevice *paintDevice) const;
+
+// Event dispatcher:
+    virtual QAbstractEventDispatcher *guiThreadEventDispatcher() const = 0;
+
+//Deeper window system integrations
+    virtual QPlatformFontDatabase *fontDatabase() const;
+#ifndef QT_NO_CLIPBOARD
+    virtual QPlatformClipboard *clipboard() const;
+#endif
+#ifndef QT_NO_DRAGANDDROP
+    virtual QPlatformDrag *drag() const;
+#endif
+    virtual QPlatformInputContext *inputContext() const;
+#ifndef QT_NO_ACCESSIBILITY
+    virtual QPlatformAccessibility *accessibility() const;
+#endif
+
+    // Access native handles. The window handle is already available from Wid;
+    virtual QPlatformNativeInterface *nativeInterface() const;
+
+    virtual QPlatformServices *services() const;
+
+    enum StyleHint {
+        CursorFlashTime,
+        KeyboardInputInterval,
+        MouseDoubleClickInterval,
+        StartDragDistance,
+        StartDragTime,
+        KeyboardAutoRepeatRate,
+        ShowIsFullScreen,
+        PasswordMaskDelay,
+        FontSmoothingGamma
+    };
+
+    virtual QVariant styleHint(StyleHint hint) const;
+
+    virtual Qt::KeyboardModifiers queryKeyboardModifiers() const;
+
+    virtual QStringList themeNames() const;
+    virtual QPlatformTheme *createPlatformTheme(const QString &name) const;
+
+protected:
+    void screenAdded(QPlatformScreen *screen);
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMINTEGRATION_H
diff --git a/src/gui/kernel/qplatformintegration_qpa.cpp b/src/gui/kernel/qplatformintegration_qpa.cpp
index 5269d8f..8e4ed05 100644
--- a/src/gui/kernel/qplatformintegration_qpa.cpp
+++ b/src/gui/kernel/qplatformintegration_qpa.cpp
@@ -39,15 +39,15 @@
 **
 ****************************************************************************/
 
-#include "qplatformintegration_qpa.h"
+#include "qplatformintegration.h"
 
-#include <QtGui/QPlatformFontDatabase>
-#include <QtGui/QPlatformClipboard>
-#include <QtGui/QPlatformAccessibility>
-#include <QtGui/QPlatformTheme>
+#include <qpa/qplatformfontdatabase.h>
+#include <qpa/qplatformclipboard.h>
+#include <qpa/qplatformaccessibility.h>
+#include <qpa/qplatformtheme.h>
 #include <QtGui/private/qguiapplication_p.h>
 #include <QtGui/private/qpixmap_raster_p.h>
-#include <QtGui/private/qplatformscreen_qpa_p.h>
+#include <qpa/qplatformscreen_p.h>
 #include <private/qdnd_p.h>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/gui/kernel/qplatformintegration_qpa.h b/src/gui/kernel/qplatformintegration_qpa.h
deleted file mode 100644
index a44f434..0000000
--- a/src/gui/kernel/qplatformintegration_qpa.h
+++ /dev/null
@@ -1,155 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMINTEGRATION_H
-#define QPLATFORMINTEGRATION_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtGui/qwindowdefs.h>
-#include <QtGui/qplatformscreen_qpa.h>
-#include <QtGui/qsurfaceformat.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformWindow;
-class QWindow;
-class QPlatformBackingStore;
-class QPlatformFontDatabase;
-class QPlatformClipboard;
-class QPlatformNativeInterface;
-class QPlatformDrag;
-class QPlatformOpenGLContext;
-class QGuiGLFormat;
-class QAbstractEventDispatcher;
-class QPlatformInputContext;
-class QPlatformAccessibility;
-class QPlatformTheme;
-class QPlatformDialogHelper;
-class QPlatformSharedGraphicsCache;
-class QPlatformServices;
-
-class Q_GUI_EXPORT QPlatformIntegration
-{
-public:
-    enum Capability {
-        ThreadedPixmaps = 1,
-        OpenGL = 2,
-        ThreadedOpenGL = 3,
-        SharedGraphicsCache = 4,
-        BufferQueueingOpenGL = 5
-
-    };
-
-    virtual ~QPlatformIntegration() { }
-
-    virtual bool hasCapability(Capability cap) const;
-
-    virtual QPlatformPixmap *createPlatformPixmap(QPlatformPixmap::PixelType type) const;
-    virtual QPlatformWindow *createPlatformWindow(QWindow *window) const = 0;
-    virtual QPlatformBackingStore *createPlatformBackingStore(QWindow *window) const = 0;
-#ifndef QT_NO_OPENGL
-    virtual QPlatformOpenGLContext *createPlatformOpenGLContext(QOpenGLContext *context) const;
-#endif
-    virtual QPlatformSharedGraphicsCache *createPlatformSharedGraphicsCache(const char *cacheId) const;
-    virtual QPaintEngine *createImagePaintEngine(QPaintDevice *paintDevice) const;
-
-// Event dispatcher:
-    virtual QAbstractEventDispatcher *guiThreadEventDispatcher() const = 0;
-
-//Deeper window system integrations
-    virtual QPlatformFontDatabase *fontDatabase() const;
-#ifndef QT_NO_CLIPBOARD
-    virtual QPlatformClipboard *clipboard() const;
-#endif
-#ifndef QT_NO_DRAGANDDROP
-    virtual QPlatformDrag *drag() const;
-#endif
-    virtual QPlatformInputContext *inputContext() const;
-#ifndef QT_NO_ACCESSIBILITY
-    virtual QPlatformAccessibility *accessibility() const;
-#endif
-
-    // Access native handles. The window handle is already available from Wid;
-    virtual QPlatformNativeInterface *nativeInterface() const;
-
-    virtual QPlatformServices *services() const;
-
-    enum StyleHint {
-        CursorFlashTime,
-        KeyboardInputInterval,
-        MouseDoubleClickInterval,
-        StartDragDistance,
-        StartDragTime,
-        KeyboardAutoRepeatRate,
-        ShowIsFullScreen,
-        PasswordMaskDelay,
-        FontSmoothingGamma
-    };
-
-    virtual QVariant styleHint(StyleHint hint) const;
-
-    virtual Qt::KeyboardModifiers queryKeyboardModifiers() const;
-
-    virtual QStringList themeNames() const;
-    virtual QPlatformTheme *createPlatformTheme(const QString &name) const;
-
-protected:
-    void screenAdded(QPlatformScreen *screen);
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMINTEGRATION_H
diff --git a/src/gui/kernel/qplatformintegrationfactory_p.h b/src/gui/kernel/qplatformintegrationfactory_p.h
new file mode 100644
index 0000000..4aae789
--- /dev/null
+++ b/src/gui/kernel/qplatformintegrationfactory_p.h
@@ -0,0 +1,77 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMINTEGRATIONFACTORY_H
+#define QPLATFORMINTEGRATIONFACTORY_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qstringlist.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformIntegration;
+
+class QPlatformIntegrationFactory
+{
+public:
+    static QStringList keys(const QString &platformPluginPath = QString());
+    static QPlatformIntegration *create(const QString &key, const QString &platformPluginPath = QString());
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMINTEGRATIONFACTORY_H
+
diff --git a/src/gui/kernel/qplatformintegrationfactory_qpa.cpp b/src/gui/kernel/qplatformintegrationfactory_qpa.cpp
index a84c243..2092f2d 100644
--- a/src/gui/kernel/qplatformintegrationfactory_qpa.cpp
+++ b/src/gui/kernel/qplatformintegrationfactory_qpa.cpp
@@ -39,8 +39,8 @@
 **
 ****************************************************************************/
 
-#include "qplatformintegrationfactory_qpa_p.h"
-#include <QPlatformIntegrationPlugin>
+#include <qpa/qplatformintegrationfactory_p.h>
+#include <qpa/qplatformintegrationplugin.h>
 #include "private/qfactoryloader_p.h"
 #include "qmutex.h"
 
diff --git a/src/gui/kernel/qplatformintegrationfactory_qpa_p.h b/src/gui/kernel/qplatformintegrationfactory_qpa_p.h
deleted file mode 100644
index 4aae789..0000000
--- a/src/gui/kernel/qplatformintegrationfactory_qpa_p.h
+++ /dev/null
@@ -1,77 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMINTEGRATIONFACTORY_H
-#define QPLATFORMINTEGRATIONFACTORY_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qstringlist.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformIntegration;
-
-class QPlatformIntegrationFactory
-{
-public:
-    static QStringList keys(const QString &platformPluginPath = QString());
-    static QPlatformIntegration *create(const QString &key, const QString &platformPluginPath = QString());
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMINTEGRATIONFACTORY_H
-
diff --git a/src/gui/kernel/qplatformintegrationplugin.h b/src/gui/kernel/qplatformintegrationplugin.h
new file mode 100644
index 0000000..d70569c
--- /dev/null
+++ b/src/gui/kernel/qplatformintegrationplugin.h
@@ -0,0 +1,91 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMINTEGRATIONPLUGIN_H
+#define QPLATFORMINTEGRATIONPLUGIN_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qplugin.h>
+#include <QtCore/qfactoryinterface.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformIntegration;
+
+struct QPlatformIntegrationFactoryInterface : public QFactoryInterface
+{
+    virtual QPlatformIntegration *create(const QString &key, const QStringList &paramList) = 0;
+};
+
+#define QPlatformIntegrationFactoryInterface_iid "org.qt-project.Qt.QPlatformIntegrationFactoryInterface"
+
+Q_DECLARE_INTERFACE(QPlatformIntegrationFactoryInterface, QPlatformIntegrationFactoryInterface_iid)
+
+class Q_GUI_EXPORT QPlatformIntegrationPlugin : public QObject, public QPlatformIntegrationFactoryInterface
+{
+    Q_OBJECT
+    Q_INTERFACES(QPlatformIntegrationFactoryInterface:QFactoryInterface)
+public:
+    explicit QPlatformIntegrationPlugin(QObject *parent = 0);
+    ~QPlatformIntegrationPlugin();
+
+    virtual QStringList keys() const = 0;
+    virtual QPlatformIntegration *create(const QString &key, const QStringList &paramList) = 0;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMINTEGRATIONPLUGIN_H
diff --git a/src/gui/kernel/qplatformintegrationplugin_qpa.cpp b/src/gui/kernel/qplatformintegrationplugin_qpa.cpp
index 7bd1caa..d4debd1 100644
--- a/src/gui/kernel/qplatformintegrationplugin_qpa.cpp
+++ b/src/gui/kernel/qplatformintegrationplugin_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformintegrationplugin_qpa.h"
+#include "qplatformintegrationplugin.h"
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/kernel/qplatformintegrationplugin_qpa.h b/src/gui/kernel/qplatformintegrationplugin_qpa.h
deleted file mode 100644
index d70569c..0000000
--- a/src/gui/kernel/qplatformintegrationplugin_qpa.h
+++ /dev/null
@@ -1,91 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMINTEGRATIONPLUGIN_H
-#define QPLATFORMINTEGRATIONPLUGIN_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qplugin.h>
-#include <QtCore/qfactoryinterface.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformIntegration;
-
-struct QPlatformIntegrationFactoryInterface : public QFactoryInterface
-{
-    virtual QPlatformIntegration *create(const QString &key, const QStringList &paramList) = 0;
-};
-
-#define QPlatformIntegrationFactoryInterface_iid "org.qt-project.Qt.QPlatformIntegrationFactoryInterface"
-
-Q_DECLARE_INTERFACE(QPlatformIntegrationFactoryInterface, QPlatformIntegrationFactoryInterface_iid)
-
-class Q_GUI_EXPORT QPlatformIntegrationPlugin : public QObject, public QPlatformIntegrationFactoryInterface
-{
-    Q_OBJECT
-    Q_INTERFACES(QPlatformIntegrationFactoryInterface:QFactoryInterface)
-public:
-    explicit QPlatformIntegrationPlugin(QObject *parent = 0);
-    ~QPlatformIntegrationPlugin();
-
-    virtual QStringList keys() const = 0;
-    virtual QPlatformIntegration *create(const QString &key, const QStringList &paramList) = 0;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMINTEGRATIONPLUGIN_H
diff --git a/src/gui/kernel/qplatformnativeinterface.h b/src/gui/kernel/qplatformnativeinterface.h
new file mode 100644
index 0000000..918ba4a
--- /dev/null
+++ b/src/gui/kernel/qplatformnativeinterface.h
@@ -0,0 +1,104 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMNATIVEINTERFACE_QPA_H
+#define QPLATFORMNATIVEINTERFACE_QPA_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtGui/qwindowdefs.h>
+#include <QtCore/QObject>
+#include <QtCore/QVariant>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QOpenGLContext;
+class QWindow;
+class QPlatformWindow;
+class QBackingStore;
+
+class Q_GUI_EXPORT QPlatformNativeInterface : public QObject
+{
+    Q_OBJECT
+public:
+    virtual void *nativeResourceForIntegration(const QByteArray &resource);
+    virtual void *nativeResourceForContext(const QByteArray &resource, QOpenGLContext *context);
+    virtual void *nativeResourceForWindow(const QByteArray &resource, QWindow *window);
+    virtual void *nativeResourceForBackingStore(const QByteArray &resource, QBackingStore *backingStore);
+
+    typedef void * (*NativeResourceForIntegrationFunction)();
+    typedef void * (*NativeResourceForContextFunction)(QOpenGLContext *context);
+    typedef void * (*NativeResourceForWindowFunction)(QWindow *window);
+    typedef void * (*NativeResourceForBackingStoreFunction)(QBackingStore *backingStore);
+    virtual NativeResourceForIntegrationFunction nativeResourceFunctionForIntegration(const QByteArray &resource);
+    virtual NativeResourceForContextFunction nativeResourceFunctionForContext(const QByteArray &resource);
+    virtual NativeResourceForWindowFunction nativeResourceFunctionForWindow(const QByteArray &resource);
+    virtual NativeResourceForBackingStoreFunction nativeResourceFunctionForBackingStore(const QByteArray &resource);
+
+    virtual QVariantMap windowProperties(QPlatformWindow *window) const;
+    virtual QVariant windowProperty(QPlatformWindow *window, const QString &name) const;
+    virtual QVariant windowProperty(QPlatformWindow *window, const QString &name, const QVariant &defaultValue) const;
+    virtual void setWindowProperty(QPlatformWindow *window, const QString &name, const QVariant &value);
+
+    typedef bool (*EventFilter)(void *message, long *result);
+    virtual EventFilter setEventFilter(const QByteArray &eventType, EventFilter filter);
+
+Q_SIGNALS:
+    void windowPropertyChanged(QPlatformWindow *window, const QString &propertyName);
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMNATIVEINTERFACE_QPA_H
diff --git a/src/gui/kernel/qplatformnativeinterface_qpa.cpp b/src/gui/kernel/qplatformnativeinterface_qpa.cpp
index c17eee4..f0bd3f0 100644
--- a/src/gui/kernel/qplatformnativeinterface_qpa.cpp
+++ b/src/gui/kernel/qplatformnativeinterface_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformnativeinterface_qpa.h"
+#include "qplatformnativeinterface.h"
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/kernel/qplatformnativeinterface_qpa.h b/src/gui/kernel/qplatformnativeinterface_qpa.h
deleted file mode 100644
index 918ba4a..0000000
--- a/src/gui/kernel/qplatformnativeinterface_qpa.h
+++ /dev/null
@@ -1,104 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMNATIVEINTERFACE_QPA_H
-#define QPLATFORMNATIVEINTERFACE_QPA_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtGui/qwindowdefs.h>
-#include <QtCore/QObject>
-#include <QtCore/QVariant>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QOpenGLContext;
-class QWindow;
-class QPlatformWindow;
-class QBackingStore;
-
-class Q_GUI_EXPORT QPlatformNativeInterface : public QObject
-{
-    Q_OBJECT
-public:
-    virtual void *nativeResourceForIntegration(const QByteArray &resource);
-    virtual void *nativeResourceForContext(const QByteArray &resource, QOpenGLContext *context);
-    virtual void *nativeResourceForWindow(const QByteArray &resource, QWindow *window);
-    virtual void *nativeResourceForBackingStore(const QByteArray &resource, QBackingStore *backingStore);
-
-    typedef void * (*NativeResourceForIntegrationFunction)();
-    typedef void * (*NativeResourceForContextFunction)(QOpenGLContext *context);
-    typedef void * (*NativeResourceForWindowFunction)(QWindow *window);
-    typedef void * (*NativeResourceForBackingStoreFunction)(QBackingStore *backingStore);
-    virtual NativeResourceForIntegrationFunction nativeResourceFunctionForIntegration(const QByteArray &resource);
-    virtual NativeResourceForContextFunction nativeResourceFunctionForContext(const QByteArray &resource);
-    virtual NativeResourceForWindowFunction nativeResourceFunctionForWindow(const QByteArray &resource);
-    virtual NativeResourceForBackingStoreFunction nativeResourceFunctionForBackingStore(const QByteArray &resource);
-
-    virtual QVariantMap windowProperties(QPlatformWindow *window) const;
-    virtual QVariant windowProperty(QPlatformWindow *window, const QString &name) const;
-    virtual QVariant windowProperty(QPlatformWindow *window, const QString &name, const QVariant &defaultValue) const;
-    virtual void setWindowProperty(QPlatformWindow *window, const QString &name, const QVariant &value);
-
-    typedef bool (*EventFilter)(void *message, long *result);
-    virtual EventFilter setEventFilter(const QByteArray &eventType, EventFilter filter);
-
-Q_SIGNALS:
-    void windowPropertyChanged(QPlatformWindow *window, const QString &propertyName);
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMNATIVEINTERFACE_QPA_H
diff --git a/src/gui/kernel/qplatformopenglcontext.h b/src/gui/kernel/qplatformopenglcontext.h
new file mode 100644
index 0000000..ddcb87a
--- /dev/null
+++ b/src/gui/kernel/qplatformopenglcontext.h
@@ -0,0 +1,109 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMGLCONTEXT_H
+#define QPLATFORMGLCONTEXT_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#ifndef QT_NO_OPENGL
+
+#include <QtCore/qnamespace.h>
+#include <QtGui/qsurfaceformat.h>
+#include <QtGui/qwindow.h>
+#include <QtGui/qopengl.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformOpenGLContextPrivate;
+
+class Q_GUI_EXPORT QPlatformOpenGLContext
+{
+    Q_DECLARE_PRIVATE(QPlatformOpenGLContext)
+public:
+    QPlatformOpenGLContext();
+    virtual ~QPlatformOpenGLContext();
+
+    virtual QSurfaceFormat format() const = 0;
+
+    virtual void swapBuffers(QPlatformSurface *surface) = 0;
+
+    virtual GLuint defaultFramebufferObject(QPlatformSurface *surface) const;
+
+    virtual bool makeCurrent(QPlatformSurface *surface) = 0;
+    virtual void doneCurrent() = 0;
+
+    virtual bool isSharing() const { return false; }
+    virtual bool isValid() const { return true; }
+
+    virtual QFunctionPointer getProcAddress(const QByteArray &procName) = 0;
+
+    QOpenGLContext *context() const;
+
+private:
+    friend class QOpenGLContext;
+
+    QScopedPointer<QPlatformOpenGLContextPrivate> d_ptr;
+
+    void setContext(QOpenGLContext *context);
+
+    Q_DISABLE_COPY(QPlatformOpenGLContext)
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QT_NO_OPENGL
+
+#endif // QPLATFORMGLCONTEXT_H
diff --git a/src/gui/kernel/qplatformopenglcontext_qpa.cpp b/src/gui/kernel/qplatformopenglcontext_qpa.cpp
index 33adc26..d38a586 100644
--- a/src/gui/kernel/qplatformopenglcontext_qpa.cpp
+++ b/src/gui/kernel/qplatformopenglcontext_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformopenglcontext_qpa.h"
+#include "qplatformopenglcontext.h"
 
 #include <QOpenGLFunctions>
 
diff --git a/src/gui/kernel/qplatformopenglcontext_qpa.h b/src/gui/kernel/qplatformopenglcontext_qpa.h
deleted file mode 100644
index ddcb87a..0000000
--- a/src/gui/kernel/qplatformopenglcontext_qpa.h
+++ /dev/null
@@ -1,109 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMGLCONTEXT_H
-#define QPLATFORMGLCONTEXT_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#ifndef QT_NO_OPENGL
-
-#include <QtCore/qnamespace.h>
-#include <QtGui/qsurfaceformat.h>
-#include <QtGui/qwindow.h>
-#include <QtGui/qopengl.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformOpenGLContextPrivate;
-
-class Q_GUI_EXPORT QPlatformOpenGLContext
-{
-    Q_DECLARE_PRIVATE(QPlatformOpenGLContext)
-public:
-    QPlatformOpenGLContext();
-    virtual ~QPlatformOpenGLContext();
-
-    virtual QSurfaceFormat format() const = 0;
-
-    virtual void swapBuffers(QPlatformSurface *surface) = 0;
-
-    virtual GLuint defaultFramebufferObject(QPlatformSurface *surface) const;
-
-    virtual bool makeCurrent(QPlatformSurface *surface) = 0;
-    virtual void doneCurrent() = 0;
-
-    virtual bool isSharing() const { return false; }
-    virtual bool isValid() const { return true; }
-
-    virtual QFunctionPointer getProcAddress(const QByteArray &procName) = 0;
-
-    QOpenGLContext *context() const;
-
-private:
-    friend class QOpenGLContext;
-
-    QScopedPointer<QPlatformOpenGLContextPrivate> d_ptr;
-
-    void setContext(QOpenGLContext *context);
-
-    Q_DISABLE_COPY(QPlatformOpenGLContext)
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QT_NO_OPENGL
-
-#endif // QPLATFORMGLCONTEXT_H
diff --git a/src/gui/kernel/qplatformscreen.h b/src/gui/kernel/qplatformscreen.h
new file mode 100644
index 0000000..075dfb1
--- /dev/null
+++ b/src/gui/kernel/qplatformscreen.h
@@ -0,0 +1,133 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMSCREEN_H
+#define QPLATFORMSCREEN_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qmetatype.h>
+#include <QtCore/qnamespace.h>
+#include <QtCore/qcoreevent.h>
+#include <QtCore/qvariant.h>
+#include <QtCore/qrect.h>
+#include <QtCore/qobject.h>
+
+#include <QtGui/qcursor.h>
+#include <QtGui/qimage.h>
+#include <QtGui/qwindowdefs.h>
+#include <qpa/qplatformpixmap.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformBackingStore;
+class QPlatformOpenGLContext;
+class QPlatformScreenPrivate;
+class QPlatformWindow;
+class QPlatformCursor;
+class QPlatformScreenPageFlipper;
+class QScreen;
+class QSurfaceFormat;
+
+typedef QPair<qreal, qreal> QDpi;
+
+
+class Q_GUI_EXPORT QPlatformScreen
+{
+    Q_DECLARE_PRIVATE(QPlatformScreen)
+
+public:
+    QPlatformScreen();
+    virtual ~QPlatformScreen();
+
+    virtual QPixmap grabWindow(WId window, int x, int y, int width, int height) const;
+
+    virtual QRect geometry() const = 0;
+    virtual QRect availableGeometry() const {return geometry();}
+
+    virtual int depth() const = 0;
+    virtual QImage::Format format() const = 0;
+
+    virtual QSizeF physicalSize() const;
+    virtual QDpi logicalDpi() const;
+
+    virtual Qt::ScreenOrientation orientation() const;
+
+    virtual QWindow *topLevelAt(const QPoint &point) const;
+    virtual QList<QPlatformScreen *> virtualSiblings() const;
+
+    QScreen *screen() const;
+
+    //jl: should this function be in QPlatformIntegration
+    //jl: maybe screenForWindow is a better name?
+    static QPlatformScreen *platformScreenForWindow(const QWindow *window);
+
+    virtual QString name() const { return QString(); }
+
+    virtual QPlatformScreenPageFlipper *pageFlipper() const;
+    virtual QPlatformCursor *cursor() const;
+
+protected:
+    QScopedPointer<QPlatformScreenPrivate> d_ptr;
+
+private:
+    Q_DISABLE_COPY(QPlatformScreen)
+
+    friend class QPlatformIntegration;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMSCREEN_H
diff --git a/src/gui/kernel/qplatformscreen_p.h b/src/gui/kernel/qplatformscreen_p.h
new file mode 100644
index 0000000..ced66be
--- /dev/null
+++ b/src/gui/kernel/qplatformscreen_p.h
@@ -0,0 +1,74 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMSCREEN_QPA_P_H
+#define QPLATFORMSCREEN_QPA_P_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+QT_MODULE(Gui)
+
+class QScreen;
+
+class QPlatformScreenPrivate
+{
+public:
+    QScreen *screen;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMSCREEN_QPA_P_H
diff --git a/src/gui/kernel/qplatformscreen_qpa.cpp b/src/gui/kernel/qplatformscreen_qpa.cpp
index a26bd25..6c2f98b 100644
--- a/src/gui/kernel/qplatformscreen_qpa.cpp
+++ b/src/gui/kernel/qplatformscreen_qpa.cpp
@@ -39,12 +39,12 @@
 **
 ****************************************************************************/
 
-#include "qplatformscreen_qpa.h"
+#include "qplatformscreen.h"
 #include <QtGui/qguiapplication.h>
-#include <QtGui/qplatformcursor_qpa.h>
+#include <qpa/qplatformcursor.h>
 #include <QtGui/private/qguiapplication_p.h>
-#include <QtGui/private/qplatformscreen_qpa_p.h>
-#include <QtGui/qplatformintegration_qpa.h>
+#include <qpa/qplatformscreen_p.h>
+#include <qpa/qplatformintegration.h>
 #include <QtGui/qscreen.h>
 #include <QtGui/qwindow.h>
 
diff --git a/src/gui/kernel/qplatformscreen_qpa.h b/src/gui/kernel/qplatformscreen_qpa.h
deleted file mode 100644
index 71d7348..0000000
--- a/src/gui/kernel/qplatformscreen_qpa.h
+++ /dev/null
@@ -1,133 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMSCREEN_H
-#define QPLATFORMSCREEN_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qmetatype.h>
-#include <QtCore/qnamespace.h>
-#include <QtCore/qcoreevent.h>
-#include <QtCore/qvariant.h>
-#include <QtCore/qrect.h>
-#include <QtCore/qobject.h>
-
-#include <QtGui/qcursor.h>
-#include <QtGui/qimage.h>
-#include <QtGui/qwindowdefs.h>
-#include <QtGui/qplatformpixmap_qpa.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformBackingStore;
-class QPlatformOpenGLContext;
-class QPlatformScreenPrivate;
-class QPlatformWindow;
-class QPlatformCursor;
-class QPlatformScreenPageFlipper;
-class QScreen;
-class QSurfaceFormat;
-
-typedef QPair<qreal, qreal> QDpi;
-
-
-class Q_GUI_EXPORT QPlatformScreen
-{
-    Q_DECLARE_PRIVATE(QPlatformScreen)
-
-public:
-    QPlatformScreen();
-    virtual ~QPlatformScreen();
-
-    virtual QPixmap grabWindow(WId window, int x, int y, int width, int height) const;
-
-    virtual QRect geometry() const = 0;
-    virtual QRect availableGeometry() const {return geometry();}
-
-    virtual int depth() const = 0;
-    virtual QImage::Format format() const = 0;
-
-    virtual QSizeF physicalSize() const;
-    virtual QDpi logicalDpi() const;
-
-    virtual Qt::ScreenOrientation orientation() const;
-
-    virtual QWindow *topLevelAt(const QPoint &point) const;
-    virtual QList<QPlatformScreen *> virtualSiblings() const;
-
-    QScreen *screen() const;
-
-    //jl: should this function be in QPlatformIntegration
-    //jl: maybe screenForWindow is a better name?
-    static QPlatformScreen *platformScreenForWindow(const QWindow *window);
-
-    virtual QString name() const { return QString(); }
-
-    virtual QPlatformScreenPageFlipper *pageFlipper() const;
-    virtual QPlatformCursor *cursor() const;
-
-protected:
-    QScopedPointer<QPlatformScreenPrivate> d_ptr;
-
-private:
-    Q_DISABLE_COPY(QPlatformScreen)
-
-    friend class QPlatformIntegration;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMSCREEN_H
diff --git a/src/gui/kernel/qplatformscreen_qpa_p.h b/src/gui/kernel/qplatformscreen_qpa_p.h
deleted file mode 100644
index ced66be..0000000
--- a/src/gui/kernel/qplatformscreen_qpa_p.h
+++ /dev/null
@@ -1,74 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMSCREEN_QPA_P_H
-#define QPLATFORMSCREEN_QPA_P_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-QT_MODULE(Gui)
-
-class QScreen;
-
-class QPlatformScreenPrivate
-{
-public:
-    QScreen *screen;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMSCREEN_QPA_P_H
diff --git a/src/gui/kernel/qplatformscreenpageflipper.h b/src/gui/kernel/qplatformscreenpageflipper.h
new file mode 100644
index 0000000..116d2db
--- /dev/null
+++ b/src/gui/kernel/qplatformscreenpageflipper.h
@@ -0,0 +1,98 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMSCREENPAGEFLIPPER_QPA_H
+#define QPLATFORMSCREENPAGEFLIPPER_QPA_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/QObject>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+class Q_GUI_EXPORT QPlatformScreenBuffer {
+public:
+    QPlatformScreenBuffer();
+    virtual ~QPlatformScreenBuffer();
+
+    bool isDestroyed() const;
+    bool isReady() const;
+
+    virtual void aboutToBeDisplayed();
+    virtual void displayed();
+    virtual void release() = 0;
+
+    virtual void *handle() const = 0;
+
+protected:
+    bool m_destroyed;
+    bool m_ready;
+};
+
+class Q_GUI_EXPORT QPlatformScreenPageFlipper : public QObject
+{
+    Q_OBJECT
+public:
+    explicit QPlatformScreenPageFlipper(QObject *parent = 0);
+
+    virtual bool displayBuffer(QPlatformScreenBuffer *) = 0;
+
+signals:
+    void bufferDisplayed(QPlatformScreenBuffer *);
+    void bufferReleased(QPlatformScreenBuffer *);
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMSCREENPAGEFLIPPER_QPA_H
diff --git a/src/gui/kernel/qplatformscreenpageflipper_qpa.cpp b/src/gui/kernel/qplatformscreenpageflipper_qpa.cpp
index b912c60..babecb0 100644
--- a/src/gui/kernel/qplatformscreenpageflipper_qpa.cpp
+++ b/src/gui/kernel/qplatformscreenpageflipper_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformscreenpageflipper_qpa.h"
+#include "qplatformscreenpageflipper.h"
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/kernel/qplatformscreenpageflipper_qpa.h b/src/gui/kernel/qplatformscreenpageflipper_qpa.h
deleted file mode 100644
index 116d2db..0000000
--- a/src/gui/kernel/qplatformscreenpageflipper_qpa.h
+++ /dev/null
@@ -1,98 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMSCREENPAGEFLIPPER_QPA_H
-#define QPLATFORMSCREENPAGEFLIPPER_QPA_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/QObject>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-class Q_GUI_EXPORT QPlatformScreenBuffer {
-public:
-    QPlatformScreenBuffer();
-    virtual ~QPlatformScreenBuffer();
-
-    bool isDestroyed() const;
-    bool isReady() const;
-
-    virtual void aboutToBeDisplayed();
-    virtual void displayed();
-    virtual void release() = 0;
-
-    virtual void *handle() const = 0;
-
-protected:
-    bool m_destroyed;
-    bool m_ready;
-};
-
-class Q_GUI_EXPORT QPlatformScreenPageFlipper : public QObject
-{
-    Q_OBJECT
-public:
-    explicit QPlatformScreenPageFlipper(QObject *parent = 0);
-
-    virtual bool displayBuffer(QPlatformScreenBuffer *) = 0;
-
-signals:
-    void bufferDisplayed(QPlatformScreenBuffer *);
-    void bufferReleased(QPlatformScreenBuffer *);
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMSCREENPAGEFLIPPER_QPA_H
diff --git a/src/gui/kernel/qplatformservices.h b/src/gui/kernel/qplatformservices.h
new file mode 100644
index 0000000..c9bfe02
--- /dev/null
+++ b/src/gui/kernel/qplatformservices.h
@@ -0,0 +1,76 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMSERVICES_QPA_H
+#define QPLATFORMSERVICES_QPA_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/QtGlobal>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+class QUrl;
+
+class Q_GUI_EXPORT QPlatformServices
+{
+public:
+    virtual ~QPlatformServices() { }
+
+    virtual bool openUrl(const QUrl &url);
+    virtual bool openDocument(const QUrl &url);
+};
+
+QT_END_NAMESPACE
+QT_END_HEADER
+
+#endif // QPLATFORMSERVICES_QPA_H
diff --git a/src/gui/kernel/qplatformservices_qpa.cpp b/src/gui/kernel/qplatformservices_qpa.cpp
index 7993a82..dac9e64 100644
--- a/src/gui/kernel/qplatformservices_qpa.cpp
+++ b/src/gui/kernel/qplatformservices_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformservices_qpa.h"
+#include "qplatformservices.h"
 
 #include <QtCore/QUrl>
 #include <QtCore/QString>
diff --git a/src/gui/kernel/qplatformservices_qpa.h b/src/gui/kernel/qplatformservices_qpa.h
deleted file mode 100644
index c9bfe02..0000000
--- a/src/gui/kernel/qplatformservices_qpa.h
+++ /dev/null
@@ -1,76 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMSERVICES_QPA_H
-#define QPLATFORMSERVICES_QPA_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/QtGlobal>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-class QUrl;
-
-class Q_GUI_EXPORT QPlatformServices
-{
-public:
-    virtual ~QPlatformServices() { }
-
-    virtual bool openUrl(const QUrl &url);
-    virtual bool openDocument(const QUrl &url);
-};
-
-QT_END_NAMESPACE
-QT_END_HEADER
-
-#endif // QPLATFORMSERVICES_QPA_H
diff --git a/src/gui/kernel/qplatformsharedgraphicscache.h b/src/gui/kernel/qplatformsharedgraphicscache.h
new file mode 100644
index 0000000..679b8ab
--- /dev/null
+++ b/src/gui/kernel/qplatformsharedgraphicscache.h
@@ -0,0 +1,109 @@
+/****************************************************************************
+**
+** Copyright (C) 2011 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMSHAREDGRAPHICSCACHE_QPA_H
+#define QPLATFORMSHAREDGRAPHICSCACHE_QPA_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qobject.h>
+#include <QtGui/qimage.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+QT_MODULE(Gui)
+
+class Q_GUI_EXPORT QPlatformSharedGraphicsCache: public QObject
+{
+    Q_OBJECT
+public:
+    enum PixelFormat
+    {
+        Alpha8
+    };
+
+    enum BufferType
+    {
+        OpenGLTexture
+    };
+
+    explicit QPlatformSharedGraphicsCache(QObject *parent = 0) : QObject(parent) {}
+
+    Q_INVOKABLE virtual void ensureCacheInitialized(const QByteArray &cacheId, BufferType bufferType,
+                                                    PixelFormat pixelFormat) = 0;
+
+    Q_INVOKABLE virtual void requestItems(const QByteArray &cacheId, const QVector<quint32> &itemIds) = 0;
+    Q_INVOKABLE virtual void insertItems(const QByteArray &cacheId,
+                                         const QVector<quint32> &itemIds,
+                                         const QVector<QImage> &items) = 0;
+    Q_INVOKABLE virtual void releaseItems(const QByteArray &cacheId, const QVector<quint32> &itemIds) = 0;
+
+    virtual uint textureIdForBuffer(void *bufferId) = 0;
+    virtual void referenceBuffer(void *bufferId) = 0;
+    virtual bool dereferenceBuffer(void *bufferId) = 0;
+    virtual QSize sizeOfBuffer(void *bufferId) = 0;
+    virtual void *eglImageForBuffer(void *bufferId) = 0;
+
+Q_SIGNALS:
+    void itemsMissing(const QByteArray &cacheId, const QVector<quint32> &itemIds);
+    void itemsAvailable(const QByteArray &cacheId, void *bufferId,
+                        const QVector<quint32> &itemIds, const QVector<QPoint> &positionsInBuffer);
+    void itemsInvalidated(const QByteArray &cacheId, const QVector<quint32> &itemIds);
+    void itemsUpdated(const QByteArray &cacheId, void *bufferId,
+                      const QVector<quint32> &itemIds, const QVector<QPoint> &positionsInBuffer);
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMSHAREDGRAPHICSCACHE_QPA_H
diff --git a/src/gui/kernel/qplatformsharedgraphicscache_qpa.cpp b/src/gui/kernel/qplatformsharedgraphicscache_qpa.cpp
index 539bb14..a3bb8da 100644
--- a/src/gui/kernel/qplatformsharedgraphicscache_qpa.cpp
+++ b/src/gui/kernel/qplatformsharedgraphicscache_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformsharedgraphicscache_qpa.h"
+#include "qplatformsharedgraphicscache.h"
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/kernel/qplatformsharedgraphicscache_qpa.h b/src/gui/kernel/qplatformsharedgraphicscache_qpa.h
deleted file mode 100644
index 679b8ab..0000000
--- a/src/gui/kernel/qplatformsharedgraphicscache_qpa.h
+++ /dev/null
@@ -1,109 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2011 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMSHAREDGRAPHICSCACHE_QPA_H
-#define QPLATFORMSHAREDGRAPHICSCACHE_QPA_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qobject.h>
-#include <QtGui/qimage.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-QT_MODULE(Gui)
-
-class Q_GUI_EXPORT QPlatformSharedGraphicsCache: public QObject
-{
-    Q_OBJECT
-public:
-    enum PixelFormat
-    {
-        Alpha8
-    };
-
-    enum BufferType
-    {
-        OpenGLTexture
-    };
-
-    explicit QPlatformSharedGraphicsCache(QObject *parent = 0) : QObject(parent) {}
-
-    Q_INVOKABLE virtual void ensureCacheInitialized(const QByteArray &cacheId, BufferType bufferType,
-                                                    PixelFormat pixelFormat) = 0;
-
-    Q_INVOKABLE virtual void requestItems(const QByteArray &cacheId, const QVector<quint32> &itemIds) = 0;
-    Q_INVOKABLE virtual void insertItems(const QByteArray &cacheId,
-                                         const QVector<quint32> &itemIds,
-                                         const QVector<QImage> &items) = 0;
-    Q_INVOKABLE virtual void releaseItems(const QByteArray &cacheId, const QVector<quint32> &itemIds) = 0;
-
-    virtual uint textureIdForBuffer(void *bufferId) = 0;
-    virtual void referenceBuffer(void *bufferId) = 0;
-    virtual bool dereferenceBuffer(void *bufferId) = 0;
-    virtual QSize sizeOfBuffer(void *bufferId) = 0;
-    virtual void *eglImageForBuffer(void *bufferId) = 0;
-
-Q_SIGNALS:
-    void itemsMissing(const QByteArray &cacheId, const QVector<quint32> &itemIds);
-    void itemsAvailable(const QByteArray &cacheId, void *bufferId,
-                        const QVector<quint32> &itemIds, const QVector<QPoint> &positionsInBuffer);
-    void itemsInvalidated(const QByteArray &cacheId, const QVector<quint32> &itemIds);
-    void itemsUpdated(const QByteArray &cacheId, void *bufferId,
-                      const QVector<quint32> &itemIds, const QVector<QPoint> &positionsInBuffer);
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMSHAREDGRAPHICSCACHE_QPA_H
diff --git a/src/gui/kernel/qplatformsurface.h b/src/gui/kernel/qplatformsurface.h
new file mode 100644
index 0000000..f64a697
--- /dev/null
+++ b/src/gui/kernel/qplatformsurface.h
@@ -0,0 +1,85 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMSURFACE_H
+#define QPLATFORMSURFACE_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qnamespace.h>
+#include <QtGui/qsurface.h>
+#include <QtGui/qsurfaceformat.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class Q_GUI_EXPORT QPlatformSurface
+{
+public:
+    virtual ~QPlatformSurface();
+    virtual QSurfaceFormat format() const = 0;
+
+    QSurface::SurfaceClass surfaceClass() const;
+
+private:
+    explicit QPlatformSurface(QSurface::SurfaceClass type);
+
+    QSurface::SurfaceClass m_type;
+
+    friend class QPlatformWindow;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif //QPLATFORMSURFACE_H
diff --git a/src/gui/kernel/qplatformsurface_qpa.cpp b/src/gui/kernel/qplatformsurface_qpa.cpp
index 1f752fe..50cdd68 100644
--- a/src/gui/kernel/qplatformsurface_qpa.cpp
+++ b/src/gui/kernel/qplatformsurface_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformsurface_qpa.h"
+#include "qplatformsurface.h"
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/kernel/qplatformsurface_qpa.h b/src/gui/kernel/qplatformsurface_qpa.h
deleted file mode 100644
index f64a697..0000000
--- a/src/gui/kernel/qplatformsurface_qpa.h
+++ /dev/null
@@ -1,85 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMSURFACE_H
-#define QPLATFORMSURFACE_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qnamespace.h>
-#include <QtGui/qsurface.h>
-#include <QtGui/qsurfaceformat.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class Q_GUI_EXPORT QPlatformSurface
-{
-public:
-    virtual ~QPlatformSurface();
-    virtual QSurfaceFormat format() const = 0;
-
-    QSurface::SurfaceClass surfaceClass() const;
-
-private:
-    explicit QPlatformSurface(QSurface::SurfaceClass type);
-
-    QSurface::SurfaceClass m_type;
-
-    friend class QPlatformWindow;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif //QPLATFORMSURFACE_H
diff --git a/src/gui/kernel/qplatformtheme.h b/src/gui/kernel/qplatformtheme.h
new file mode 100644
index 0000000..8d936e8
--- /dev/null
+++ b/src/gui/kernel/qplatformtheme.h
@@ -0,0 +1,171 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMTHEME_H
+#define QPLATFORMTHEME_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/QtGlobal>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+class QMenu;
+class QMenuBar;
+class QPlatformMenu;
+class QPlatformMenuBar;
+class QPlatformDialogHelper;
+class QVariant;
+class QPalette;
+class QFont;
+
+class Q_GUI_EXPORT QPlatformTheme
+{
+public:
+    enum ThemeHint {
+        TextCursorWidth,
+        DropShadow,
+        MaximumScrollBarDragDistance,
+        ToolButtonStyle,
+        ToolBarIconSize,
+        ItemViewActivateItemOnSingleClick,
+        SystemIconThemeName,
+        SystemIconFallbackThemeName,
+        IconThemeSearchPaths,
+        StyleNames,
+        WindowAutoPlacement,
+        DialogButtonBoxLayout,
+        DialogButtonBoxButtonsHaveIcons,
+        UseFullScreenForPopupMenu,
+        KeyboardScheme
+    };
+
+    enum DialogType {
+        FileDialog,
+        ColorDialog,
+        FontDialog
+    };
+
+    enum Palette {
+        SystemPalette,
+        ToolTipPalette,
+        ToolButtonPalette,
+        ButtonPalette,
+        HeaderPalette,
+        ComboBoxPalette,
+        ItemViewPalette,
+        MessageBoxLabelPelette,
+        TabBarPalette,
+        LabelPalette,
+        GroupBoxPalette,
+        MenuPalette,
+        MenuBarPalette,
+        TextEditPalette,
+        TextLineEditPalette,
+        NPalettes
+    };
+
+    enum Font {
+        SystemFont,
+        MenuFont,
+        MenuBarFont,
+        MenuItemFont,
+        MessageBoxFont,
+        LabelFont,
+        TipLabelFont,
+        StatusBarFont,
+        TitleBarFont,
+        MdiSubWindowTitleFont,
+        DockWidgetTitleFont,
+        PushButtonFont,
+        ToolButtonFont,
+        ItemViewFont,
+        ListViewFont,
+        HeaderViewFont,
+        ListBoxFont,
+        ComboMenuItemFont,
+        ComboLineEditFont,
+        SmallFont,
+        MiniFont,
+        NFonts
+    };
+
+    enum KeyboardSchemes
+    {
+        WindowsKeyboardScheme,
+        MacKeyboardScheme,
+        X11KeyboardScheme,
+        KdeKeyboardScheme,
+        GnomeKeyboardScheme,
+        CdeKeyboardScheme
+    };
+
+    virtual ~QPlatformTheme();
+
+    virtual QPlatformMenu *createPlatformMenu(QMenu *menu = 0) const;
+    virtual QPlatformMenuBar *createPlatformMenuBar(QMenuBar *menuBar = 0) const;
+
+    virtual bool usePlatformNativeDialog(DialogType type) const;
+    virtual QPlatformDialogHelper *createPlatformDialogHelper(DialogType type) const;
+
+    virtual const QPalette *palette(Palette type = SystemPalette) const;
+
+    virtual const QFont *font(Font type = SystemFont) const;
+
+    virtual QVariant themeHint(ThemeHint hint) const;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMTHEME_H
diff --git a/src/gui/kernel/qplatformtheme_qpa.cpp b/src/gui/kernel/qplatformtheme_qpa.cpp
index c631482..07a1d7f 100644
--- a/src/gui/kernel/qplatformtheme_qpa.cpp
+++ b/src/gui/kernel/qplatformtheme_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformtheme_qpa.h"
+#include "qplatformtheme.h"
 
 #include <QtCore/QVariant>
 #include <QtCore/QStringList>
diff --git a/src/gui/kernel/qplatformtheme_qpa.h b/src/gui/kernel/qplatformtheme_qpa.h
deleted file mode 100644
index 8d936e8..0000000
--- a/src/gui/kernel/qplatformtheme_qpa.h
+++ /dev/null
@@ -1,171 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMTHEME_H
-#define QPLATFORMTHEME_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/QtGlobal>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-class QMenu;
-class QMenuBar;
-class QPlatformMenu;
-class QPlatformMenuBar;
-class QPlatformDialogHelper;
-class QVariant;
-class QPalette;
-class QFont;
-
-class Q_GUI_EXPORT QPlatformTheme
-{
-public:
-    enum ThemeHint {
-        TextCursorWidth,
-        DropShadow,
-        MaximumScrollBarDragDistance,
-        ToolButtonStyle,
-        ToolBarIconSize,
-        ItemViewActivateItemOnSingleClick,
-        SystemIconThemeName,
-        SystemIconFallbackThemeName,
-        IconThemeSearchPaths,
-        StyleNames,
-        WindowAutoPlacement,
-        DialogButtonBoxLayout,
-        DialogButtonBoxButtonsHaveIcons,
-        UseFullScreenForPopupMenu,
-        KeyboardScheme
-    };
-
-    enum DialogType {
-        FileDialog,
-        ColorDialog,
-        FontDialog
-    };
-
-    enum Palette {
-        SystemPalette,
-        ToolTipPalette,
-        ToolButtonPalette,
-        ButtonPalette,
-        HeaderPalette,
-        ComboBoxPalette,
-        ItemViewPalette,
-        MessageBoxLabelPelette,
-        TabBarPalette,
-        LabelPalette,
-        GroupBoxPalette,
-        MenuPalette,
-        MenuBarPalette,
-        TextEditPalette,
-        TextLineEditPalette,
-        NPalettes
-    };
-
-    enum Font {
-        SystemFont,
-        MenuFont,
-        MenuBarFont,
-        MenuItemFont,
-        MessageBoxFont,
-        LabelFont,
-        TipLabelFont,
-        StatusBarFont,
-        TitleBarFont,
-        MdiSubWindowTitleFont,
-        DockWidgetTitleFont,
-        PushButtonFont,
-        ToolButtonFont,
-        ItemViewFont,
-        ListViewFont,
-        HeaderViewFont,
-        ListBoxFont,
-        ComboMenuItemFont,
-        ComboLineEditFont,
-        SmallFont,
-        MiniFont,
-        NFonts
-    };
-
-    enum KeyboardSchemes
-    {
-        WindowsKeyboardScheme,
-        MacKeyboardScheme,
-        X11KeyboardScheme,
-        KdeKeyboardScheme,
-        GnomeKeyboardScheme,
-        CdeKeyboardScheme
-    };
-
-    virtual ~QPlatformTheme();
-
-    virtual QPlatformMenu *createPlatformMenu(QMenu *menu = 0) const;
-    virtual QPlatformMenuBar *createPlatformMenuBar(QMenuBar *menuBar = 0) const;
-
-    virtual bool usePlatformNativeDialog(DialogType type) const;
-    virtual QPlatformDialogHelper *createPlatformDialogHelper(DialogType type) const;
-
-    virtual const QPalette *palette(Palette type = SystemPalette) const;
-
-    virtual const QFont *font(Font type = SystemFont) const;
-
-    virtual QVariant themeHint(ThemeHint hint) const;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMTHEME_H
diff --git a/src/gui/kernel/qplatformthemefactory_p.h b/src/gui/kernel/qplatformthemefactory_p.h
new file mode 100644
index 0000000..4d65981
--- /dev/null
+++ b/src/gui/kernel/qplatformthemefactory_p.h
@@ -0,0 +1,76 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMTHEMEFACTORY_H
+#define QPLATFORMTHEMEFACTORY_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qstringlist.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformTheme;
+
+class QPlatformThemeFactory
+{
+public:
+    static QStringList keys(const QString &platformPluginPath = QString());
+    static QPlatformTheme *create(const QString &key, const QString &platformPluginPath = QString());
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMTHEMEFACTORY_H
diff --git a/src/gui/kernel/qplatformthemefactory_qpa.cpp b/src/gui/kernel/qplatformthemefactory_qpa.cpp
index c023a73..8294591 100644
--- a/src/gui/kernel/qplatformthemefactory_qpa.cpp
+++ b/src/gui/kernel/qplatformthemefactory_qpa.cpp
@@ -39,8 +39,8 @@
 **
 ****************************************************************************/
 
-#include "qplatformthemefactory_qpa_p.h"
-#include <QPlatformThemePlugin>
+#include <qpa/qplatformthemefactory_p.h>
+#include <qpa/qplatformthemeplugin.h>
 #include "private/qfactoryloader_p.h"
 #include "qmutex.h"
 
diff --git a/src/gui/kernel/qplatformthemefactory_qpa_p.h b/src/gui/kernel/qplatformthemefactory_qpa_p.h
deleted file mode 100644
index 4d65981..0000000
--- a/src/gui/kernel/qplatformthemefactory_qpa_p.h
+++ /dev/null
@@ -1,76 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMTHEMEFACTORY_H
-#define QPLATFORMTHEMEFACTORY_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qstringlist.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformTheme;
-
-class QPlatformThemeFactory
-{
-public:
-    static QStringList keys(const QString &platformPluginPath = QString());
-    static QPlatformTheme *create(const QString &key, const QString &platformPluginPath = QString());
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMTHEMEFACTORY_H
diff --git a/src/gui/kernel/qplatformthemeplugin.h b/src/gui/kernel/qplatformthemeplugin.h
new file mode 100644
index 0000000..3ce7cc5
--- /dev/null
+++ b/src/gui/kernel/qplatformthemeplugin.h
@@ -0,0 +1,91 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMTHEMEPLUGIN_H
+#define QPLATFORMTHEMEPLUGIN_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qplugin.h>
+#include <QtCore/qfactoryinterface.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformTheme;
+
+struct QPlatformThemeFactoryInterface : public QFactoryInterface
+{
+    virtual QPlatformTheme *create(const QString &key, const QStringList &paramList) = 0;
+};
+
+#define QPlatformThemeFactoryInterface_iid "org.qt-project.Qt.QPlatformThemeFactoryInterface"
+
+Q_DECLARE_INTERFACE(QPlatformThemeFactoryInterface, QPlatformThemeFactoryInterface_iid)
+
+class Q_GUI_EXPORT QPlatformThemePlugin : public QObject, public QPlatformThemeFactoryInterface
+{
+    Q_OBJECT
+    Q_INTERFACES(QPlatformThemeFactoryInterface:QFactoryInterface)
+public:
+    explicit QPlatformThemePlugin(QObject *parent = 0);
+    ~QPlatformThemePlugin();
+
+    virtual QStringList keys() const = 0;
+    virtual QPlatformTheme *create(const QString &key, const QStringList &paramList) = 0;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMTHEMEPLUGIN_H
diff --git a/src/gui/kernel/qplatformthemeplugin_qpa.cpp b/src/gui/kernel/qplatformthemeplugin_qpa.cpp
index da2743d..be18716 100644
--- a/src/gui/kernel/qplatformthemeplugin_qpa.cpp
+++ b/src/gui/kernel/qplatformthemeplugin_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformthemeplugin_qpa.h"
+#include "qplatformthemeplugin.h"
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/kernel/qplatformthemeplugin_qpa.h b/src/gui/kernel/qplatformthemeplugin_qpa.h
deleted file mode 100644
index 3ce7cc5..0000000
--- a/src/gui/kernel/qplatformthemeplugin_qpa.h
+++ /dev/null
@@ -1,91 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMTHEMEPLUGIN_H
-#define QPLATFORMTHEMEPLUGIN_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qplugin.h>
-#include <QtCore/qfactoryinterface.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformTheme;
-
-struct QPlatformThemeFactoryInterface : public QFactoryInterface
-{
-    virtual QPlatformTheme *create(const QString &key, const QStringList &paramList) = 0;
-};
-
-#define QPlatformThemeFactoryInterface_iid "org.qt-project.Qt.QPlatformThemeFactoryInterface"
-
-Q_DECLARE_INTERFACE(QPlatformThemeFactoryInterface, QPlatformThemeFactoryInterface_iid)
-
-class Q_GUI_EXPORT QPlatformThemePlugin : public QObject, public QPlatformThemeFactoryInterface
-{
-    Q_OBJECT
-    Q_INTERFACES(QPlatformThemeFactoryInterface:QFactoryInterface)
-public:
-    explicit QPlatformThemePlugin(QObject *parent = 0);
-    ~QPlatformThemePlugin();
-
-    virtual QStringList keys() const = 0;
-    virtual QPlatformTheme *create(const QString &key, const QStringList &paramList) = 0;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMTHEMEPLUGIN_H
diff --git a/src/gui/kernel/qplatformwindow.h b/src/gui/kernel/qplatformwindow.h
new file mode 100644
index 0000000..0b4c675
--- /dev/null
+++ b/src/gui/kernel/qplatformwindow.h
@@ -0,0 +1,129 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+#ifndef QPLATFORMWINDOW_H
+#define QPLATFORMWINDOW_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qscopedpointer.h>
+#include <QtCore/qrect.h>
+#include <QtCore/qmargins.h>
+#include <QtCore/qstring.h>
+#include <QtGui/qwindowdefs.h>
+#include <QtGui/qwindow.h>
+#include <qpa/qplatformopenglcontext.h>
+#include <qpa/qplatformsurface.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformScreen;
+class QPlatformWindowPrivate;
+class QWindow;
+
+class Q_GUI_EXPORT QPlatformWindow : public QPlatformSurface
+{
+    Q_DECLARE_PRIVATE(QPlatformWindow)
+public:
+    explicit QPlatformWindow(QWindow *window);
+    virtual ~QPlatformWindow();
+
+    QWindow *window() const;
+    QPlatformWindow *parent() const;
+
+    QPlatformScreen *screen() const;
+
+    virtual QSurfaceFormat format() const;
+
+    virtual void setGeometry(const QRect &rect);
+    virtual QRect geometry() const;
+
+    virtual QMargins frameMargins() const;
+
+    virtual void setVisible(bool visible);
+    virtual Qt::WindowFlags setWindowFlags(Qt::WindowFlags flags);
+    virtual Qt::WindowState setWindowState(Qt::WindowState state);
+
+    virtual WId winId() const;
+    virtual void setParent(const QPlatformWindow *window);
+
+    virtual void setWindowTitle(const QString &title);
+    virtual void raise();
+    virtual void lower();
+
+    virtual bool isExposed() const;
+
+    virtual void propagateSizeHints();
+
+    virtual void setOpacity(qreal level);
+    virtual void requestActivateWindow();
+
+    virtual void handleContentOrientationChange(Qt::ScreenOrientation orientation);
+    virtual Qt::ScreenOrientation requestWindowOrientation(Qt::ScreenOrientation orientation);
+
+    virtual bool setKeyboardGrabEnabled(bool grab);
+    virtual bool setMouseGrabEnabled(bool grab);
+
+    virtual bool setWindowModified(bool modified);
+
+    virtual void windowEvent(QEvent *event);
+
+protected:
+    QScopedPointer<QPlatformWindowPrivate> d_ptr;
+private:
+    Q_DISABLE_COPY(QPlatformWindow)
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+#endif //QPLATFORMWINDOW_H
diff --git a/src/gui/kernel/qplatformwindow_qpa.cpp b/src/gui/kernel/qplatformwindow_qpa.cpp
index b507eb4..2081736 100644
--- a/src/gui/kernel/qplatformwindow_qpa.cpp
+++ b/src/gui/kernel/qplatformwindow_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformwindow_qpa.h"
+#include "qplatformwindow.h"
 
 #include <QtGui/qwindowsysteminterface_qpa.h>
 #include <QtGui/qwindow.h>
diff --git a/src/gui/kernel/qplatformwindow_qpa.h b/src/gui/kernel/qplatformwindow_qpa.h
deleted file mode 100644
index 729f35e..0000000
--- a/src/gui/kernel/qplatformwindow_qpa.h
+++ /dev/null
@@ -1,129 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-#ifndef QPLATFORMWINDOW_H
-#define QPLATFORMWINDOW_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qscopedpointer.h>
-#include <QtCore/qrect.h>
-#include <QtCore/qmargins.h>
-#include <QtCore/qstring.h>
-#include <QtGui/qwindowdefs.h>
-#include <QtGui/qwindow.h>
-#include <QtGui/qplatformopenglcontext_qpa.h>
-#include <QtGui/qplatformsurface_qpa.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformScreen;
-class QPlatformWindowPrivate;
-class QWindow;
-
-class Q_GUI_EXPORT QPlatformWindow : public QPlatformSurface
-{
-    Q_DECLARE_PRIVATE(QPlatformWindow)
-public:
-    explicit QPlatformWindow(QWindow *window);
-    virtual ~QPlatformWindow();
-
-    QWindow *window() const;
-    QPlatformWindow *parent() const;
-
-    QPlatformScreen *screen() const;
-
-    virtual QSurfaceFormat format() const;
-
-    virtual void setGeometry(const QRect &rect);
-    virtual QRect geometry() const;
-
-    virtual QMargins frameMargins() const;
-
-    virtual void setVisible(bool visible);
-    virtual Qt::WindowFlags setWindowFlags(Qt::WindowFlags flags);
-    virtual Qt::WindowState setWindowState(Qt::WindowState state);
-
-    virtual WId winId() const;
-    virtual void setParent(const QPlatformWindow *window);
-
-    virtual void setWindowTitle(const QString &title);
-    virtual void raise();
-    virtual void lower();
-
-    virtual bool isExposed() const;
-
-    virtual void propagateSizeHints();
-
-    virtual void setOpacity(qreal level);
-    virtual void requestActivateWindow();
-
-    virtual void handleContentOrientationChange(Qt::ScreenOrientation orientation);
-    virtual Qt::ScreenOrientation requestWindowOrientation(Qt::ScreenOrientation orientation);
-
-    virtual bool setKeyboardGrabEnabled(bool grab);
-    virtual bool setMouseGrabEnabled(bool grab);
-
-    virtual bool setWindowModified(bool modified);
-
-    virtual void windowEvent(QEvent *event);
-
-protected:
-    QScopedPointer<QPlatformWindowPrivate> d_ptr;
-private:
-    Q_DISABLE_COPY(QPlatformWindow)
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-#endif //QPLATFORMWINDOW_H
diff --git a/src/gui/kernel/qscreen.cpp b/src/gui/kernel/qscreen.cpp
index 3546ce0..716caac 100644
--- a/src/gui/kernel/qscreen.cpp
+++ b/src/gui/kernel/qscreen.cpp
@@ -42,7 +42,7 @@
 #include "qscreen.h"
 #include "qscreen_p.h"
 #include "qpixmap.h"
-#include "qplatformscreen_qpa.h"
+#include <qpa/qplatformscreen.h>
 
 #include <QtCore/private/qobject_p.h>
 
diff --git a/src/gui/kernel/qscreen_p.h b/src/gui/kernel/qscreen_p.h
index c6bf37e..0167384 100644
--- a/src/gui/kernel/qscreen_p.h
+++ b/src/gui/kernel/qscreen_p.h
@@ -43,7 +43,7 @@
 #define QSCREEN_P_H
 
 #include <QtGui/qscreen.h>
-#include <QtGui/qplatformscreen_qpa.h>
+#include <qpa/qplatformscreen.h>
 
 #include <QtCore/private/qobject_p.h>
 
diff --git a/src/gui/kernel/qstylehints.cpp b/src/gui/kernel/qstylehints.cpp
index 9384d34..a98e5fb 100644
--- a/src/gui/kernel/qstylehints.cpp
+++ b/src/gui/kernel/qstylehints.cpp
@@ -40,7 +40,7 @@
 ****************************************************************************/
 
 #include <qstylehints.h>
-#include <qplatformintegration_qpa.h>
+#include <qpa/qplatformintegration.h>
 #include <private/qguiapplication_p.h>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/gui/kernel/qwindow.cpp b/src/gui/kernel/qwindow.cpp
index 8b37fce..6183b3f 100644
--- a/src/gui/kernel/qwindow.cpp
+++ b/src/gui/kernel/qwindow.cpp
@@ -41,11 +41,11 @@
 
 #include "qwindow.h"
 
-#include "qplatformwindow_qpa.h"
-#include "qplatformintegration_qpa.h"
+#include <qpa/qplatformwindow.h>
+#include <qpa/qplatformintegration.h>
 #include "qsurfaceformat.h"
 #ifndef QT_NO_OPENGL
-#include "qplatformopenglcontext_qpa.h"
+#include <qpa/qplatformopenglcontext.h>
 #include "qopenglcontext.h"
 #endif
 #include "qscreen.h"
diff --git a/src/gui/kernel/qwindow_p.h b/src/gui/kernel/qwindow_p.h
index 0afd903..92eaf90 100644
--- a/src/gui/kernel/qwindow_p.h
+++ b/src/gui/kernel/qwindow_p.h
@@ -43,7 +43,7 @@
 #define QWINDOW_P_H
 
 #include <QtGui/qwindow.h>
-#include <QtGui/qplatformwindow_qpa.h>
+#include <qpa/qplatformwindow.h>
 
 #include <QtCore/private/qobject_p.h>
 
diff --git a/src/gui/kernel/qwindowsysteminterface_qpa.cpp b/src/gui/kernel/qwindowsysteminterface_qpa.cpp
index a0b77b8..83cf8c3 100644
--- a/src/gui/kernel/qwindowsysteminterface_qpa.cpp
+++ b/src/gui/kernel/qwindowsysteminterface_qpa.cpp
@@ -39,13 +39,13 @@
 **
 ****************************************************************************/
 #include "qwindowsysteminterface_qpa.h"
-#include "qplatformwindow_qpa.h"
+#include <qpa/qplatformwindow.h>
 #include "qwindowsysteminterface_qpa_p.h"
 #include "private/qguiapplication_p.h"
 #include "private/qevent_p.h"
 #include "private/qtouchdevice_p.h"
 #include <QAbstractEventDispatcher>
-#include <QPlatformDrag>
+#include <qpa/qplatformdrag.h>
 #include <qdebug.h>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/gui/opengl/qopengltexturecache.cpp b/src/gui/opengl/qopengltexturecache.cpp
index e4d5ff9..d514d71 100644
--- a/src/gui/opengl/qopengltexturecache.cpp
+++ b/src/gui/opengl/qopengltexturecache.cpp
@@ -42,7 +42,7 @@
 #include "qopengltexturecache_p.h"
 #include <private/qopenglcontext_p.h>
 #include <private/qimagepixmapcleanuphooks_p.h>
-#include <qplatformpixmap_qpa.h>
+#include <qpa/qplatformpixmap.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/painting/painting.pri b/src/gui/painting/painting.pri
index a8f6a5b..7a20f35 100644
--- a/src/gui/painting/painting.pri
+++ b/src/gui/painting/painting.pri
@@ -33,7 +33,7 @@ HEADERS += \
         painting/qstroker_p.h \
         painting/qtextureglyphcache_p.h \
         painting/qtransform.h \
-        painting/qplatformbackingstore_qpa.h \
+        painting/qplatformbackingstore.h \
         painting/qpaintbuffer_p.h \
         painting/qpathsimplifier_p.h
 
diff --git a/src/gui/painting/qbackingstore.cpp b/src/gui/painting/qbackingstore.cpp
index 63f7ba5..1469476 100644
--- a/src/gui/painting/qbackingstore.cpp
+++ b/src/gui/painting/qbackingstore.cpp
@@ -42,8 +42,8 @@
 #include <qbackingstore.h>
 #include <qwindow.h>
 #include <qpixmap.h>
-#include <qplatformbackingstore_qpa.h>
-#include <qplatformintegration_qpa.h>
+#include <qpa/qplatformbackingstore.h>
+#include <qpa/qplatformintegration.h>
 #include <qscreen.h>
 
 #include <private/qguiapplication_p.h>
diff --git a/src/gui/painting/qplatformbackingstore.h b/src/gui/painting/qplatformbackingstore.h
new file mode 100644
index 0000000..a4df63f
--- /dev/null
+++ b/src/gui/painting/qplatformbackingstore.h
@@ -0,0 +1,102 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMBACKINGSTORE_QPA_H
+#define QPLATFORMBACKINGSTORE_QPA_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qrect.h>
+
+#include <QtGui/qwindow.h>
+#include <QtGui/qregion.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QRegion;
+class QRect;
+class QPoint;
+class QImage;
+class QPlatformBackingStorePrivate;
+class QPlatformWindow;
+
+class Q_GUI_EXPORT QPlatformBackingStore
+{
+public:
+    explicit QPlatformBackingStore(QWindow *window);
+    virtual ~QPlatformBackingStore();
+
+    QWindow *window() const;
+
+    virtual QPaintDevice *paintDevice() = 0;
+
+    // 'window' can be a child window, in which case 'region' is in child window coordinates and
+    // offset is the (child) window's offset in relation to the window surface.
+    virtual void flush(QWindow *window, const QRegion &region, const QPoint &offset) = 0;
+
+    virtual void resize(const QSize &size, const QRegion &staticContents) = 0;
+
+    virtual bool scroll(const QRegion &area, int dx, int dy);
+
+    virtual void beginPaint(const QRegion &);
+    virtual void endPaint();
+
+private:
+    QPlatformBackingStorePrivate *d_ptr;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMBACKINGSTORE_QPA_H
diff --git a/src/gui/painting/qplatformbackingstore_qpa.cpp b/src/gui/painting/qplatformbackingstore_qpa.cpp
index 485190d..34cda00 100644
--- a/src/gui/painting/qplatformbackingstore_qpa.cpp
+++ b/src/gui/painting/qplatformbackingstore_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <qplatformbackingstore_qpa.h>
+#include "qplatformbackingstore.h"
 #include <qwindow.h>
 #include <qpixmap.h>
 #include <private/qwindow_p.h>
diff --git a/src/gui/painting/qplatformbackingstore_qpa.h b/src/gui/painting/qplatformbackingstore_qpa.h
deleted file mode 100644
index a4df63f..0000000
--- a/src/gui/painting/qplatformbackingstore_qpa.h
+++ /dev/null
@@ -1,102 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMBACKINGSTORE_QPA_H
-#define QPLATFORMBACKINGSTORE_QPA_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qrect.h>
-
-#include <QtGui/qwindow.h>
-#include <QtGui/qregion.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QRegion;
-class QRect;
-class QPoint;
-class QImage;
-class QPlatformBackingStorePrivate;
-class QPlatformWindow;
-
-class Q_GUI_EXPORT QPlatformBackingStore
-{
-public:
-    explicit QPlatformBackingStore(QWindow *window);
-    virtual ~QPlatformBackingStore();
-
-    QWindow *window() const;
-
-    virtual QPaintDevice *paintDevice() = 0;
-
-    // 'window' can be a child window, in which case 'region' is in child window coordinates and
-    // offset is the (child) window's offset in relation to the window surface.
-    virtual void flush(QWindow *window, const QRegion &region, const QPoint &offset) = 0;
-
-    virtual void resize(const QSize &size, const QRegion &staticContents) = 0;
-
-    virtual bool scroll(const QRegion &area, int dx, int dy);
-
-    virtual void beginPaint(const QRegion &);
-    virtual void endPaint();
-
-private:
-    QPlatformBackingStorePrivate *d_ptr;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMBACKINGSTORE_QPA_H
diff --git a/src/gui/text/qfont.cpp b/src/gui/text/qfont.cpp
index 161bb4e..ccbd335 100644
--- a/src/gui/text/qfont.cpp
+++ b/src/gui/text/qfont.cpp
@@ -62,7 +62,7 @@
 #include <private/qtextengine_p.h>
 #include <limits.h>
 
-#include <QtGui/qplatformscreen_qpa.h>
+#include <qpa/qplatformscreen.h>
 #include <QtGui/private/qguiapplication_p.h>
 
 #include <QtCore/QMutexLocker>
diff --git a/src/gui/text/qfont_qpa.cpp b/src/gui/text/qfont_qpa.cpp
index b73b030..8422409 100644
--- a/src/gui/text/qfont_qpa.cpp
+++ b/src/gui/text/qfont_qpa.cpp
@@ -40,8 +40,8 @@
 ****************************************************************************/
 
 #include <QtGui/private/qguiapplication_p.h>
-#include <QtGui/QPlatformIntegration>
-#include <QtGui/QPlatformFontDatabase>
+#include <qpa/qplatformintegration.h>
+#include <qpa/qplatformfontdatabase.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/text/qfontdatabase.cpp b/src/gui/text/qfontdatabase.cpp
index a1af856..0a56ca3 100644
--- a/src/gui/text/qfontdatabase.cpp
+++ b/src/gui/text/qfontdatabase.cpp
@@ -50,10 +50,10 @@
 #include "qfileinfo.h"
 #include "private/qunicodetables_p.h"
 #include "qfontengine_p.h"
-#include "qplatformintegration_qpa.h"
+#include <qpa/qplatformintegration.h>
 
 #include <QtGui/private/qguiapplication_p.h>
-#include <QtGui/qplatformfontdatabase_qpa.h>
+#include <qpa/qplatformfontdatabase.h>
 
 #include <stdlib.h>
 #include <limits.h>
diff --git a/src/gui/text/qfontdatabase_qpa.cpp b/src/gui/text/qfontdatabase_qpa.cpp
index c2a3aa9..d7e5441 100644
--- a/src/gui/text/qfontdatabase_qpa.cpp
+++ b/src/gui/text/qfontdatabase_qpa.cpp
@@ -46,7 +46,7 @@
 #include "qplatformdefs.h"
 
 #include <QtGui/private/qguiapplication_p.h>
-#include <QtGui/qplatformfontdatabase_qpa.h>
+#include <qpa/qplatformfontdatabase.h>
 
 #include <QtCore/qmath.h>
 
diff --git a/src/gui/text/qfontengine_qpa.cpp b/src/gui/text/qfontengine_qpa.cpp
index bf0cfd1..dcb0a4f 100644
--- a/src/gui/text/qfontengine_qpa.cpp
+++ b/src/gui/text/qfontengine_qpa.cpp
@@ -48,8 +48,8 @@
 
 #include <QtGui/private/qpaintengine_raster_p.h>
 #include <QtGui/private/qguiapplication_p.h>
-#include <QtGui/QPlatformFontDatabase>
-#include <QtGui/QPlatformIntegration>
+#include <qpa/qplatformfontdatabase.h>
+#include <qpa/qplatformintegration.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/gui/text/qplatformfontdatabase.h b/src/gui/text/qplatformfontdatabase.h
new file mode 100644
index 0000000..08faf8d
--- /dev/null
+++ b/src/gui/text/qplatformfontdatabase.h
@@ -0,0 +1,131 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMFONTDATABASE_QPA_H
+#define QPLATFORMFONTDATABASE_QPA_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qconfig.h>
+#include <QtCore/QString>
+#include <QtCore/QStringList>
+#include <QtCore/QList>
+#include <QtCore/QHash>
+#include <QtGui/QFontDatabase>
+#include <QtGui/private/qfont_p.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QWritingSystemsPrivate;
+
+class Q_GUI_EXPORT QSupportedWritingSystems
+{
+public:
+
+    QSupportedWritingSystems();
+    QSupportedWritingSystems(const QSupportedWritingSystems &other);
+    QSupportedWritingSystems &operator=(const QSupportedWritingSystems &other);
+    ~QSupportedWritingSystems();
+
+    void setSupported(QFontDatabase::WritingSystem, bool supported = true);
+    bool supported(QFontDatabase::WritingSystem) const;
+
+private:
+    void detach();
+
+    QWritingSystemsPrivate *d;
+
+    friend Q_GUI_EXPORT bool operator==(const QSupportedWritingSystems &, const QSupportedWritingSystems &);
+    friend Q_GUI_EXPORT bool operator!=(const QSupportedWritingSystems &, const QSupportedWritingSystems &);
+};
+
+Q_GUI_EXPORT bool operator==(const QSupportedWritingSystems &, const QSupportedWritingSystems &);
+Q_GUI_EXPORT bool operator!=(const QSupportedWritingSystems &, const QSupportedWritingSystems &);
+
+class QFontRequestPrivate;
+class QFontEngineMulti;
+
+class Q_GUI_EXPORT QPlatformFontDatabase
+{
+public:
+    virtual ~QPlatformFontDatabase();
+    virtual void populateFontDatabase();
+    virtual QFontEngineMulti *fontEngineMulti(QFontEngine *fontEngine, QUnicodeTables::Script script);
+    virtual QFontEngine *fontEngine(const QFontDef &fontDef, QUnicodeTables::Script script, void *handle);
+    virtual QStringList fallbacksForFamily(const QString family, const QFont::Style &style, const QFont::StyleHint &styleHint, const QUnicodeTables::Script &script) const;
+    virtual QStringList addApplicationFont(const QByteArray &fontData, const QString &fileName);
+    virtual void releaseHandle(void *handle);
+
+    virtual QFontEngine *fontEngine(const QByteArray &fontData, qreal pixelSize, QFont::HintingPreference hintingPreference);
+
+    virtual QString fontDir() const;
+
+    virtual QFont defaultFont() const;
+
+    virtual QString resolveFontFamilyAlias(const QString &family) const;
+    virtual bool fontsAlwaysScalable() const;
+    virtual QList<int> standardSizes() const;
+
+    //callback
+    static void registerQPF2Font(const QByteArray &dataArray, void *handle);
+    static void registerFont(const QString &familyname, const QString &foundryname, QFont::Weight weight,
+                             QFont::Style style, QFont::Stretch stretch, bool antialiased,
+                             bool scalable, int pixelSize, bool fixedPitch,
+                             const QSupportedWritingSystems &writingSystems, void *handle);
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMFONTDATABASE_QPA_H
diff --git a/src/gui/text/qplatformfontdatabase_qpa.cpp b/src/gui/text/qplatformfontdatabase_qpa.cpp
index 632d2d8..3531202 100644
--- a/src/gui/text/qplatformfontdatabase_qpa.cpp
+++ b/src/gui/text/qplatformfontdatabase_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformfontdatabase_qpa.h"
+#include "qplatformfontdatabase.h"
 #include <QtGui/private/qfontengine_p.h>
 #include <QtGui/private/qfontengine_qpa_p.h>
 #include <QtCore/QLibraryInfo>
diff --git a/src/gui/text/qplatformfontdatabase_qpa.h b/src/gui/text/qplatformfontdatabase_qpa.h
deleted file mode 100644
index 08faf8d..0000000
--- a/src/gui/text/qplatformfontdatabase_qpa.h
+++ /dev/null
@@ -1,131 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMFONTDATABASE_QPA_H
-#define QPLATFORMFONTDATABASE_QPA_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qconfig.h>
-#include <QtCore/QString>
-#include <QtCore/QStringList>
-#include <QtCore/QList>
-#include <QtCore/QHash>
-#include <QtGui/QFontDatabase>
-#include <QtGui/private/qfont_p.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QWritingSystemsPrivate;
-
-class Q_GUI_EXPORT QSupportedWritingSystems
-{
-public:
-
-    QSupportedWritingSystems();
-    QSupportedWritingSystems(const QSupportedWritingSystems &other);
-    QSupportedWritingSystems &operator=(const QSupportedWritingSystems &other);
-    ~QSupportedWritingSystems();
-
-    void setSupported(QFontDatabase::WritingSystem, bool supported = true);
-    bool supported(QFontDatabase::WritingSystem) const;
-
-private:
-    void detach();
-
-    QWritingSystemsPrivate *d;
-
-    friend Q_GUI_EXPORT bool operator==(const QSupportedWritingSystems &, const QSupportedWritingSystems &);
-    friend Q_GUI_EXPORT bool operator!=(const QSupportedWritingSystems &, const QSupportedWritingSystems &);
-};
-
-Q_GUI_EXPORT bool operator==(const QSupportedWritingSystems &, const QSupportedWritingSystems &);
-Q_GUI_EXPORT bool operator!=(const QSupportedWritingSystems &, const QSupportedWritingSystems &);
-
-class QFontRequestPrivate;
-class QFontEngineMulti;
-
-class Q_GUI_EXPORT QPlatformFontDatabase
-{
-public:
-    virtual ~QPlatformFontDatabase();
-    virtual void populateFontDatabase();
-    virtual QFontEngineMulti *fontEngineMulti(QFontEngine *fontEngine, QUnicodeTables::Script script);
-    virtual QFontEngine *fontEngine(const QFontDef &fontDef, QUnicodeTables::Script script, void *handle);
-    virtual QStringList fallbacksForFamily(const QString family, const QFont::Style &style, const QFont::StyleHint &styleHint, const QUnicodeTables::Script &script) const;
-    virtual QStringList addApplicationFont(const QByteArray &fontData, const QString &fileName);
-    virtual void releaseHandle(void *handle);
-
-    virtual QFontEngine *fontEngine(const QByteArray &fontData, qreal pixelSize, QFont::HintingPreference hintingPreference);
-
-    virtual QString fontDir() const;
-
-    virtual QFont defaultFont() const;
-
-    virtual QString resolveFontFamilyAlias(const QString &family) const;
-    virtual bool fontsAlwaysScalable() const;
-    virtual QList<int> standardSizes() const;
-
-    //callback
-    static void registerQPF2Font(const QByteArray &dataArray, void *handle);
-    static void registerFont(const QString &familyname, const QString &foundryname, QFont::Weight weight,
-                             QFont::Style style, QFont::Stretch stretch, bool antialiased,
-                             bool scalable, int pixelSize, bool fixedPitch,
-                             const QSupportedWritingSystems &writingSystems, void *handle);
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMFONTDATABASE_QPA_H
diff --git a/src/gui/text/qrawfont_qpa.cpp b/src/gui/text/qrawfont_qpa.cpp
index d037d59..7289450 100644
--- a/src/gui/text/qrawfont_qpa.cpp
+++ b/src/gui/text/qrawfont_qpa.cpp
@@ -44,8 +44,8 @@
 #if !defined(QT_NO_RAWFONT)
 
 #include "qrawfont_p.h"
-#include "qplatformintegration_qpa.h"
-#include <QtGui/qplatformfontdatabase_qpa.h>
+#include <qpa/qplatformintegration.h>
+#include <qpa/qplatformfontdatabase.h>
 #include <private/qguiapplication_p.h>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/gui/text/text.pri b/src/gui/text/text.pri
index 6587769..d0dd0ed 100644
--- a/src/gui/text/text.pri
+++ b/src/gui/text/text.pri
@@ -102,7 +102,7 @@ SOURCES += \
       text/qrawfont_qpa.cpp
 
 HEADERS += \
-      text/qplatformfontdatabase_qpa.h
+      text/qplatformfontdatabase.h
 
 DEFINES += QT_NO_OPENTYPE
 INCLUDEPATH += ../3rdparty/harfbuzz/src
diff --git a/src/gui/util/qdesktopservices.cpp b/src/gui/util/qdesktopservices.cpp
index a941c06..0fba6e6 100644
--- a/src/gui/util/qdesktopservices.cpp
+++ b/src/gui/util/qdesktopservices.cpp
@@ -52,8 +52,8 @@
 #include <private/qguiapplication_p.h>
 #include <qurl.h>
 #include <qmutex.h>
-#include <qplatformservices_qpa.h>
-#include <qplatformintegration_qpa.h>
+#include <qpa/qplatformservices.h>
+#include <qpa/qplatformintegration.h>
 #include <qdir.h>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/opengl/qgl.cpp b/src/opengl/qgl.cpp
index e306ea4..d298777 100644
--- a/src/opengl/qgl.cpp
+++ b/src/opengl/qgl.cpp
@@ -55,13 +55,13 @@
 
 #include "gl2paintengineex/qpaintengineex_opengl2_p.h"
 
-#include <QtGui/QPlatformOpenGLContext>
+#include <qpa/qplatformopenglcontext.h>
 
 #include <qglpixelbuffer.h>
 #include <qglframebufferobject.h>
 
 #include <private/qimage_p.h>
-#include <qplatformpixmap_qpa.h>
+#include <qpa/qplatformpixmap.h>
 #include <private/qglpixelbuffer_p.h>
 #include <private/qimagepixmapcleanuphooks_p.h>
 #include "qcolormap.h"
diff --git a/src/opengl/qgl_qpa.cpp b/src/opengl/qgl_qpa.cpp
index 8810b70..05c0d9f 100644
--- a/src/opengl/qgl_qpa.cpp
+++ b/src/opengl/qgl_qpa.cpp
@@ -45,8 +45,8 @@
 #include <QDebug>
 
 #include <private/qapplication_p.h>
-#include <QtGui/QPlatformOpenGLContext>
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformopenglcontext.h>
+#include <qpa/qplatformwindow.h>
 #include <QtGui/QSurfaceFormat>
 
 #include "qgl.h"
diff --git a/src/platformsupport/dnd/qsimpledrag_p.h b/src/platformsupport/dnd/qsimpledrag_p.h
index 7270684..fa87f09 100644
--- a/src/platformsupport/dnd/qsimpledrag_p.h
+++ b/src/platformsupport/dnd/qsimpledrag_p.h
@@ -42,7 +42,7 @@
 #ifndef QSIMPLEDRAG_H
 #define QSIMPLEDRAG_H
 
-#include <qplatformdrag_qpa.h>
+#include <qpa/qplatformdrag.h>
 
 #include <QtCore/QObject>
 
diff --git a/src/platformsupport/eglconvenience/qeglplatformcontext.cpp b/src/platformsupport/eglconvenience/qeglplatformcontext.cpp
index 71e1820..97b4571 100644
--- a/src/platformsupport/eglconvenience/qeglplatformcontext.cpp
+++ b/src/platformsupport/eglconvenience/qeglplatformcontext.cpp
@@ -43,7 +43,7 @@
 
 #include "qeglconvenience_p.h"
 
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 
 #include <EGL/egl.h>
 
diff --git a/src/platformsupport/eglconvenience/qeglplatformcontext_p.h b/src/platformsupport/eglconvenience/qeglplatformcontext_p.h
index 75375fa..d48d49a 100644
--- a/src/platformsupport/eglconvenience/qeglplatformcontext_p.h
+++ b/src/platformsupport/eglconvenience/qeglplatformcontext_p.h
@@ -42,8 +42,8 @@
 #ifndef QEGLPLATFORMCONTEXT_H
 #define QEGLPLATFORMCONTEXT_H
 
-#include <QtGui/QPlatformWindow>
-#include <QtGui/QPlatformOpenGLContext>
+#include <qpa/qplatformwindow.h>
+#include <qpa/qplatformopenglcontext.h>
 #include <EGL/egl.h>
 
 class QEGLPlatformContext : public QPlatformOpenGLContext
diff --git a/src/platformsupport/fb_base/fb_base.cpp b/src/platformsupport/fb_base/fb_base.cpp
index 0cdd091..5162749 100644
--- a/src/platformsupport/fb_base/fb_base.cpp
+++ b/src/platformsupport/fb_base/fb_base.cpp
@@ -43,7 +43,7 @@
 #include <qpainter.h>
 #include <qdebug.h>
 #include <qbitmap.h>
-#include <QPlatformCursor>
+#include <qpa/qplatformcursor.h>
 #include <QWindowSystemInterface>
 
 QPlatformSoftwareCursor::QPlatformSoftwareCursor(QPlatformScreen *scr)
diff --git a/src/platformsupport/fb_base/fb_base_p.h b/src/platformsupport/fb_base/fb_base_p.h
index c9862c6..187ae96 100644
--- a/src/platformsupport/fb_base/fb_base_p.h
+++ b/src/platformsupport/fb_base/fb_base_p.h
@@ -46,9 +46,9 @@
 #include <qimage.h>
 #include <qtimer.h>
 #include <qpainter.h>
-#include <QPlatformCursor>
-#include <QPlatformScreen>
-#include <QPlatformWindow>
+#include <qpa/qplatformcursor.h>
+#include <qpa/qplatformscreen.h>
+#include <qpa/qplatformwindow.h>
 #include <QtGui/private/qwindowsurface_p.h>
 
 class QMouseEvent;
diff --git a/src/platformsupport/fontdatabases/basic/qbasicfontdatabase.cpp b/src/platformsupport/fontdatabases/basic/qbasicfontdatabase.cpp
index cddc08c..e96659d 100644
--- a/src/platformsupport/fontdatabases/basic/qbasicfontdatabase.cpp
+++ b/src/platformsupport/fontdatabases/basic/qbasicfontdatabase.cpp
@@ -42,7 +42,7 @@
 #include "qbasicfontdatabase_p.h"
 
 #include <QtGui/private/qguiapplication_p.h>
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 
 #include <QtCore/QFile>
 #include <QtCore/QLibraryInfo>
diff --git a/src/platformsupport/fontdatabases/basic/qbasicfontdatabase_p.h b/src/platformsupport/fontdatabases/basic/qbasicfontdatabase_p.h
index fd6e180..eb4b11c 100644
--- a/src/platformsupport/fontdatabases/basic/qbasicfontdatabase_p.h
+++ b/src/platformsupport/fontdatabases/basic/qbasicfontdatabase_p.h
@@ -42,7 +42,7 @@
 #ifndef QBASICFONTDATABASE_H
 #define QBASICFONTDATABASE_H
 
-#include <QPlatformFontDatabase>
+#include <qpa/qplatformfontdatabase.h>
 #include <QtCore/QByteArray>
 #include <QtCore/QString>
 
diff --git a/src/platformsupport/fontdatabases/fontconfig/qfontconfigdatabase.cpp b/src/platformsupport/fontdatabases/fontconfig/qfontconfigdatabase.cpp
index 9ad9b96..d995ffb 100644
--- a/src/platformsupport/fontdatabases/fontconfig/qfontconfigdatabase.cpp
+++ b/src/platformsupport/fontdatabases/fontconfig/qfontconfigdatabase.cpp
@@ -47,7 +47,7 @@
 
 #include <QtCore/QElapsedTimer>
 
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 
 #include <QtGui/private/qfontengine_ft_p.h>
 #include <QtGui/private/qfontengine_p.h>
diff --git a/src/platformsupport/fontdatabases/fontconfig/qfontconfigdatabase_p.h b/src/platformsupport/fontdatabases/fontconfig/qfontconfigdatabase_p.h
index df62dde..9859bd7 100644
--- a/src/platformsupport/fontdatabases/fontconfig/qfontconfigdatabase_p.h
+++ b/src/platformsupport/fontdatabases/fontconfig/qfontconfigdatabase_p.h
@@ -42,7 +42,7 @@
 #ifndef QFONTCONFIGDATABASE_H
 #define QFONTCONFIGDATABASE_H
 
-#include <QPlatformFontDatabase>
+#include <qpa/qplatformfontdatabase.h>
 #include <QtPlatformSupport/private/qbasicfontdatabase_p.h>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/platformsupport/fontdatabases/mac/qcoretextfontdatabase_p.h b/src/platformsupport/fontdatabases/mac/qcoretextfontdatabase_p.h
index 01aed89..e38e01d 100644
--- a/src/platformsupport/fontdatabases/mac/qcoretextfontdatabase_p.h
+++ b/src/platformsupport/fontdatabases/mac/qcoretextfontdatabase_p.h
@@ -42,7 +42,7 @@
 #ifndef QCORETEXTFONTDATABASE_H
 #define QCORETEXTFONTDATABASE_H
 
-#include <QPlatformFontDatabase>
+#include <qpa/qplatformfontdatabase.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/platformsupport/inputcontext/inputcontext.pri b/src/platformsupport/inputcontext/inputcontext.pri
index e1a4468..8debcd0 100644
--- a/src/platformsupport/inputcontext/inputcontext.pri
+++ b/src/platformsupport/inputcontext/inputcontext.pri
@@ -1,6 +1,6 @@
 HEADERS += \
-    $$PWD/qplatforminputcontextplugin_qpa_p.h \
-    $$PWD/qplatforminputcontextfactory_qpa_p.h
+    $$PWD/qplatforminputcontextplugin_p.h \
+    $$PWD/qplatforminputcontextfactory_p.h
 SOURCES += \
     $$PWD/qplatforminputcontextplugin_qpa.cpp \
     $$PWD/qplatforminputcontextfactory_qpa.cpp
diff --git a/src/platformsupport/inputcontext/qplatforminputcontextfactory_p.h b/src/platformsupport/inputcontext/qplatforminputcontextfactory_p.h
new file mode 100644
index 0000000..a7ed2eb
--- /dev/null
+++ b/src/platformsupport/inputcontext/qplatforminputcontextfactory_p.h
@@ -0,0 +1,78 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMINPUTCONTEXTFACTORY_H
+#define QPLATFORMINPUTCONTEXTFACTORY_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qstringlist.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformInputContext;
+
+class QPlatformInputContextFactory
+{
+public:
+    static QStringList keys();
+    static QPlatformInputContext *create(const QString &key);
+    static QPlatformInputContext *create();
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMINPUTCONTEXTFACTORY_H
+
diff --git a/src/platformsupport/inputcontext/qplatforminputcontextfactory_qpa.cpp b/src/platformsupport/inputcontext/qplatforminputcontextfactory_qpa.cpp
index ca3673f..6d90942 100644
--- a/src/platformsupport/inputcontext/qplatforminputcontextfactory_qpa.cpp
+++ b/src/platformsupport/inputcontext/qplatforminputcontextfactory_qpa.cpp
@@ -39,9 +39,9 @@
 **
 ****************************************************************************/
 
-#include "qplatforminputcontextfactory_qpa_p.h"
-#include "qplatforminputcontextplugin_qpa_p.h"
-#include <QPlatformInputContext>
+#include <qpa/qplatforminputcontextfactory_p.h>
+#include <qpa/qplatforminputcontextplugin_p.h>
+#include <qpa/qplatforminputcontext.h>
 #include "private/qfactoryloader_p.h"
 
 #include "qguiapplication.h"
diff --git a/src/platformsupport/inputcontext/qplatforminputcontextfactory_qpa_p.h b/src/platformsupport/inputcontext/qplatforminputcontextfactory_qpa_p.h
deleted file mode 100644
index a7ed2eb..0000000
--- a/src/platformsupport/inputcontext/qplatforminputcontextfactory_qpa_p.h
+++ /dev/null
@@ -1,78 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMINPUTCONTEXTFACTORY_H
-#define QPLATFORMINPUTCONTEXTFACTORY_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qstringlist.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformInputContext;
-
-class QPlatformInputContextFactory
-{
-public:
-    static QStringList keys();
-    static QPlatformInputContext *create(const QString &key);
-    static QPlatformInputContext *create();
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMINPUTCONTEXTFACTORY_H
-
diff --git a/src/platformsupport/inputcontext/qplatforminputcontextplugin_p.h b/src/platformsupport/inputcontext/qplatforminputcontextplugin_p.h
new file mode 100644
index 0000000..e9e4195
--- /dev/null
+++ b/src/platformsupport/inputcontext/qplatforminputcontextplugin_p.h
@@ -0,0 +1,91 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMINPUTCONTEXTPLUGIN_H
+#define QPLATFORMINPUTCONTEXTPLUGIN_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qplugin.h>
+#include <QtCore/qfactoryinterface.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformInputContext;
+
+    struct QPlatformInputContextFactoryInterface : public QFactoryInterface
+{
+    virtual QPlatformInputContext *create(const QString &key, const QStringList &paramList) = 0;
+};
+
+#define QPlatformInputContextFactoryInterface_iid "org.qt-project.Qt.QPlatformInputContextFactoryInterface"
+
+Q_DECLARE_INTERFACE(QPlatformInputContextFactoryInterface, QPlatformInputContextFactoryInterface_iid)
+
+class Q_PLATFORMSUPPORT_EXPORT QPlatformInputContextPlugin : public QObject, public QPlatformInputContextFactoryInterface
+{
+    Q_OBJECT
+    Q_INTERFACES(QPlatformInputContextFactoryInterface:QFactoryInterface)
+public:
+    explicit QPlatformInputContextPlugin(QObject *parent = 0);
+    ~QPlatformInputContextPlugin();
+
+    virtual QStringList keys() const = 0;
+    virtual QPlatformInputContext *create(const QString &key, const QStringList &paramList) = 0;
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMINPUTCONTEXTPLUGIN_H
diff --git a/src/platformsupport/inputcontext/qplatforminputcontextplugin_qpa.cpp b/src/platformsupport/inputcontext/qplatforminputcontextplugin_qpa.cpp
index 88cd9cd..670bfd0 100644
--- a/src/platformsupport/inputcontext/qplatforminputcontextplugin_qpa.cpp
+++ b/src/platformsupport/inputcontext/qplatforminputcontextplugin_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatforminputcontextplugin_qpa_p.h"
+#include "qplatforminputcontextplugin_p.h"
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/platformsupport/inputcontext/qplatforminputcontextplugin_qpa_p.h b/src/platformsupport/inputcontext/qplatforminputcontextplugin_qpa_p.h
deleted file mode 100644
index e9e4195..0000000
--- a/src/platformsupport/inputcontext/qplatforminputcontextplugin_qpa_p.h
+++ /dev/null
@@ -1,91 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMINPUTCONTEXTPLUGIN_H
-#define QPLATFORMINPUTCONTEXTPLUGIN_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qplugin.h>
-#include <QtCore/qfactoryinterface.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformInputContext;
-
-    struct QPlatformInputContextFactoryInterface : public QFactoryInterface
-{
-    virtual QPlatformInputContext *create(const QString &key, const QStringList &paramList) = 0;
-};
-
-#define QPlatformInputContextFactoryInterface_iid "org.qt-project.Qt.QPlatformInputContextFactoryInterface"
-
-Q_DECLARE_INTERFACE(QPlatformInputContextFactoryInterface, QPlatformInputContextFactoryInterface_iid)
-
-class Q_PLATFORMSUPPORT_EXPORT QPlatformInputContextPlugin : public QObject, public QPlatformInputContextFactoryInterface
-{
-    Q_OBJECT
-    Q_INTERFACES(QPlatformInputContextFactoryInterface:QFactoryInterface)
-public:
-    explicit QPlatformInputContextPlugin(QObject *parent = 0);
-    ~QPlatformInputContextPlugin();
-
-    virtual QStringList keys() const = 0;
-    virtual QPlatformInputContext *create(const QString &key, const QStringList &paramList) = 0;
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMINPUTCONTEXTPLUGIN_H
diff --git a/src/platformsupport/printersupport/genericunix/qgenericunixprintersupport_p.h b/src/platformsupport/printersupport/genericunix/qgenericunixprintersupport_p.h
index 369e827..d6b2d0d 100644
--- a/src/platformsupport/printersupport/genericunix/qgenericunixprintersupport_p.h
+++ b/src/platformsupport/printersupport/genericunix/qgenericunixprintersupport_p.h
@@ -42,7 +42,7 @@
 #ifndef QGENERICUNIXPRINTINGSUPPORT_H
 #define QGENERICUNIXPRINTINGSUPPORT_H
 
-#include <QtPrintSupport/QPlatformPrinterSupport>
+#include <qpa/qplatformprintersupport.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/platformsupport/services/genericunix/qgenericunixservices_p.h b/src/platformsupport/services/genericunix/qgenericunixservices_p.h
index 3923a45..b0dbccc 100644
--- a/src/platformsupport/services/genericunix/qgenericunixservices_p.h
+++ b/src/platformsupport/services/genericunix/qgenericunixservices_p.h
@@ -42,7 +42,7 @@
 #ifndef QGENERICUNIXDESKTOPSERVICES_H
 #define QGENERICUNIXDESKTOPSERVICES_H
 
-#include <QtGui/qplatformservices_qpa.h>
+#include <qpa/qplatformservices.h>
 #include <QtCore/QString>
 
 QT_BEGIN_HEADER
diff --git a/src/platformsupport/themes/genericunix/qgenericunixthemes_p.h b/src/platformsupport/themes/genericunix/qgenericunixthemes_p.h
index cabffc0..a1b5086 100644
--- a/src/platformsupport/themes/genericunix/qgenericunixthemes_p.h
+++ b/src/platformsupport/themes/genericunix/qgenericunixthemes_p.h
@@ -42,7 +42,7 @@
 #ifndef QGENERICUNIXTHEMES_H
 #define QGENERICUNIXTHEMES_H
 
-#include <QtGui/QPlatformTheme>
+#include <qpa/qplatformtheme.h>
 #include <QtCore/QString>
 #include <QtCore/QStringList>
 
diff --git a/src/plugins/platforminputcontexts/ibus/ibus.pro b/src/plugins/platforminputcontexts/ibus/ibus.pro
index 1241934..0fb92f2 100644
--- a/src/plugins/platforminputcontexts/ibus/ibus.pro
+++ b/src/plugins/platforminputcontexts/ibus/ibus.pro
@@ -3,7 +3,7 @@ load(qt_plugin)
 
 QTDIR_build:DESTDIR = $$QT_BUILD_TREE/plugins/platforminputcontexts
 
-QT += dbus platformsupport-private
+QT += dbus platformsupport-private gui-private
 SOURCES += $$PWD/qibusplatforminputcontext.cpp \
            $$PWD/qibusproxy.cpp \
            $$PWD/qibusinputcontextproxy.cpp \
diff --git a/src/plugins/platforminputcontexts/ibus/main.cpp b/src/plugins/platforminputcontexts/ibus/main.cpp
index 19f032b..d841426 100644
--- a/src/plugins/platforminputcontexts/ibus/main.cpp
+++ b/src/plugins/platforminputcontexts/ibus/main.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <private/qplatforminputcontextplugin_qpa_p.h>
+#include <qpa/qplatforminputcontextplugin_p.h>
 #include <QtCore/QStringList>
 #include "qibusplatforminputcontext.h"
 
diff --git a/src/plugins/platforminputcontexts/ibus/qibusplatforminputcontext.h b/src/plugins/platforminputcontexts/ibus/qibusplatforminputcontext.h
index 1ed4262..4d9f42e 100644
--- a/src/plugins/platforminputcontexts/ibus/qibusplatforminputcontext.h
+++ b/src/plugins/platforminputcontexts/ibus/qibusplatforminputcontext.h
@@ -41,7 +41,7 @@
 #ifndef QIBUSPLATFORMINPUTCONTEXT_H
 #define QIBUSPLATFORMINPUTCONTEXT_H
 
-#include <QPlatformInputContext>
+#include <qpa/qplatforminputcontext.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforminputcontexts/maliit/main.cpp b/src/plugins/platforminputcontexts/maliit/main.cpp
index 2552cc0..adeaa7b 100644
--- a/src/plugins/platforminputcontexts/maliit/main.cpp
+++ b/src/plugins/platforminputcontexts/maliit/main.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <private/qplatforminputcontextplugin_qpa_p.h>
+#include <qpa/qplatforminputcontextplugin_p.h>
 #include <QtCore/QStringList>
 #include "qmaliitplatforminputcontext.h"
 
diff --git a/src/plugins/platforminputcontexts/maliit/maliit.pro b/src/plugins/platforminputcontexts/maliit/maliit.pro
index 445e172..dbcd22e 100644
--- a/src/plugins/platforminputcontexts/maliit/maliit.pro
+++ b/src/plugins/platforminputcontexts/maliit/maliit.pro
@@ -3,7 +3,7 @@ load(qt_plugin)
 
 QTDIR_build:DESTDIR = $$QT_BUILD_TREE/plugins/platforminputcontexts
 
-QT += dbus platformsupport-private
+QT += dbus platformsupport-private gui-private
 SOURCES += $$PWD/qmaliitplatforminputcontext.cpp \
            $$PWD/serverproxy.cpp \
            $$PWD/serveraddressproxy.cpp \
diff --git a/src/plugins/platforminputcontexts/maliit/qmaliitplatforminputcontext.h b/src/plugins/platforminputcontexts/maliit/qmaliitplatforminputcontext.h
index 2612524..cb32fee 100644
--- a/src/plugins/platforminputcontexts/maliit/qmaliitplatforminputcontext.h
+++ b/src/plugins/platforminputcontexts/maliit/qmaliitplatforminputcontext.h
@@ -41,7 +41,7 @@
 #ifndef QMALIITPLATFORMINPUTCONTEXT_H
 #define QMALIITPLATFORMINPUTCONTEXT_H
 
-#include <QPlatformInputContext>
+#include <qpa/qplatforminputcontext.h>
 #include <QDBusArgument>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/cocoa/cocoa.pro b/src/plugins/platforms/cocoa/cocoa.pro
index f149a67..ccd98c5 100644
--- a/src/plugins/platforms/cocoa/cocoa.pro
+++ b/src/plugins/platforms/cocoa/cocoa.pro
@@ -77,7 +77,7 @@ RESOURCES += qcocoaresources.qrc
 
 LIBS += -framework Cocoa -framework IOKit
 
-QT += core-private gui-private widgets-private platformsupport-private printsupport
+QT += core-private gui-private widgets-private platformsupport-private printsupport-private
 
 OTHER_FILES += cocoa.json
 target.path += $$[QT_INSTALL_PLUGINS]/platforms
diff --git a/src/plugins/platforms/cocoa/main.mm b/src/plugins/platforms/cocoa/main.mm
index 9857a4e..fc17bd3 100644
--- a/src/plugins/platforms/cocoa/main.mm
+++ b/src/plugins/platforms/cocoa/main.mm
@@ -41,8 +41,8 @@
 
 #include <Cocoa/Cocoa.h>
 
-#include <QtGui/QPlatformIntegrationPlugin>
-#include <QtGui/QPlatformThemePlugin>
+#include <qpa/qplatformintegrationplugin.h>
+#include <qpa/qplatformthemeplugin.h>
 #include "qcocoaintegration.h"
 #include "qcocoatheme.h"
 
diff --git a/src/plugins/platforms/cocoa/qcocoabackingstore.h b/src/plugins/platforms/cocoa/qcocoabackingstore.h
index 72bb593..36fb4b4 100644
--- a/src/plugins/platforms/cocoa/qcocoabackingstore.h
+++ b/src/plugins/platforms/cocoa/qcocoabackingstore.h
@@ -47,7 +47,7 @@
 #include "qcocoawindow.h"
 #include "qnsview.h"
 
-#include <QPlatformBackingStore>
+#include <qpa/qplatformbackingstore.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/cocoa/qcocoaclipboard.h b/src/plugins/platforms/cocoa/qcocoaclipboard.h
index 2750505..d387ae9 100644
--- a/src/plugins/platforms/cocoa/qcocoaclipboard.h
+++ b/src/plugins/platforms/cocoa/qcocoaclipboard.h
@@ -42,7 +42,7 @@
 #ifndef QCOCOACLIPBOARD_H
 #define QCOCOACLIPBOARD_H
 
-#include <qplatformclipboard_qpa.h>
+#include <qpa/qplatformclipboard.h>
 #include "qmacclipboard.h"
 #include <QtCore/QScopedPointer>
 
diff --git a/src/plugins/platforms/cocoa/qcocoacolordialoghelper.h b/src/plugins/platforms/cocoa/qcocoacolordialoghelper.h
index 4b901f3..8845d7f 100644
--- a/src/plugins/platforms/cocoa/qcocoacolordialoghelper.h
+++ b/src/plugins/platforms/cocoa/qcocoacolordialoghelper.h
@@ -43,7 +43,7 @@
 #define QCOCOACOLORDIALOGHELPER_H
 
 #include <QObject>
-#include <qplatformdialoghelper_qpa.h>
+#include <qpa/qplatformdialoghelper.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/cocoa/qcocoacursor.h b/src/plugins/platforms/cocoa/qcocoacursor.h
index 85892ee..b57d624 100644
--- a/src/plugins/platforms/cocoa/qcocoacursor.h
+++ b/src/plugins/platforms/cocoa/qcocoacursor.h
@@ -45,7 +45,7 @@
 #include <Cocoa/Cocoa.h>
 
 #include <QtCore>
-#include <QtGui/QPlatformCursor>
+#include <qpa/qplatformcursor.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/cocoa/qcocoadrag.h b/src/plugins/platforms/cocoa/qcocoadrag.h
index 17df54f..5a0a3fa 100644
--- a/src/plugins/platforms/cocoa/qcocoadrag.h
+++ b/src/plugins/platforms/cocoa/qcocoadrag.h
@@ -44,7 +44,7 @@
 
 #include <Cocoa/Cocoa.h>
 #include <QtGui>
-#include <qplatformdrag_qpa.h>
+#include <qpa/qplatformdrag.h>
 #include <QtPlatformSupport/private/qsimpledrag_p.h>
 
 #include <QtGui/private/qdnd_p.h>
diff --git a/src/plugins/platforms/cocoa/qcocoaeventdispatcher.mm b/src/plugins/platforms/cocoa/qcocoaeventdispatcher.mm
index a3bd4a9..ddaa7a7 100644
--- a/src/plugins/platforms/cocoa/qcocoaeventdispatcher.mm
+++ b/src/plugins/platforms/cocoa/qcocoaeventdispatcher.mm
@@ -81,8 +81,8 @@
 #include "qhash.h"
 #include "qmutex.h"
 #include "qsocketnotifier.h"
-#include <qplatformwindow_qpa.h>
-#include <qplatformnativeinterface_qpa.h>
+#include <qpa/qplatformwindow.h>
+#include <qpa/qplatformnativeinterface.h>
 #include "private/qthread_p.h"
 #include "private/qguiapplication_p.h"
 #include <qdebug.h>
diff --git a/src/plugins/platforms/cocoa/qcocoafiledialoghelper.h b/src/plugins/platforms/cocoa/qcocoafiledialoghelper.h
index 9768d3e..5b7af09 100644
--- a/src/plugins/platforms/cocoa/qcocoafiledialoghelper.h
+++ b/src/plugins/platforms/cocoa/qcocoafiledialoghelper.h
@@ -43,7 +43,7 @@
 #define QCOCOAFILEDIALOGHELPER_H
 
 #include <QObject>
-#include <qplatformdialoghelper_qpa.h>
+#include <qpa/qplatformdialoghelper.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/cocoa/qcocoafontdialoghelper.h b/src/plugins/platforms/cocoa/qcocoafontdialoghelper.h
index f9dd435..501e67d 100644
--- a/src/plugins/platforms/cocoa/qcocoafontdialoghelper.h
+++ b/src/plugins/platforms/cocoa/qcocoafontdialoghelper.h
@@ -43,7 +43,7 @@
 #define QCOCOAFONTDIALOGHELPER_H
 
 #include <QObject>
-#include <qplatformdialoghelper_qpa.h>
+#include <qpa/qplatformdialoghelper.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/cocoa/qcocoaglcontext.h b/src/plugins/platforms/cocoa/qcocoaglcontext.h
index 4f80511..6c0fcd1 100644
--- a/src/plugins/platforms/cocoa/qcocoaglcontext.h
+++ b/src/plugins/platforms/cocoa/qcocoaglcontext.h
@@ -43,7 +43,7 @@
 #define QCOCOAGLCONTEXT_H
 
 #include <QtCore/QWeakPointer>
-#include <QtGui/QPlatformOpenGLContext>
+#include <qpa/qplatformopenglcontext.h>
 #include <QtGui/QOpenGLContext>
 #include <QtGui/QWindow>
 
diff --git a/src/plugins/platforms/cocoa/qcocoahelpers.mm b/src/plugins/platforms/cocoa/qcocoahelpers.mm
index 60590b9..8f8d7b8 100644
--- a/src/plugins/platforms/cocoa/qcocoahelpers.mm
+++ b/src/plugins/platforms/cocoa/qcocoahelpers.mm
@@ -45,7 +45,7 @@
 
 #include <QtCore>
 #include <QtGui>
-#include <qplatformscreen_qpa.h>
+#include <qpa/qplatformscreen.h>
 #include <private/qguiapplication_p.h>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/cocoa/qcocoainputcontext.h b/src/plugins/platforms/cocoa/qcocoainputcontext.h
index 1fda292..7439311 100644
--- a/src/plugins/platforms/cocoa/qcocoainputcontext.h
+++ b/src/plugins/platforms/cocoa/qcocoainputcontext.h
@@ -42,7 +42,7 @@
 #ifndef QCOCOAINPUTCONTEXT_H
 #define QCOCOAINPUTCONTEXT_H
 
-#include <QtGui/QPlatformInputContext>
+#include <qpa/qplatforminputcontext.h>
 #include <QtCore/QPointer>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/cocoa/qcocoaintegration.h b/src/plugins/platforms/cocoa/qcocoaintegration.h
index a001b62..da84969 100644
--- a/src/plugins/platforms/cocoa/qcocoaintegration.h
+++ b/src/plugins/platforms/cocoa/qcocoaintegration.h
@@ -51,7 +51,7 @@
 #include "qcocoaservices.h"
 
 #include <QtCore/QScopedPointer>
-#include <QtGui/QPlatformIntegration>
+#include <qpa/qplatformintegration.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/cocoa/qcocoaintegration.mm b/src/plugins/platforms/cocoa/qcocoaintegration.mm
index 0b87773..b82519f 100644
--- a/src/plugins/platforms/cocoa/qcocoaintegration.mm
+++ b/src/plugins/platforms/cocoa/qcocoaintegration.mm
@@ -55,7 +55,7 @@
 #include "qcocoainputcontext.h"
 #include "qmacmime.h"
 
-#include <QtGui/qplatformaccessibility_qpa.h>
+#include <qpa/qplatformaccessibility.h>
 #include <QtCore/qcoreapplication.h>
 
 #include <QtWidgets/QDialog>
diff --git a/src/plugins/platforms/cocoa/qcocoanativeinterface.h b/src/plugins/platforms/cocoa/qcocoanativeinterface.h
index bb4d0f9..0346eaf 100644
--- a/src/plugins/platforms/cocoa/qcocoanativeinterface.h
+++ b/src/plugins/platforms/cocoa/qcocoanativeinterface.h
@@ -42,8 +42,8 @@
 #ifndef QCOCOANATIVEINTERFACE_H
 #define QCOCOANATIVEINTERFACE_H
 
-#include <QtGui/QPlatformNativeInterface>
-#include <QtPrintSupport/QPlatformPrinterSupport>
+#include <qpa/qplatformnativeinterface.h>
+#include <qpa/qplatformprintersupport.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/cocoa/qcocoanativeinterface.mm b/src/plugins/platforms/cocoa/qcocoanativeinterface.mm
index ca15b6b..df9ae23 100644
--- a/src/plugins/platforms/cocoa/qcocoanativeinterface.mm
+++ b/src/plugins/platforms/cocoa/qcocoanativeinterface.mm
@@ -46,9 +46,9 @@
 
 #include <qbytearray.h>
 #include <qwindow.h>
-#include "qplatformwindow_qpa.h"
+#include <qpa/qplatformwindow.h>
 #include "qsurfaceformat.h"
-#include "qplatformopenglcontext_qpa.h"
+#include <qpa/qplatformopenglcontext.h>
 #include "qopenglcontext.h"
 #include <qdebug.h>
 
diff --git a/src/plugins/platforms/cocoa/qcocoaprintersupport.h b/src/plugins/platforms/cocoa/qcocoaprintersupport.h
index 2309025..88a83a4 100644
--- a/src/plugins/platforms/cocoa/qcocoaprintersupport.h
+++ b/src/plugins/platforms/cocoa/qcocoaprintersupport.h
@@ -42,7 +42,7 @@
 #ifndef QCOCOAPRINTERSUPPORT_H
 #define QCOCOAPRINTERSUPPORT_H
 
-#include <QtPrintSupport/QPlatformPrinterSupport>
+#include <qpa/qplatformprintersupport.h>
 
 class QCocoaPrinterSupport : public QPlatformPrinterSupport
 {
diff --git a/src/plugins/platforms/cocoa/qcocoaservices.h b/src/plugins/platforms/cocoa/qcocoaservices.h
index 022c39d..e3f5b3d 100644
--- a/src/plugins/platforms/cocoa/qcocoaservices.h
+++ b/src/plugins/platforms/cocoa/qcocoaservices.h
@@ -42,7 +42,7 @@
 #ifndef QCOCOADESKTOPSERVICES_H
 #define QCOCOADESKTOPSERVICES_H
 
-#include <QtGui/qplatformservices_qpa.h>
+#include <qpa/qplatformservices.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/cocoa/qcocoasystemsettings.h b/src/plugins/platforms/cocoa/qcocoasystemsettings.h
index 10cac27..5e12497 100644
--- a/src/plugins/platforms/cocoa/qcocoasystemsettings.h
+++ b/src/plugins/platforms/cocoa/qcocoasystemsettings.h
@@ -44,7 +44,7 @@
 
 #include <QtCore/qhash.h>
 #include <QtGui/qpalette.h>
-#include <QtGui/qplatformtheme_qpa.h>
+#include <qpa/qplatformtheme.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/cocoa/qcocoatheme.h b/src/plugins/platforms/cocoa/qcocoatheme.h
index 5cb6f74..791f1d4 100644
--- a/src/plugins/platforms/cocoa/qcocoatheme.h
+++ b/src/plugins/platforms/cocoa/qcocoatheme.h
@@ -43,7 +43,7 @@
 #define QPLATFORMTHEME_COCOA_H
 
 #include <QtCore/QHash>
-#include <QtGui/QPlatformTheme>
+#include <qpa/qplatformtheme.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/cocoa/qcocoawindow.h b/src/plugins/platforms/cocoa/qcocoawindow.h
index d08bbe7..f2d6ac6 100644
--- a/src/plugins/platforms/cocoa/qcocoawindow.h
+++ b/src/plugins/platforms/cocoa/qcocoawindow.h
@@ -44,7 +44,7 @@
 
 #include <Cocoa/Cocoa.h>
 
-#include <QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 #include <QRect>
 
 #include "qcocoaglcontext.h"
diff --git a/src/plugins/platforms/cocoa/qcocoawindow.mm b/src/plugins/platforms/cocoa/qcocoawindow.mm
index 83b6534..5480b32 100644
--- a/src/plugins/platforms/cocoa/qcocoawindow.mm
+++ b/src/plugins/platforms/cocoa/qcocoawindow.mm
@@ -48,7 +48,7 @@
 #include <QtCore/private/qcore_mac_p.h>
 #include <qwindow.h>
 #include <QWindowSystemInterface>
-#include <QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 
 #include <Cocoa/Cocoa.h>
 #include <Carbon/Carbon.h>
diff --git a/src/plugins/platforms/cocoa/qmenu_mac.h b/src/plugins/platforms/cocoa/qmenu_mac.h
index d41540a..7a91e2d 100644
--- a/src/plugins/platforms/cocoa/qmenu_mac.h
+++ b/src/plugins/platforms/cocoa/qmenu_mac.h
@@ -43,7 +43,7 @@
 #include <QtCore/qpointer.h>
 #include <QtWidgets/qmenu.h>
 #include <QtWidgets/qmenubar.h>
-#include <QtWidgets/qplatformmenu_qpa.h>
+#include <qpa/qplatformmenu.h>
 
 @class NSMenuItem;
 
diff --git a/src/plugins/platforms/cocoa/qpaintengine_mac.mm b/src/plugins/platforms/cocoa/qpaintengine_mac.mm
index 87f3713..33e6e39 100644
--- a/src/plugins/platforms/cocoa/qpaintengine_mac.mm
+++ b/src/plugins/platforms/cocoa/qpaintengine_mac.mm
@@ -56,7 +56,7 @@
 #include <qcoreapplication.h>
 #include <qmath.h>
 
-#include <QtGui/qplatformpixmap_qpa.h>
+#include <qpa/qplatformpixmap.h>
 
 #include <private/qfont_p.h>
 #include <private/qfontengine_p.h>
diff --git a/src/plugins/platforms/cocoa/qprintengine_mac.mm b/src/plugins/platforms/cocoa/qprintengine_mac.mm
index e432b12..921dd2f 100644
--- a/src/plugins/platforms/cocoa/qprintengine_mac.mm
+++ b/src/plugins/platforms/cocoa/qprintengine_mac.mm
@@ -43,7 +43,7 @@
 #include <qdebug.h>
 #include <qthread.h>
 #include <QtCore/qcoreapplication.h>
-#include <QtPrintSupport/QPlatformPrinterSupport>
+#include <qpa/qplatformprintersupport.h>
 
 #include "qcocoaautoreleasepool.h"
 
diff --git a/src/plugins/platforms/directfb/main.cpp b/src/plugins/platforms/directfb/main.cpp
index 26bdd71..86af137 100644
--- a/src/plugins/platforms/directfb/main.cpp
+++ b/src/plugins/platforms/directfb/main.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <QtGui/QPlatformIntegrationPlugin>
+#include <qpa/qplatformintegrationplugin.h>
 #include "qdirectfbintegration.h"
 #include "qdirectfb_egl.h"
 
diff --git a/src/plugins/platforms/directfb/qdirectfb_egl.cpp b/src/plugins/platforms/directfb/qdirectfb_egl.cpp
index ac9142c..f595cc4 100644
--- a/src/plugins/platforms/directfb/qdirectfb_egl.cpp
+++ b/src/plugins/platforms/directfb/qdirectfb_egl.cpp
@@ -45,7 +45,7 @@
 #include "qdirectfbeglhooks.h"
 
 #include <QtGui/QOpenGLContext>
-#include <QtGui/QPlatformOpenGLContext>
+#include <qpa/qplatformopenglcontext.h>
 #include <QtGui/QScreen>
 
 #include <QtPlatformSupport/private/qeglplatformcontext_p.h>
diff --git a/src/plugins/platforms/directfb/qdirectfbbackingstore.h b/src/plugins/platforms/directfb/qdirectfbbackingstore.h
index 327329a..63ce626 100644
--- a/src/plugins/platforms/directfb/qdirectfbbackingstore.h
+++ b/src/plugins/platforms/directfb/qdirectfbbackingstore.h
@@ -42,7 +42,7 @@
 #ifndef QWINDOWSURFACE_DIRECTFB_H
 #define QWINDOWSURFACE_DIRECTFB_H
 
-#include <qplatformbackingstore_qpa.h>
+#include <qpa/qplatformbackingstore.h>
 #include <private/qpixmap_blitter_p.h>
 
 #include <directfb.h>
diff --git a/src/plugins/platforms/directfb/qdirectfbcursor.h b/src/plugins/platforms/directfb/qdirectfbcursor.h
index f28e225..6413390 100644
--- a/src/plugins/platforms/directfb/qdirectfbcursor.h
+++ b/src/plugins/platforms/directfb/qdirectfbcursor.h
@@ -42,7 +42,7 @@
 #ifndef QDIRECTFBCURSOR_H
 #define QDIRECTFBCURSOR_H
 
-#include <QPlatformCursor>
+#include <qpa/qplatformcursor.h>
 #include <directfb.h>
 
 #include "qdirectfbconvenience.h"
diff --git a/src/plugins/platforms/directfb/qdirectfbeglhooks.h b/src/plugins/platforms/directfb/qdirectfbeglhooks.h
index d0711b6..96bce3b 100644
--- a/src/plugins/platforms/directfb/qdirectfbeglhooks.h
+++ b/src/plugins/platforms/directfb/qdirectfbeglhooks.h
@@ -42,7 +42,7 @@
 #ifndef QDIRECTFBEGL_HOOKS_H
 #define QDIRECTFBEGL_HOOKS_H
 
-#include "qplatformintegration_qpa.h"
+#include <qpa/qplatformintegration.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/directfb/qdirectfbglcontext.h b/src/plugins/platforms/directfb/qdirectfbglcontext.h
index 7aac12c..3e684ce 100644
--- a/src/plugins/platforms/directfb/qdirectfbglcontext.h
+++ b/src/plugins/platforms/directfb/qdirectfbglcontext.h
@@ -42,7 +42,7 @@
 #ifndef QDIRECTFBGLCONTEXT_H
 #define QDIRECTFBGLCONTEXT_H
 
-#include <QPlatformOpenGLContext>
+#include <qpa/qplatformopenglcontext.h>
 
 #include "qdirectfbconvenience.h"
 
diff --git a/src/plugins/platforms/directfb/qdirectfbintegration.cpp b/src/plugins/platforms/directfb/qdirectfbintegration.cpp
index d167c46..834e7da 100644
--- a/src/plugins/platforms/directfb/qdirectfbintegration.cpp
+++ b/src/plugins/platforms/directfb/qdirectfbintegration.cpp
@@ -52,7 +52,7 @@
 #include <QtGui/private/qpixmap_blitter_p.h>
 #include <QtGui/private/qpixmap_raster_p.h>
 #include <QtGui/private/qguiapplication_p.h>
-#include <QtGui/qplatformpixmap_qpa.h>
+#include <qpa/qplatformpixmap.h>
 #include <QtCore/QCoreApplication>
 #include <QtCore/QThread>
 #include <QtCore/QAbstractEventDispatcher>
diff --git a/src/plugins/platforms/directfb/qdirectfbintegration.h b/src/plugins/platforms/directfb/qdirectfbintegration.h
index 56d785e..c959ae5 100644
--- a/src/plugins/platforms/directfb/qdirectfbintegration.h
+++ b/src/plugins/platforms/directfb/qdirectfbintegration.h
@@ -45,7 +45,7 @@
 #include "qdirectfbinput.h"
 #include "qdirectfbscreen.h"
 
-#include <QtGui/QPlatformIntegration>
+#include <qpa/qplatformintegration.h>
 #include <directfb.h>
 #include <directfb_version.h>
 
diff --git a/src/plugins/platforms/directfb/qdirectfbscreen.h b/src/plugins/platforms/directfb/qdirectfbscreen.h
index 8535239..6e2aa0d 100644
--- a/src/plugins/platforms/directfb/qdirectfbscreen.h
+++ b/src/plugins/platforms/directfb/qdirectfbscreen.h
@@ -45,7 +45,7 @@
 #include "qdirectfbconvenience.h"
 #include "qdirectfbcursor.h"
 
-#include <QtGui/QPlatformIntegration>
+#include <qpa/qplatformintegration.h>
 
 #include <directfb.h>
 
diff --git a/src/plugins/platforms/directfb/qdirectfbwindow.h b/src/plugins/platforms/directfb/qdirectfbwindow.h
index e0206b5..bc9e4d9 100644
--- a/src/plugins/platforms/directfb/qdirectfbwindow.h
+++ b/src/plugins/platforms/directfb/qdirectfbwindow.h
@@ -42,7 +42,7 @@
 #ifndef QDIRECTFBWINDOW_H
 #define QDIRECTFBWINDOW_H
 
-#include <QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 
 #include "qdirectfbconvenience.h"
 #include "qdirectfbinput.h"
diff --git a/src/plugins/platforms/eglfs/main.cpp b/src/plugins/platforms/eglfs/main.cpp
index 2ca2199..4565b79 100644
--- a/src/plugins/platforms/eglfs/main.cpp
+++ b/src/plugins/platforms/eglfs/main.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <QtGui/QPlatformIntegrationPlugin>
+#include <qpa/qplatformintegrationplugin.h>
 #include "qeglfsintegration.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/eglfs/qeglfsbackingstore.h b/src/plugins/platforms/eglfs/qeglfsbackingstore.h
index f723bca..e9808b7 100644
--- a/src/plugins/platforms/eglfs/qeglfsbackingstore.h
+++ b/src/plugins/platforms/eglfs/qeglfsbackingstore.h
@@ -42,7 +42,7 @@
 #ifndef QEGLFSBACKINGSTORE_H
 #define QEGLFSBACKINGSTORE_H
 
-#include <QtGui/qplatformbackingstore_qpa.h>
+#include <qpa/qplatformbackingstore.h>
 
 #include <QImage>
 #include <QRegion>
diff --git a/src/plugins/platforms/eglfs/qeglfshooks.h b/src/plugins/platforms/eglfs/qeglfshooks.h
index a56c802..c6ea209 100644
--- a/src/plugins/platforms/eglfs/qeglfshooks.h
+++ b/src/plugins/platforms/eglfs/qeglfshooks.h
@@ -42,7 +42,7 @@
 #ifndef QEGLFSHOOKS_H
 #define QEGLFSHOOKS_H
 
-#include "qplatformintegration_qpa.h"
+#include <qpa/qplatformintegration.h>
 #include <EGL/egl.h>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/eglfs/qeglfsintegration.cpp b/src/plugins/platforms/eglfs/qeglfsintegration.cpp
index 9b7d924..7025aed 100644
--- a/src/plugins/platforms/eglfs/qeglfsintegration.cpp
+++ b/src/plugins/platforms/eglfs/qeglfsintegration.cpp
@@ -48,7 +48,7 @@
 #include <QtPlatformSupport/private/qgenericunixfontdatabase_p.h>
 #include <QtPlatformSupport/private/qgenericunixeventdispatcher_p.h>
 
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 #include <QtGui/QSurfaceFormat>
 #include <QtGui/QOpenGLContext>
 #include <QtGui/QScreen>
diff --git a/src/plugins/platforms/eglfs/qeglfsintegration.h b/src/plugins/platforms/eglfs/qeglfsintegration.h
index eea36a4..b7cb715 100644
--- a/src/plugins/platforms/eglfs/qeglfsintegration.h
+++ b/src/plugins/platforms/eglfs/qeglfsintegration.h
@@ -44,8 +44,8 @@
 
 #include "qeglfsscreen.h"
 
-#include <QtGui/QPlatformIntegration>
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformintegration.h>
+#include <qpa/qplatformscreen.h>
 
 QT_BEGIN_HEADER
 
diff --git a/src/plugins/platforms/eglfs/qeglfsscreen.h b/src/plugins/platforms/eglfs/qeglfsscreen.h
index 66e600d..8c67bf1 100644
--- a/src/plugins/platforms/eglfs/qeglfsscreen.h
+++ b/src/plugins/platforms/eglfs/qeglfsscreen.h
@@ -42,7 +42,7 @@
 #ifndef QEGLFSSCREEN_H
 #define QEGLFSSCREEN_H
 
-#include <QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 
 #include <QtCore/QTextStream>
 
diff --git a/src/plugins/platforms/eglfs/qeglfswindow.h b/src/plugins/platforms/eglfs/qeglfswindow.h
index 7f40c78..3e7a689 100644
--- a/src/plugins/platforms/eglfs/qeglfswindow.h
+++ b/src/plugins/platforms/eglfs/qeglfswindow.h
@@ -45,7 +45,7 @@
 #include "qeglfsintegration.h"
 #include "qeglfsscreen.h"
 
-#include <QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 #include <QtWidgets/QWidget>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/kms/main.cpp b/src/plugins/platforms/kms/main.cpp
index 422fc5f..c1baaf3 100644
--- a/src/plugins/platforms/kms/main.cpp
+++ b/src/plugins/platforms/kms/main.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <QtGui/QPlatformIntegrationPlugin>
+#include <qpa/qplatformintegrationplugin.h>
 #include "qkmsintegration.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/kms/qkmsbackingstore.h b/src/plugins/platforms/kms/qkmsbackingstore.h
index ab276fa..59d9c9a 100644
--- a/src/plugins/platforms/kms/qkmsbackingstore.h
+++ b/src/plugins/platforms/kms/qkmsbackingstore.h
@@ -42,7 +42,7 @@
 #ifndef QBACKINGSTORE_KMS_H
 #define QBACKINGSTORE_KMS_H
 
-#include <QtGui/QPlatformBackingStore>
+#include <qpa/qplatformbackingstore.h>
 #include <QImage>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/kms/qkmscontext.h b/src/plugins/platforms/kms/qkmscontext.h
index 6378780..32223ad 100644
--- a/src/plugins/platforms/kms/qkmscontext.h
+++ b/src/plugins/platforms/kms/qkmscontext.h
@@ -42,7 +42,7 @@
 #ifndef QKMSCONTEXT_H
 #define QKMSCONTEXT_H
 
-#include <QtGui/QPlatformOpenGLContext>
+#include <qpa/qplatformopenglcontext.h>
 
 #define EGL_EGLEXT_PROTOTYPES 1
 #include <EGL/egl.h>
diff --git a/src/plugins/platforms/kms/qkmscursor.h b/src/plugins/platforms/kms/qkmscursor.h
index f6e1176..c0734eb 100644
--- a/src/plugins/platforms/kms/qkmscursor.h
+++ b/src/plugins/platforms/kms/qkmscursor.h
@@ -42,7 +42,7 @@
 #ifndef QKMSCURSOR_H
 #define QKMSCURSOR_H
 
-#include <QtGui/QPlatformCursor>
+#include <qpa/qplatformcursor.h>
 
 #define EGL_EGLEXT_PROTOTYPES 1
 
diff --git a/src/plugins/platforms/kms/qkmsintegration.h b/src/plugins/platforms/kms/qkmsintegration.h
index 03fc508..93b3084 100644
--- a/src/plugins/platforms/kms/qkmsintegration.h
+++ b/src/plugins/platforms/kms/qkmsintegration.h
@@ -42,8 +42,8 @@
 #ifndef QPLATFORMINTEGRATION_KMS_H
 #define QPLATFORMINTEGRATION_KMS_H
 
-#include <QtGui/QPlatformIntegration>
-#include <QtGui/QPlatformNativeInterface>
+#include <qpa/qplatformintegration.h>
+#include <qpa/qplatformnativeinterface.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/kms/qkmsnativeinterface.h b/src/plugins/platforms/kms/qkmsnativeinterface.h
index 77a9573..20949be 100644
--- a/src/plugins/platforms/kms/qkmsnativeinterface.h
+++ b/src/plugins/platforms/kms/qkmsnativeinterface.h
@@ -44,7 +44,7 @@
 
 #include "qkmsscreen.h"
 
-#include <QtGui/QPlatformNativeInterface>
+#include <qpa/qplatformnativeinterface.h>
 
 class QKmsNativeInterface : public QPlatformNativeInterface
 {
diff --git a/src/plugins/platforms/kms/qkmsscreen.h b/src/plugins/platforms/kms/qkmsscreen.h
index 058314a..e8e6bda 100644
--- a/src/plugins/platforms/kms/qkmsscreen.h
+++ b/src/plugins/platforms/kms/qkmsscreen.h
@@ -42,7 +42,7 @@
 #ifndef QKMSSCREEN_H
 #define QKMSSCREEN_H
 
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 #include "qkmsbuffermanager.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/kms/qkmswindow.h b/src/plugins/platforms/kms/qkmswindow.h
index 2a78396..c9b3c26 100644
--- a/src/plugins/platforms/kms/qkmswindow.h
+++ b/src/plugins/platforms/kms/qkmswindow.h
@@ -42,7 +42,7 @@
 #ifndef QKMSWINDOW_H
 #define QKMSWINDOW_H
 
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/linuxfb/main.cpp b/src/plugins/platforms/linuxfb/main.cpp
index 1339700..f670b6f 100644
--- a/src/plugins/platforms/linuxfb/main.cpp
+++ b/src/plugins/platforms/linuxfb/main.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <QPlatformIntegrationPlugin>
+#include <qpa/qplatformintegrationplugin.h>
 #include "qlinuxfbintegration.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/linuxfb/qlinuxfbintegration.h b/src/plugins/platforms/linuxfb/qlinuxfbintegration.h
index 3c8f033..200cd81 100644
--- a/src/plugins/platforms/linuxfb/qlinuxfbintegration.h
+++ b/src/plugins/platforms/linuxfb/qlinuxfbintegration.h
@@ -42,7 +42,7 @@
 #ifndef QGRAPHICSSYSTEM_LINUXFB_H
 #define QGRAPHICSSYSTEM_LINUXFB_H
 
-#include <QPlatformIntegration>
+#include <qpa/qplatformintegration.h>
 #include "../fb_base/fb_base.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/minimal/main.cpp b/src/plugins/platforms/minimal/main.cpp
index 8a6e8fb..9ac75e1 100644
--- a/src/plugins/platforms/minimal/main.cpp
+++ b/src/plugins/platforms/minimal/main.cpp
@@ -40,7 +40,7 @@
 ****************************************************************************/
 
 
-#include <QtGui/QPlatformIntegrationPlugin>
+#include <qpa/qplatformintegrationplugin.h>
 #include "qminimalintegration.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/minimal/qminimalbackingstore.cpp b/src/plugins/platforms/minimal/qminimalbackingstore.cpp
index 5336dbf..d47633e 100644
--- a/src/plugins/platforms/minimal/qminimalbackingstore.cpp
+++ b/src/plugins/platforms/minimal/qminimalbackingstore.cpp
@@ -43,7 +43,7 @@
 #include "qminimalbackingstore.h"
 #include "qscreen.h"
 #include <QtCore/qdebug.h>
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 #include <private/qguiapplication_p.h>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/minimal/qminimalbackingstore.h b/src/plugins/platforms/minimal/qminimalbackingstore.h
index 375edaa..ff670f5 100644
--- a/src/plugins/platforms/minimal/qminimalbackingstore.h
+++ b/src/plugins/platforms/minimal/qminimalbackingstore.h
@@ -42,8 +42,8 @@
 #ifndef QBACKINGSTORE_MINIMAL_H
 #define QBACKINGSTORE_MINIMAL_H
 
-#include <QtGui/QPlatformBackingStore>
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformbackingstore.h>
+#include <qpa/qplatformwindow.h>
 #include <QtGui/QImage>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/minimal/qminimalintegration.cpp b/src/plugins/platforms/minimal/qminimalintegration.cpp
index 874f270..3ad5f6e 100644
--- a/src/plugins/platforms/minimal/qminimalintegration.cpp
+++ b/src/plugins/platforms/minimal/qminimalintegration.cpp
@@ -49,7 +49,7 @@
 
 #include <QtGui/private/qpixmap_raster_p.h>
 #include <QtGui/private/qguiapplication_p.h>
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/minimal/qminimalintegration.h b/src/plugins/platforms/minimal/qminimalintegration.h
index 2b345e0..7d9db08 100644
--- a/src/plugins/platforms/minimal/qminimalintegration.h
+++ b/src/plugins/platforms/minimal/qminimalintegration.h
@@ -42,8 +42,8 @@
 #ifndef QPLATFORMINTEGRATION_MINIMAL_H
 #define QPLATFORMINTEGRATION_MINIMAL_H
 
-#include <QtGui/QPlatformIntegration>
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformintegration.h>
+#include <qpa/qplatformscreen.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/openwfd/main.cpp b/src/plugins/platforms/openwfd/main.cpp
index 4e583e9..0d9508d 100644
--- a/src/plugins/platforms/openwfd/main.cpp
+++ b/src/plugins/platforms/openwfd/main.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <QtGui/QPlatformIntegrationPlugin>
+#include <qpa/qplatformintegrationplugin.h>
 #include "qopenwfdintegration.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/openwfd/qopenwfdbackingstore.h b/src/plugins/platforms/openwfd/qopenwfdbackingstore.h
index 4002fd8..84caa81 100644
--- a/src/plugins/platforms/openwfd/qopenwfdbackingstore.h
+++ b/src/plugins/platforms/openwfd/qopenwfdbackingstore.h
@@ -42,7 +42,7 @@
 #ifndef QOPENWFDBACKINGSTORE_H
 #define QOPENWFDBACKINGSTORE_H
 
-#include <QtGui/QPlatformBackingStore>
+#include <qpa/qplatformbackingstore.h>
 #include <QtGui/QImage>
 
 class QOpenWFDBackingStore : public QPlatformBackingStore
diff --git a/src/plugins/platforms/openwfd/qopenwfdglcontext.h b/src/plugins/platforms/openwfd/qopenwfdglcontext.h
index d353edd..7a613cc 100644
--- a/src/plugins/platforms/openwfd/qopenwfdglcontext.h
+++ b/src/plugins/platforms/openwfd/qopenwfdglcontext.h
@@ -42,7 +42,7 @@
 #ifndef QOPENWFDGLCONTEXT_H
 #define QOPENWFDGLCONTEXT_H
 
-#include <QtGui/QPlatformOpenGLContext>
+#include <qpa/qplatformopenglcontext.h>
 
 #include "qopenwfddevice.h"
 
diff --git a/src/plugins/platforms/openwfd/qopenwfdintegration.h b/src/plugins/platforms/openwfd/qopenwfdintegration.h
index 5737dbb..7b6a954 100644
--- a/src/plugins/platforms/openwfd/qopenwfdintegration.h
+++ b/src/plugins/platforms/openwfd/qopenwfdintegration.h
@@ -42,8 +42,8 @@
 #ifndef QOPENWFDINTEGRATION_H
 #define QOPENWFDINTEGRATION_H
 
-#include <QtGui/QPlatformIntegration>
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformintegration.h>
+#include <qpa/qplatformscreen.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/openwfd/qopenwfdnativeinterface.h b/src/plugins/platforms/openwfd/qopenwfdnativeinterface.h
index 955fca7..f4ccfe5 100644
--- a/src/plugins/platforms/openwfd/qopenwfdnativeinterface.h
+++ b/src/plugins/platforms/openwfd/qopenwfdnativeinterface.h
@@ -42,7 +42,7 @@
 #ifndef QOPENWFDNATIVEINTERFACE_H
 #define QOPENWFDNATIVEINTERFACE_H
 
-#include <QtGui/QPlatformNativeInterface>
+#include <qpa/qplatformnativeinterface.h>
 
 #include <WF/wfdplatform.h>
 
diff --git a/src/plugins/platforms/openwfd/qopenwfdscreen.h b/src/plugins/platforms/openwfd/qopenwfdscreen.h
index 8993205..ff4a83f 100644
--- a/src/plugins/platforms/openwfd/qopenwfdscreen.h
+++ b/src/plugins/platforms/openwfd/qopenwfdscreen.h
@@ -42,7 +42,7 @@
 #ifndef QOPENWFDSCREEN_H
 #define QOPENWFDSCREEN_H
 
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 
 
 #include "qopenwfdoutputbuffer.h"
diff --git a/src/plugins/platforms/openwfd/qopenwfdwindow.h b/src/plugins/platforms/openwfd/qopenwfdwindow.h
index ca531b0..9f777b3 100644
--- a/src/plugins/platforms/openwfd/qopenwfdwindow.h
+++ b/src/plugins/platforms/openwfd/qopenwfdwindow.h
@@ -42,7 +42,7 @@
 #ifndef QOPENWFDWINDOW_H
 #define QOPENWFDWINDOW_H
 
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 #include <QtCore/QVarLengthArray>
 
 #include "qopenwfdport.h"
diff --git a/src/plugins/platforms/qnx/main.h b/src/plugins/platforms/qnx/main.h
index cc2cfdd..4033a29 100644
--- a/src/plugins/platforms/qnx/main.h
+++ b/src/plugins/platforms/qnx/main.h
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <QtGui/QPlatformIntegrationPlugin>
+#include <qpa/qplatformintegrationplugin.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/qnx/qqnxclipboard.h b/src/plugins/platforms/qnx/qqnxclipboard.h
index c9ceff4..7a9d7c3 100644
--- a/src/plugins/platforms/qnx/qqnxclipboard.h
+++ b/src/plugins/platforms/qnx/qqnxclipboard.h
@@ -43,7 +43,7 @@
 #define QQNXCLIPBOARD_H
 
 #ifndef QT_NO_CLIPBOARD
-#include <QtGui/QPlatformClipboard>
+#include <qpa/qplatformclipboard.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/qnx/qqnxglbackingstore.h b/src/plugins/platforms/qnx/qqnxglbackingstore.h
index b694079..78ee58f 100644
--- a/src/plugins/platforms/qnx/qqnxglbackingstore.h
+++ b/src/plugins/platforms/qnx/qqnxglbackingstore.h
@@ -42,7 +42,7 @@
 #ifndef QQNXGLBACKINGSTORE_H
 #define QQNXGLBACKINGSTORE_H
 
-#include <QtGui/qplatformbackingstore_qpa.h>
+#include <qpa/qplatformbackingstore.h>
 #include <QtOpenGL/private/qglpaintdevice_p.h>
 
 #include <screen/screen.h>
diff --git a/src/plugins/platforms/qnx/qqnxglcontext.h b/src/plugins/platforms/qnx/qqnxglcontext.h
index ee8d61c..8b587e7 100644
--- a/src/plugins/platforms/qnx/qqnxglcontext.h
+++ b/src/plugins/platforms/qnx/qqnxglcontext.h
@@ -42,7 +42,7 @@
 #ifndef QQNXGLCONTEXT_H
 #define QQNXGLCONTEXT_H
 
-#include <QtGui/QPlatformOpenGLContext>
+#include <qpa/qplatformopenglcontext.h>
 #include <QtGui/QSurfaceFormat>
 #include <QtCore/QSize>
 
diff --git a/src/plugins/platforms/qnx/qqnxinputcontext_imf.h b/src/plugins/platforms/qnx/qqnxinputcontext_imf.h
index 5f7d95b..f6f0f60 100644
--- a/src/plugins/platforms/qnx/qqnxinputcontext_imf.h
+++ b/src/plugins/platforms/qnx/qqnxinputcontext_imf.h
@@ -42,11 +42,11 @@
 #ifndef QQNXINPUTCONTEXT_H
 #define QQNXINPUTCONTEXT_H
 
-#include <QtGui/QPlatformInputContext>
+#include <qpa/qplatforminputcontext.h>
 
 #include <QtCore/QLocale>
 #include <QtCore/QMetaType>
-#include <QtGui/QPlatformIntegration>
+#include <qpa/qplatformintegration.h>
 
 #include "imf/imf_client.h"
 #include "imf/input_control.h"
diff --git a/src/plugins/platforms/qnx/qqnxinputcontext_noimf.h b/src/plugins/platforms/qnx/qqnxinputcontext_noimf.h
index d73c513..93512b2 100644
--- a/src/plugins/platforms/qnx/qqnxinputcontext_noimf.h
+++ b/src/plugins/platforms/qnx/qqnxinputcontext_noimf.h
@@ -43,8 +43,8 @@
 #define QQNXINPUTCONTEXT_H
 
 #include <QtCore/QLocale>
-#include <QtGui/QPlatformInputContext>
-#include <QtGui/QPlatformIntegration>
+#include <qpa/qplatforminputcontext.h>
+#include <qpa/qplatformintegration.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/qnx/qqnxintegration.cpp b/src/plugins/platforms/qnx/qqnxintegration.cpp
index 73d8cb2..dd1a6f8 100644
--- a/src/plugins/platforms/qnx/qqnxintegration.cpp
+++ b/src/plugins/platforms/qnx/qqnxintegration.cpp
@@ -79,7 +79,7 @@
 #include "private/qgenericunixeventdispatcher_p.h"
 #endif
 
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 #include <QtGui/QWindowSystemInterface>
 
 #if !defined(QT_NO_OPENGL)
diff --git a/src/plugins/platforms/qnx/qqnxintegration.h b/src/plugins/platforms/qnx/qqnxintegration.h
index a3c476f..e0da8cc 100644
--- a/src/plugins/platforms/qnx/qqnxintegration.h
+++ b/src/plugins/platforms/qnx/qqnxintegration.h
@@ -42,7 +42,7 @@
 #ifndef QQNXINTEGRATION_H
 #define QQNXINTEGRATION_H
 
-#include <QtGui/qplatformintegration_qpa.h>
+#include <qpa/qplatformintegration.h>
 
 #include <QtCore/qmutex.h>
 
diff --git a/src/plugins/platforms/qnx/qqnxnativeinterface.h b/src/plugins/platforms/qnx/qqnxnativeinterface.h
index ec896d4..f176b0a 100644
--- a/src/plugins/platforms/qnx/qqnxnativeinterface.h
+++ b/src/plugins/platforms/qnx/qqnxnativeinterface.h
@@ -42,7 +42,7 @@
 #ifndef QQNXNATIVEINTERFACE_H
 #define QQNXNATIVEINTERFACE_H
 
-#include <QtGui/QPlatformNativeInterface>
+#include <qpa/qplatformnativeinterface.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/qnx/qqnxrasterbackingstore.h b/src/plugins/platforms/qnx/qqnxrasterbackingstore.h
index 7a7f211..6a55949 100644
--- a/src/plugins/platforms/qnx/qqnxrasterbackingstore.h
+++ b/src/plugins/platforms/qnx/qqnxrasterbackingstore.h
@@ -42,7 +42,7 @@
 #ifndef QQNXRASTERWINDOWSURFACE_H
 #define QQNXRASTERWINDOWSURFACE_H
 
-#include <QtGui/qplatformbackingstore_qpa.h>
+#include <qpa/qplatformbackingstore.h>
 
 #include <screen/screen.h>
 
diff --git a/src/plugins/platforms/qnx/qqnxscreen.h b/src/plugins/platforms/qnx/qqnxscreen.h
index 7816661..4a13946 100644
--- a/src/plugins/platforms/qnx/qqnxscreen.h
+++ b/src/plugins/platforms/qnx/qqnxscreen.h
@@ -42,7 +42,7 @@
 #ifndef QBBSCREEN_H
 #define QBBSCREEN_H
 
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 
 #include "qqnxrootwindow.h"
 
diff --git a/src/plugins/platforms/qnx/qqnxservices.h b/src/plugins/platforms/qnx/qqnxservices.h
index fe7c014..e9fc7cf 100644
--- a/src/plugins/platforms/qnx/qqnxservices.h
+++ b/src/plugins/platforms/qnx/qqnxservices.h
@@ -42,7 +42,7 @@
 #ifndef QQNXSERVICES_H
 #define QQNXSERVICES_H
 
-#include <QtGui/QPlatformServices>
+#include <qpa/qplatformservices.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/qnx/qqnxwindow.h b/src/plugins/platforms/qnx/qqnxwindow.h
index 2ea7bbc..50b9a42 100644
--- a/src/plugins/platforms/qnx/qqnxwindow.h
+++ b/src/plugins/platforms/qnx/qqnxwindow.h
@@ -42,7 +42,7 @@
 #ifndef QQNXWINDOW_H
 #define QQNXWINDOW_H
 
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 
 #include "qqnxbuffer.h"
 
diff --git a/src/plugins/platforms/windows/accessible/qwindowsaccessibility.cpp b/src/plugins/platforms/windows/accessible/qwindowsaccessibility.cpp
index 17ee6eb..6f2a601 100644
--- a/src/plugins/platforms/windows/accessible/qwindowsaccessibility.cpp
+++ b/src/plugins/platforms/windows/accessible/qwindowsaccessibility.cpp
@@ -51,7 +51,7 @@
 #include <QtCore/qsettings.h>
 #include <QtGui/qaccessible.h>
 #include <QtGui/qaccessible2.h>
-#include <QtGui/qplatformnativeinterface_qpa.h>
+#include <qpa/qplatformnativeinterface.h>
 #include <QtGui/qwindow.h>
 #include <QtGui/qguiapplication.h>
 
diff --git a/src/plugins/platforms/windows/accessible/qwindowsaccessibility.h b/src/plugins/platforms/windows/accessible/qwindowsaccessibility.h
index 3366c32..67aaa5b 100644
--- a/src/plugins/platforms/windows/accessible/qwindowsaccessibility.h
+++ b/src/plugins/platforms/windows/accessible/qwindowsaccessibility.h
@@ -44,7 +44,7 @@
 
 #include "../qtwindowsglobal.h"
 #include "../qwindowscontext.h"
-#include <QtGui/QPlatformAccessibility>
+#include <qpa/qplatformaccessibility.h>
 
 #include <oleacc.h>
 
diff --git a/src/plugins/platforms/windows/accessible/qwindowsmsaaaccessible.cpp b/src/plugins/platforms/windows/accessible/qwindowsmsaaaccessible.cpp
index 5003d9e..fafe624 100644
--- a/src/plugins/platforms/windows/accessible/qwindowsmsaaaccessible.cpp
+++ b/src/plugins/platforms/windows/accessible/qwindowsmsaaaccessible.cpp
@@ -56,7 +56,7 @@
 #include <QtGui/qaccessible.h>
 #include <QtGui/qaccessible2.h>
 #include <QtGui/qguiapplication.h>
-#include <QtGui/qplatformnativeinterface_qpa.h>
+#include <qpa/qplatformnativeinterface.h>
 #include <QtGui/qwindow.h>
 #include <QtWidgets/qapplication.h>
 #include <QtWidgets/qgraphicsitem.h>
diff --git a/src/plugins/platforms/windows/main.cpp b/src/plugins/platforms/windows/main.cpp
index 9f6ce99..5404d91 100644
--- a/src/plugins/platforms/windows/main.cpp
+++ b/src/plugins/platforms/windows/main.cpp
@@ -40,7 +40,7 @@
 ****************************************************************************/
 
 
-#include <QtGui/QPlatformIntegrationPlugin>
+#include <qpa/qplatformintegrationplugin.h>
 #include <QtCore/QStringList>
 
 #include "qwindowsintegration.h"
diff --git a/src/plugins/platforms/windows/qwindowsbackingstore.h b/src/plugins/platforms/windows/qwindowsbackingstore.h
index 14ce6c3..75b6e5f 100644
--- a/src/plugins/platforms/windows/qwindowsbackingstore.h
+++ b/src/plugins/platforms/windows/qwindowsbackingstore.h
@@ -44,7 +44,7 @@
 
 #include "qtwindows_additional.h"
 
-#include <QtGui/QPlatformBackingStore>
+#include <qpa/qplatformbackingstore.h>
 #include <QtCore/QScopedPointer>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/windows/qwindowsclipboard.h b/src/plugins/platforms/windows/qwindowsclipboard.h
index 643c785..00c975e 100644
--- a/src/plugins/platforms/windows/qwindowsclipboard.h
+++ b/src/plugins/platforms/windows/qwindowsclipboard.h
@@ -44,7 +44,7 @@
 
 #include "qwindowsinternalmimedata.h"
 
-#include <QtGui/QPlatformClipboard>
+#include <qpa/qplatformclipboard.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/windows/qwindowscontext.cpp b/src/plugins/platforms/windows/qwindowscontext.cpp
index 4d284e0..3a21135 100644
--- a/src/plugins/platforms/windows/qwindowscontext.cpp
+++ b/src/plugins/platforms/windows/qwindowscontext.cpp
@@ -55,7 +55,7 @@
 
 #include <QtGui/QWindow>
 #include <QtGui/QWindowSystemInterface>
-#include <QtGui/QPlatformNativeInterface>
+#include <qpa/qplatformnativeinterface.h>
 #include <QtGui/QGuiApplication>
 
 #include <QtCore/QSet>
diff --git a/src/plugins/platforms/windows/qwindowscursor.h b/src/plugins/platforms/windows/qwindowscursor.h
index 61c43dc..c1bccde 100644
--- a/src/plugins/platforms/windows/qwindowscursor.h
+++ b/src/plugins/platforms/windows/qwindowscursor.h
@@ -44,7 +44,7 @@
 
 #include "qtwindows_additional.h"
 
-#include <QtGui/QPlatformCursor>
+#include <qpa/qplatformcursor.h>
 #include <QtCore/QSharedDataPointer>
 #include <QtCore/QHash>
 
diff --git a/src/plugins/platforms/windows/qwindowsdialoghelpers.h b/src/plugins/platforms/windows/qwindowsdialoghelpers.h
index 909ce59..285c58d 100644
--- a/src/plugins/platforms/windows/qwindowsdialoghelpers.h
+++ b/src/plugins/platforms/windows/qwindowsdialoghelpers.h
@@ -43,8 +43,8 @@
 #define QWINDOWSDIALOGHELPER_H
 
 #include "qtwindows_additional.h"
-#include <QtGui/QPlatformDialogHelper>
-#include <QtGui/QPlatformTheme>
+#include <qpa/qplatformdialoghelper.h>
+#include <qpa/qplatformtheme.h>
 #include <QtCore/QStringList>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/windows/qwindowsdrag.h b/src/plugins/platforms/windows/qwindowsdrag.h
index 7b629ba..867093a 100644
--- a/src/plugins/platforms/windows/qwindowsdrag.h
+++ b/src/plugins/platforms/windows/qwindowsdrag.h
@@ -44,7 +44,7 @@
 
 #include "qwindowsinternalmimedata.h"
 
-#include <QtGui/QPlatformDrag>
+#include <qpa/qplatformdrag.h>
 #include <QtGui/QPixmap>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/windows/qwindowsfontdatabase.h b/src/plugins/platforms/windows/qwindowsfontdatabase.h
index f442f49..6441e79 100644
--- a/src/plugins/platforms/windows/qwindowsfontdatabase.h
+++ b/src/plugins/platforms/windows/qwindowsfontdatabase.h
@@ -42,7 +42,7 @@
 #ifndef QWINDOWSFONTDATABASE_H
 #define QWINDOWSFONTDATABASE_H
 
-#include <QtGui/QPlatformFontDatabase>
+#include <qpa/qplatformfontdatabase.h>
 #include <QtCore/QSharedPointer>
 #include "qtwindows_additional.h"
 
diff --git a/src/plugins/platforms/windows/qwindowsglcontext.cpp b/src/plugins/platforms/windows/qwindowsglcontext.cpp
index f16a0ca..607dabc 100644
--- a/src/plugins/platforms/windows/qwindowsglcontext.cpp
+++ b/src/plugins/platforms/windows/qwindowsglcontext.cpp
@@ -46,7 +46,7 @@
 #include <QtCore/QDebug>
 #include <QtCore/QSysInfo>
 #include <QtGui/QGuiApplication>
-#include <QtGui/QPlatformNativeInterface>
+#include <qpa/qplatformnativeinterface.h>
 
 #include <wingdi.h>
 #include <GL/gl.h>
diff --git a/src/plugins/platforms/windows/qwindowsglcontext.h b/src/plugins/platforms/windows/qwindowsglcontext.h
index a0489e2..b83a57d 100644
--- a/src/plugins/platforms/windows/qwindowsglcontext.h
+++ b/src/plugins/platforms/windows/qwindowsglcontext.h
@@ -45,7 +45,7 @@
 #include "array.h"
 #include "qtwindows_additional.h"
 
-#include <QtGui/QPlatformOpenGLContext>
+#include <qpa/qplatformopenglcontext.h>
 #include <QtGui/QOpenGLContext>
 #include <QtCore/QSharedPointer>
 
diff --git a/src/plugins/platforms/windows/qwindowsinputcontext.h b/src/plugins/platforms/windows/qwindowsinputcontext.h
index 610bad0..134dfdb 100644
--- a/src/plugins/platforms/windows/qwindowsinputcontext.h
+++ b/src/plugins/platforms/windows/qwindowsinputcontext.h
@@ -44,7 +44,7 @@
 
 #include "qtwindows_additional.h"
 
-#include <QtGui/QPlatformInputContext>
+#include <qpa/qplatforminputcontext.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/windows/qwindowsintegration.cpp b/src/plugins/platforms/windows/qwindowsintegration.cpp
index 45f6ecf..69ae653 100644
--- a/src/plugins/platforms/windows/qwindowsintegration.cpp
+++ b/src/plugins/platforms/windows/qwindowsintegration.cpp
@@ -60,7 +60,7 @@
 #include "accessible/qwindowsaccessibility.h"
 #endif
 
-#include <QtGui/QPlatformNativeInterface>
+#include <qpa/qplatformnativeinterface.h>
 #include <QtGui/QWindowSystemInterface>
 #include <QtGui/QBackingStore>
 #include <QtGui/private/qpixmap_raster_p.h>
diff --git a/src/plugins/platforms/windows/qwindowsintegration.h b/src/plugins/platforms/windows/qwindowsintegration.h
index 84bbf61..76393be 100644
--- a/src/plugins/platforms/windows/qwindowsintegration.h
+++ b/src/plugins/platforms/windows/qwindowsintegration.h
@@ -42,7 +42,7 @@
 #ifndef QWINDOWSINTEGRATION_H
 #define QWINDOWSINTEGRATION_H
 
-#include <QtGui/QPlatformIntegration>
+#include <qpa/qplatformintegration.h>
 #include <QtCore/QScopedPointer>
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/windows/qwindowsscreen.h b/src/plugins/platforms/windows/qwindowsscreen.h
index 5b9a50b..56e9ab3 100644
--- a/src/plugins/platforms/windows/qwindowsscreen.h
+++ b/src/plugins/platforms/windows/qwindowsscreen.h
@@ -47,7 +47,7 @@
 #include <QtCore/QList>
 #include <QtCore/QPair>
 #include <QtCore/QSharedPointer>
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/windows/qwindowsservices.h b/src/plugins/platforms/windows/qwindowsservices.h
index d979ed1..c9954b5 100644
--- a/src/plugins/platforms/windows/qwindowsservices.h
+++ b/src/plugins/platforms/windows/qwindowsservices.h
@@ -42,7 +42,7 @@
 #ifndef QWINDOWSDESKTOPSERVICES_H
 #define QWINDOWSDESKTOPSERVICES_H
 
-#include <QtGui/qplatformservices_qpa.h>
+#include <qpa/qplatformservices.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/windows/qwindowstheme.h b/src/plugins/platforms/windows/qwindowstheme.h
index 7515a13..223a98c 100644
--- a/src/plugins/platforms/windows/qwindowstheme.h
+++ b/src/plugins/platforms/windows/qwindowstheme.h
@@ -42,7 +42,7 @@
 #ifndef QWINDOWSTHEME_H
 #define QWINDOWSTHEME_H
 
-#include <QtGui/QPlatformTheme>
+#include <qpa/qplatformtheme.h>
 #include <QtGui/QColor>
 
 #include "qtwindows_additional.h"
diff --git a/src/plugins/platforms/windows/qwindowswindow.h b/src/plugins/platforms/windows/qwindowswindow.h
index badc229..87c22c7 100644
--- a/src/plugins/platforms/windows/qwindowswindow.h
+++ b/src/plugins/platforms/windows/qwindowswindow.h
@@ -45,7 +45,7 @@
 #include "qtwindows_additional.h"
 #include "qwindowscursor.h"
 
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/xcb/main.cpp b/src/plugins/platforms/xcb/main.cpp
index 50c5a1a..4474a47 100644
--- a/src/plugins/platforms/xcb/main.cpp
+++ b/src/plugins/platforms/xcb/main.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <QtGui/QPlatformIntegrationPlugin>
+#include <qpa/qplatformintegrationplugin.h>
 #include "qxcbintegration.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/xcb/qdri2context.h b/src/plugins/platforms/xcb/qdri2context.h
index d0a1b46..8945744 100644
--- a/src/plugins/platforms/xcb/qdri2context.h
+++ b/src/plugins/platforms/xcb/qdri2context.h
@@ -42,7 +42,7 @@
 #ifndef QDRI2CONTEXT_H
 #define QDRI2CONTEXT_H
 
-#include <QtGui/QPlatformOpenGLContext>
+#include <qpa/qplatformopenglcontext.h>
 
 struct xcb_dri2_dri2_buffer_t;
 
diff --git a/src/plugins/platforms/xcb/qglxintegration.h b/src/plugins/platforms/xcb/qglxintegration.h
index dce9193..8d114b7 100644
--- a/src/plugins/platforms/xcb/qglxintegration.h
+++ b/src/plugins/platforms/xcb/qglxintegration.h
@@ -45,7 +45,7 @@
 #include "qxcbwindow.h"
 #include "qxcbscreen.h"
 
-#include <QtGui/QPlatformOpenGLContext>
+#include <qpa/qplatformopenglcontext.h>
 #include <QtGui/QSurfaceFormat>
 
 #include <QtCore/QMutex>
diff --git a/src/plugins/platforms/xcb/qxcbbackingstore.h b/src/plugins/platforms/xcb/qxcbbackingstore.h
index e02c6eb..b66a274 100644
--- a/src/plugins/platforms/xcb/qxcbbackingstore.h
+++ b/src/plugins/platforms/xcb/qxcbbackingstore.h
@@ -42,7 +42,7 @@
 #ifndef QXCBBACKINGSTORE_H
 #define QXCBBACKINGSTORE_H
 
-#include <qplatformbackingstore_qpa.h>
+#include <qpa/qplatformbackingstore.h>
 
 #include <xcb/xcb.h>
 
diff --git a/src/plugins/platforms/xcb/qxcbclipboard.h b/src/plugins/platforms/xcb/qxcbclipboard.h
index a43518e..1b3f12b 100644
--- a/src/plugins/platforms/xcb/qxcbclipboard.h
+++ b/src/plugins/platforms/xcb/qxcbclipboard.h
@@ -42,7 +42,7 @@
 #ifndef QXCBCLIPBOARD_H
 #define QXCBCLIPBOARD_H
 
-#include <QPlatformClipboard>
+#include <qpa/qplatformclipboard.h>
 #include <qxcbobject.h>
 #include <xcb/xcb.h>
 #include <xcb/xfixes.h>
diff --git a/src/plugins/platforms/xcb/qxcbcursor.h b/src/plugins/platforms/xcb/qxcbcursor.h
index da24342..80fb88b 100644
--- a/src/plugins/platforms/xcb/qxcbcursor.h
+++ b/src/plugins/platforms/xcb/qxcbcursor.h
@@ -42,7 +42,7 @@
 #ifndef QXCBCURSOR_H
 #define QXCBCURSOR_H
 
-#include <QtGui/QPlatformCursor>
+#include <qpa/qplatformcursor.h>
 #include "qxcbscreen.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/xcb/qxcbdrag.h b/src/plugins/platforms/xcb/qxcbdrag.h
index 710a07a..2f74b3e 100644
--- a/src/plugins/platforms/xcb/qxcbdrag.h
+++ b/src/plugins/platforms/xcb/qxcbdrag.h
@@ -42,7 +42,7 @@
 #ifndef QXCBDRAG_H
 #define QXCBDRAG_H
 
-#include <qplatformdrag_qpa.h>
+#include <qpa/qplatformdrag.h>
 #include <QtPlatformSupport/private/qsimpledrag_p.h>
 #include <qxcbobject.h>
 #include <xcb/xcb.h>
diff --git a/src/plugins/platforms/xcb/qxcbintegration.cpp b/src/plugins/platforms/xcb/qxcbintegration.cpp
index 2d3971d..8dba6e1 100644
--- a/src/plugins/platforms/xcb/qxcbintegration.cpp
+++ b/src/plugins/platforms/xcb/qxcbintegration.cpp
@@ -68,9 +68,9 @@
 #include <X11/Xlib.h>
 #endif
 
-#include <private/qplatforminputcontextfactory_qpa_p.h>
+#include <qpa/qplatforminputcontextfactory_p.h>
 #include <private/qgenericunixthemes_p.h>
-#include <qplatforminputcontext_qpa.h>
+#include <qpa/qplatforminputcontext.h>
 
 #if defined(XCB_USE_GLX)
 #include "qglxintegration.h"
@@ -82,7 +82,7 @@
 #include <QtGui/QOpenGLContext>
 #include <QtGui/QScreen>
 #ifndef QT_NO_ACCESSIBILITY
-#include <QtGui/QPlatformAccessibility>
+#include <qpa/qplatformaccessibility.h>
 #endif
 
 QT_BEGIN_NAMESPACE
diff --git a/src/plugins/platforms/xcb/qxcbintegration.h b/src/plugins/platforms/xcb/qxcbintegration.h
index 6170232..b2245e4 100644
--- a/src/plugins/platforms/xcb/qxcbintegration.h
+++ b/src/plugins/platforms/xcb/qxcbintegration.h
@@ -42,8 +42,8 @@
 #ifndef QXCBINTEGRATION_H
 #define QXCBINTEGRATION_H
 
-#include <QtGui/QPlatformIntegration>
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformintegration.h>
+#include <qpa/qplatformscreen.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/xcb/qxcbkeyboard.cpp b/src/plugins/platforms/xcb/qxcbkeyboard.cpp
index ef98f82..9bd4c9c 100644
--- a/src/plugins/platforms/xcb/qxcbkeyboard.cpp
+++ b/src/plugins/platforms/xcb/qxcbkeyboard.cpp
@@ -49,8 +49,8 @@
 #include <private/qguiapplication_p.h>
 #include <stdio.h>
 
-#include <qplatforminputcontext_qpa.h>
-#include <qplatformintegration_qpa.h>
+#include <qpa/qplatforminputcontext.h>
+#include <qpa/qplatformintegration.h>
 
 #ifndef XK_ISO_Left_Tab
 #define XK_ISO_Left_Tab         0xFE20
diff --git a/src/plugins/platforms/xcb/qxcbnativeinterface.h b/src/plugins/platforms/xcb/qxcbnativeinterface.h
index c6835ff..354ef76 100644
--- a/src/plugins/platforms/xcb/qxcbnativeinterface.h
+++ b/src/plugins/platforms/xcb/qxcbnativeinterface.h
@@ -42,7 +42,7 @@
 #ifndef QXCBNATIVEINTERFACE_H
 #define QXCBNATIVEINTERFACE_H
 
-#include <QtGui/QPlatformNativeInterface>
+#include <qpa/qplatformnativeinterface.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/platforms/xcb/qxcbscreen.h b/src/plugins/platforms/xcb/qxcbscreen.h
index ac4ecb1..ba3f4af 100644
--- a/src/plugins/platforms/xcb/qxcbscreen.h
+++ b/src/plugins/platforms/xcb/qxcbscreen.h
@@ -42,7 +42,7 @@
 #ifndef QXCBSCREEN_H
 #define QXCBSCREEN_H
 
-#include <QtGui/QPlatformScreen>
+#include <qpa/qplatformscreen.h>
 #include <QtCore/QString>
 
 #include <xcb/xcb.h>
diff --git a/src/plugins/platforms/xcb/qxcbwindow.cpp b/src/plugins/platforms/xcb/qxcbwindow.cpp
index ffce2f3..2355043 100644
--- a/src/plugins/platforms/xcb/qxcbwindow.cpp
+++ b/src/plugins/platforms/xcb/qxcbwindow.cpp
@@ -50,7 +50,7 @@
 #include "qxcbkeyboard.h"
 #include "qxcbwmsupport.h"
 
-#include <qplatformintegration_qpa.h>
+#include <qpa/qplatformintegration.h>
 
 #ifdef XCB_USE_DRI2
 #include "qdri2context.h"
@@ -87,7 +87,7 @@
 #include <private/qguiapplication_p.h>
 #include <private/qwindow_p.h>
 
-#include <QtGui/QPlatformBackingStore>
+#include <qpa/qplatformbackingstore.h>
 #include <QtGui/QWindowSystemInterface>
 
 #include <stdio.h>
diff --git a/src/plugins/platforms/xcb/qxcbwindow.h b/src/plugins/platforms/xcb/qxcbwindow.h
index 523dd55..0b82196 100644
--- a/src/plugins/platforms/xcb/qxcbwindow.h
+++ b/src/plugins/platforms/xcb/qxcbwindow.h
@@ -42,7 +42,7 @@
 #ifndef QXCBWINDOW_H
 #define QXCBWINDOW_H
 
-#include <QtGui/QPlatformWindow>
+#include <qpa/qplatformwindow.h>
 #include <QtGui/QSurfaceFormat>
 #include <QtGui/QImage>
 
diff --git a/src/plugins/printsupport/cocoa/cocoa.pro b/src/plugins/printsupport/cocoa/cocoa.pro
index 353094c..477715a 100644
--- a/src/plugins/printsupport/cocoa/cocoa.pro
+++ b/src/plugins/printsupport/cocoa/cocoa.pro
@@ -2,7 +2,7 @@ TARGET = cocoaprintersupport
 load(qt_plugin)
 DESTDIR = $$QT.gui.plugins/printsupport
 
-QT += printsupport
+QT += gui-private printsupport-private
 LIBS += -framework Cocoa
 
 SOURCES += main.cpp
diff --git a/src/plugins/printsupport/cocoa/main.cpp b/src/plugins/printsupport/cocoa/main.cpp
index bc8f2e0..1291897 100644
--- a/src/plugins/printsupport/cocoa/main.cpp
+++ b/src/plugins/printsupport/cocoa/main.cpp
@@ -41,8 +41,8 @@
 
 #include <QtCore/QMetaMethod>
 #include <QtGui/QGuiApplication>
-#include <QtGui/QPlatformNativeInterface>
-#include <QtPrintSupport/QPlatformPrinterSupportPlugin>
+#include <qpa/qplatformnativeinterface.h>
+#include <qpa/qplatformprintplugin.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/plugins/printsupport/windows/main.cpp b/src/plugins/printsupport/windows/main.cpp
index e29705a..7ddb892 100644
--- a/src/plugins/printsupport/windows/main.cpp
+++ b/src/plugins/printsupport/windows/main.cpp
@@ -40,7 +40,7 @@
 ****************************************************************************/
 
 
-#include <QtPrintSupport/qplatformprintplugin_qpa.h>
+#include <qpa/qplatformprintplugin.h>
 #include <QtCore/QStringList>
 
 #include "qwindowsprintersupport.h"
diff --git a/src/plugins/printsupport/windows/qwindowsprintersupport.h b/src/plugins/printsupport/windows/qwindowsprintersupport.h
index 35d794a..be8758a 100644
--- a/src/plugins/printsupport/windows/qwindowsprintersupport.h
+++ b/src/plugins/printsupport/windows/qwindowsprintersupport.h
@@ -43,7 +43,7 @@
 #define WINDOWSPRINTERSUPPORT_H
 
 #include <QtCore/QList>
-#include <QtPrintSupport/QPlatformPrinterSupport>
+#include <qpa/qplatformprintersupport.h>
 
 QT_BEGIN_HEADER
 QT_BEGIN_NAMESPACE
diff --git a/src/printsupport/dialogs/qpagesetupdialog_mac.mm b/src/printsupport/dialogs/qpagesetupdialog_mac.mm
index 1dded4f..3e84423 100644
--- a/src/printsupport/dialogs/qpagesetupdialog_mac.mm
+++ b/src/printsupport/dialogs/qpagesetupdialog_mac.mm
@@ -46,7 +46,7 @@
 #include "qpagesetupdialog.h"
 #include "qabstractpagesetupdialog_p.h"
 
-#include <QtGui/qplatformnativeinterface_qpa.h>
+#include <qpa/qplatformnativeinterface.h>
 #include <QtPrintSupport/qprintengine.h>
 
 QT_USE_NAMESPACE
diff --git a/src/printsupport/dialogs/qpagesetupdialog_win.cpp b/src/printsupport/dialogs/qpagesetupdialog_win.cpp
index 9d7387e..cb69d04 100644
--- a/src/printsupport/dialogs/qpagesetupdialog_win.cpp
+++ b/src/printsupport/dialogs/qpagesetupdialog_win.cpp
@@ -47,7 +47,7 @@
 #include "../kernel/qprintengine_win_p.h"
 #include "qabstractpagesetupdialog_p.h"
 #include "qprinter.h"
-#include <QtGui/qplatformnativeinterface_qpa.h>
+#include <qpa/qplatformnativeinterface.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/printsupport/kernel/kernel.pri b/src/printsupport/kernel/kernel.pri
index d7c9f56..10d9f87 100644
--- a/src/printsupport/kernel/kernel.pri
+++ b/src/printsupport/kernel/kernel.pri
@@ -6,8 +6,8 @@ HEADERS += \
         $$PWD/qprinter_p.h \
         $$PWD/qprinterinfo.h \
         $$PWD/qprinterinfo_p.h \
-        $$PWD/qplatformprintplugin_qpa.h \
-        $$PWD/qplatformprintersupport_qpa.h
+        $$PWD/qplatformprintplugin.h \
+        $$PWD/qplatformprintersupport.h
 
 SOURCES += \
         $$PWD/qpaintengine_alpha.cpp \
diff --git a/src/printsupport/kernel/qplatformprintersupport.h b/src/printsupport/kernel/qplatformprintersupport.h
new file mode 100644
index 0000000..5dba565
--- /dev/null
+++ b/src/printsupport/kernel/qplatformprintersupport.h
@@ -0,0 +1,86 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMPRINTINGSUPPORT_H
+#define QPLATFORMPRINTINGSUPPORT_H
+
+#include <QtPrintSupport/qprinter.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+#ifndef QT_NO_PRINTER
+
+class QPrintEngine;
+
+class Q_PRINTSUPPORT_EXPORT QPlatformPrinterSupport
+{
+public:
+    QPlatformPrinterSupport();
+    virtual ~QPlatformPrinterSupport();
+
+    virtual QPrintEngine *createNativePrintEngine(QPrinter::PrinterMode printerMode);
+    virtual QPaintEngine *createPaintEngine(QPrintEngine *, QPrinter::PrinterMode printerMode);
+    virtual QList<QPrinter::PaperSize> supportedPaperSizes(const QPrinterInfo &) const;
+
+    virtual QList<QPrinterInfo> availablePrinters();
+    virtual QPrinterInfo defaultPrinter();
+
+    static QPrinter::PaperSize convertQSizeFToPaperSize(const QSizeF &sizef);
+    static QSizeF convertPaperSizeToQSizeF(QPrinter::PaperSize paperSize);
+
+protected:
+     static QPrinterInfo printerInfo(const QString &printerName, bool isDefault = false);
+     static void setPrinterInfoDefault(QPrinterInfo *p, bool isDefault);
+     static bool printerInfoIsDefault(const QPrinterInfo &p);
+     static int printerInfoCupsPrinterIndex(const QPrinterInfo &p);
+     static void setPrinterInfoCupsPrinterIndex(QPrinterInfo *p, int index);
+};
+
+#endif // QT_NO_PRINTER
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMPRINTINGSUPPORT_H
diff --git a/src/printsupport/kernel/qplatformprintersupport_qpa.cpp b/src/printsupport/kernel/qplatformprintersupport_qpa.cpp
index 1ed28b8..9c0c3f1 100644
--- a/src/printsupport/kernel/qplatformprintersupport_qpa.cpp
+++ b/src/printsupport/kernel/qplatformprintersupport_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformprintersupport_qpa.h"
+#include "qplatformprintersupport.h"
 
 #include <QtPrintSupport/qprinterinfo.h>
 
diff --git a/src/printsupport/kernel/qplatformprintersupport_qpa.h b/src/printsupport/kernel/qplatformprintersupport_qpa.h
deleted file mode 100644
index 5dba565..0000000
--- a/src/printsupport/kernel/qplatformprintersupport_qpa.h
+++ /dev/null
@@ -1,86 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMPRINTINGSUPPORT_H
-#define QPLATFORMPRINTINGSUPPORT_H
-
-#include <QtPrintSupport/qprinter.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-#ifndef QT_NO_PRINTER
-
-class QPrintEngine;
-
-class Q_PRINTSUPPORT_EXPORT QPlatformPrinterSupport
-{
-public:
-    QPlatformPrinterSupport();
-    virtual ~QPlatformPrinterSupport();
-
-    virtual QPrintEngine *createNativePrintEngine(QPrinter::PrinterMode printerMode);
-    virtual QPaintEngine *createPaintEngine(QPrintEngine *, QPrinter::PrinterMode printerMode);
-    virtual QList<QPrinter::PaperSize> supportedPaperSizes(const QPrinterInfo &) const;
-
-    virtual QList<QPrinterInfo> availablePrinters();
-    virtual QPrinterInfo defaultPrinter();
-
-    static QPrinter::PaperSize convertQSizeFToPaperSize(const QSizeF &sizef);
-    static QSizeF convertPaperSizeToQSizeF(QPrinter::PaperSize paperSize);
-
-protected:
-     static QPrinterInfo printerInfo(const QString &printerName, bool isDefault = false);
-     static void setPrinterInfoDefault(QPrinterInfo *p, bool isDefault);
-     static bool printerInfoIsDefault(const QPrinterInfo &p);
-     static int printerInfoCupsPrinterIndex(const QPrinterInfo &p);
-     static void setPrinterInfoCupsPrinterIndex(QPrinterInfo *p, int index);
-};
-
-#endif // QT_NO_PRINTER
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMPRINTINGSUPPORT_H
diff --git a/src/printsupport/kernel/qplatformprintplugin.cpp b/src/printsupport/kernel/qplatformprintplugin.cpp
index 2c87fcc..ec068d8 100644
--- a/src/printsupport/kernel/qplatformprintplugin.cpp
+++ b/src/printsupport/kernel/qplatformprintplugin.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformprintplugin_qpa.h"
+#include "qplatformprintplugin.h"
 #include "private/qfactoryloader_p.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/printsupport/kernel/qplatformprintplugin.h b/src/printsupport/kernel/qplatformprintplugin.h
new file mode 100644
index 0000000..aec3e02
--- /dev/null
+++ b/src/printsupport/kernel/qplatformprintplugin.h
@@ -0,0 +1,93 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMPRINTERSUPPORTPLUGIN_H
+#define QPLATFORMPRINTERSUPPORTPLUGIN_H
+
+//
+//  W A R N I N G
+//  -------------
+//
+// This file is not part of the Qt API.  It exists purely as an
+// implementation detail.  This header file may change from version to
+// version without notice, or even be removed.
+//
+// We mean it.
+//
+
+#include <QtCore/qplugin.h>
+#include <QtCore/qfactoryinterface.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QPlatformPrinterSupport;
+
+struct QPlatformPrinterSupportFactoryInterface : public QFactoryInterface
+{
+    virtual QPlatformPrinterSupport *create(const QString &key) = 0;
+};
+
+#define QPlatformPrinterSupportFactoryInterface_iid "org.qt-project.QPlatformPrinterSupportFactoryInterface"
+
+Q_DECLARE_INTERFACE(QPlatformPrinterSupportFactoryInterface, QPlatformPrinterSupportFactoryInterface_iid)
+
+class Q_PRINTSUPPORT_EXPORT QPlatformPrinterSupportPlugin : public QObject, public QPlatformPrinterSupportFactoryInterface
+{
+    Q_OBJECT
+    Q_INTERFACES(QPlatformPrinterSupportFactoryInterface:QFactoryInterface)
+public:
+    explicit QPlatformPrinterSupportPlugin(QObject *parent = 0);
+    ~QPlatformPrinterSupportPlugin();
+
+    virtual QStringList keys() const = 0;
+    virtual QPlatformPrinterSupport *create(const QString &key) = 0;
+
+    static QPlatformPrinterSupport *get();
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif // QPLATFORMPRINTERSUPPORTPLUGIN_H
diff --git a/src/printsupport/kernel/qplatformprintplugin_qpa.h b/src/printsupport/kernel/qplatformprintplugin_qpa.h
deleted file mode 100644
index aec3e02..0000000
--- a/src/printsupport/kernel/qplatformprintplugin_qpa.h
+++ /dev/null
@@ -1,93 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMPRINTERSUPPORTPLUGIN_H
-#define QPLATFORMPRINTERSUPPORTPLUGIN_H
-
-//
-//  W A R N I N G
-//  -------------
-//
-// This file is not part of the Qt API.  It exists purely as an
-// implementation detail.  This header file may change from version to
-// version without notice, or even be removed.
-//
-// We mean it.
-//
-
-#include <QtCore/qplugin.h>
-#include <QtCore/qfactoryinterface.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QPlatformPrinterSupport;
-
-struct QPlatformPrinterSupportFactoryInterface : public QFactoryInterface
-{
-    virtual QPlatformPrinterSupport *create(const QString &key) = 0;
-};
-
-#define QPlatformPrinterSupportFactoryInterface_iid "org.qt-project.QPlatformPrinterSupportFactoryInterface"
-
-Q_DECLARE_INTERFACE(QPlatformPrinterSupportFactoryInterface, QPlatformPrinterSupportFactoryInterface_iid)
-
-class Q_PRINTSUPPORT_EXPORT QPlatformPrinterSupportPlugin : public QObject, public QPlatformPrinterSupportFactoryInterface
-{
-    Q_OBJECT
-    Q_INTERFACES(QPlatformPrinterSupportFactoryInterface:QFactoryInterface)
-public:
-    explicit QPlatformPrinterSupportPlugin(QObject *parent = 0);
-    ~QPlatformPrinterSupportPlugin();
-
-    virtual QStringList keys() const = 0;
-    virtual QPlatformPrinterSupport *create(const QString &key) = 0;
-
-    static QPlatformPrinterSupport *get();
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif // QPLATFORMPRINTERSUPPORTPLUGIN_H
diff --git a/src/printsupport/kernel/qprintengine_win.cpp b/src/printsupport/kernel/qprintengine_win.cpp
index 37d2b27..3c079e2 100644
--- a/src/printsupport/kernel/qprintengine_win.cpp
+++ b/src/printsupport/kernel/qprintengine_win.cpp
@@ -54,7 +54,7 @@
 #include <qdebug.h>
 #include <qvector.h>
 #include <qpicture.h>
-#include <qplatformpixmap_qpa.h>
+#include <qpa/qplatformpixmap.h>
 #include <private/qpicture_p.h>
 #include <private/qpixmap_raster_p.h>
 
diff --git a/src/printsupport/kernel/qprinter.cpp b/src/printsupport/kernel/qprinter.cpp
index 6682550..4929b33 100644
--- a/src/printsupport/kernel/qprinter.cpp
+++ b/src/printsupport/kernel/qprinter.cpp
@@ -52,8 +52,8 @@
 
 #ifndef QT_NO_PRINTER
 
-#include "qplatformprintplugin_qpa.h"
-#include <QtPrintSupport/QPlatformPrinterSupport>
+#include <qpa/qplatformprintplugin.h>
+#include <qpa/qplatformprintersupport.h>
 #include <private/qpagedpaintdevice_p.h>
 
 #if defined(Q_WS_X11)
diff --git a/src/printsupport/kernel/qprinterinfo.cpp b/src/printsupport/kernel/qprinterinfo.cpp
index 8d498a7..3d0ba7f 100644
--- a/src/printsupport/kernel/qprinterinfo.cpp
+++ b/src/printsupport/kernel/qprinterinfo.cpp
@@ -30,8 +30,8 @@
 
 #ifndef QT_NO_PRINTER
 
-#include "qplatformprintplugin_qpa.h"
-#include <QtPrintSupport/QPlatformPrinterSupport>
+#include <qpa/qplatformprintplugin.h>
+#include <qpa/qplatformprintersupport.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/tools/uic/qclass_lib_map.h b/src/tools/uic/qclass_lib_map.h
index 34ce374..825813c 100644
--- a/src/tools/uic/qclass_lib_map.h
+++ b/src/tools/uic/qclass_lib_map.h
@@ -777,16 +777,6 @@ QT_CLASS_LIB(QWidgetItem, QtWidgets, qlayoutitem.h)
 QT_CLASS_LIB(QWidgetItemV2, QtWidgets, qlayoutitem.h)
 QT_CLASS_LIB(QPalette, QtGui, qpalette.h)
 QT_CLASS_LIB(QColorGroup, QtWidgets, qpalette.h)
-QT_CLASS_LIB(QPlatformCursorImage, QtGui, qplatformcursor_qpa.h)
-QT_CLASS_LIB(QPlatformCursorPrivate, QtGui, qplatformcursor_qpa.h)
-QT_CLASS_LIB(QPlatformCursor, QtGui, qplatformcursor_qpa.h)
-QT_CLASS_LIB(QPlatformOpenGLContext, QtGui, qplatformopenglcontext_qpa.h)
-QT_CLASS_LIB(QPlatformIntegration, QtGui, qplatformintegration_qpa.h)
-QT_CLASS_LIB(QPlatformIntegrationFactoryInterface, QtGui, qplatformintegrationplugin_qpa.h)
-QT_CLASS_LIB(QPlatformIntegrationPlugin, QtGui, qplatformintegrationplugin_qpa.h)
-QT_CLASS_LIB(QPlatformScreen, QtGui, qplatformscreen_qpa.h)
-QT_CLASS_LIB(QPlatformWindow, QtGui, qplatformwindow_qpa.h)
-QT_CLASS_LIB(QPlatformWindowFormat, QtGui, qplatformwindowformat_qpa.h)
 QT_CLASS_LIB(QSessionManager, QtGui, qsessionmanager.h)
 QT_CLASS_LIB(QShortcut, QtWidgets, qshortcut.h)
 QT_CLASS_LIB(QSizePolicy, QtWidgets, qsizepolicy.h)
@@ -915,8 +905,6 @@ QT_CLASS_LIB(QFontInfo, QtGui, qfontinfo.h)
 QT_CLASS_LIB(QFontMetrics, QtGui, qfontmetrics.h)
 QT_CLASS_LIB(QFontMetricsF, QtGui, qfontmetrics.h)
 QT_CLASS_LIB(QGlyphs, QtGui, qglyphs.h)
-QT_CLASS_LIB(QSupportedWritingSystems, QtGui, qplatformfontdatabase_qpa.h)
-QT_CLASS_LIB(QPlatformFontDatabase, QtGui, qplatformfontdatabase_qpa.h)
 QT_CLASS_LIB(QStaticText, QtGui, qstatictext.h)
 QT_CLASS_LIB(QSyntaxHighlighter, QtGui, qsyntaxhighlighter.h)
 QT_CLASS_LIB(QTextCursor, QtGui, qtextcursor.h)
diff --git a/src/widgets/dialogs/qdialog.cpp b/src/widgets/dialogs/qdialog.cpp
index 718d64b..82a7b1a 100644
--- a/src/widgets/dialogs/qdialog.cpp
+++ b/src/widgets/dialogs/qdialog.cpp
@@ -52,10 +52,10 @@
 #include "qwhatsthis.h"
 #include "qmenu.h"
 #include "qcursor.h"
-#include "qplatformtheme_qpa.h"
+#include <qpa/qplatformtheme.h>
 #include "private/qdialog_p.h"
 #include "private/qguiapplication_p.h"
-#include "qplatformtheme_qpa.h"
+#include <qpa/qplatformtheme.h>
 #ifndef QT_NO_ACCESSIBILITY
 #include "qaccessible.h"
 #endif
diff --git a/src/widgets/dialogs/qdialog_p.h b/src/widgets/dialogs/qdialog_p.h
index c40a885..8c53d6a 100644
--- a/src/widgets/dialogs/qdialog_p.h
+++ b/src/widgets/dialogs/qdialog_p.h
@@ -58,7 +58,7 @@
 #include "QtCore/qpointer.h"
 #include "QtWidgets/qdialog.h"
 #include "QtWidgets/qpushbutton.h"
-#include <QtGui/QPlatformDialogHelper>
+#include <qpa/qplatformdialoghelper.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/widgets/dialogs/qfontdialog_p.h b/src/widgets/dialogs/qfontdialog_p.h
index 75a9045..e7b0e91 100644
--- a/src/widgets/dialogs/qfontdialog_p.h
+++ b/src/widgets/dialogs/qfontdialog_p.h
@@ -57,7 +57,7 @@
 #include "private/qdialog_p.h"
 #include "qfontdatabase.h"
 #include "qfontdialog.h"
-#include "qplatformdialoghelper_qpa.h"
+#include <qpa/qplatformdialoghelper.h>
 #include "qsharedpointer.h"
 
 #ifndef QT_NO_FONTDIALOG
diff --git a/src/widgets/dialogs/qmessagebox.cpp b/src/widgets/dialogs/qmessagebox.cpp
index 92915b1..784748f 100644
--- a/src/widgets/dialogs/qmessagebox.cpp
+++ b/src/widgets/dialogs/qmessagebox.cpp
@@ -67,7 +67,7 @@
 
 #ifdef Q_OS_WIN
 #    include <QtCore/qt_windows.h>
-#    include <QtGui/QPlatformNativeInterface>
+#include <qpa/qplatformnativeinterface.h>
 #endif
 
 QT_BEGIN_NAMESPACE
diff --git a/src/widgets/dialogs/qwizard_win.cpp b/src/widgets/dialogs/qwizard_win.cpp
index 49450be..3e0aedc 100644
--- a/src/widgets/dialogs/qwizard_win.cpp
+++ b/src/widgets/dialogs/qwizard_win.cpp
@@ -45,7 +45,7 @@
 #include "qwizard_win_p.h"
 #include <private/qsystemlibrary_p.h>
 #include <private/qapplication_p.h>
-#include "qplatformnativeinterface_qpa.h"
+#include <qpa/qplatformnativeinterface.h>
 #include "qwizard.h"
 #include "qpaintengine.h"
 #include "qapplication.h"
diff --git a/src/widgets/itemviews/qitemdelegate.cpp b/src/widgets/itemviews/qitemdelegate.cpp
index bd9f451..a9bb727 100644
--- a/src/widgets/itemviews/qitemdelegate.cpp
+++ b/src/widgets/itemviews/qitemdelegate.cpp
@@ -44,7 +44,7 @@
 #ifndef QT_NO_ITEMVIEWS
 #include <qabstractitemmodel.h>
 #include <qapplication.h>
-#include <qplatformintegration_qpa.h>
+#include <qpa/qplatformintegration.h>
 #include <private/qguiapplication_p.h>
 #include <qbrush.h>
 #include <qlineedit.h>
diff --git a/src/widgets/itemviews/qstyleditemdelegate.cpp b/src/widgets/itemviews/qstyleditemdelegate.cpp
index 1196925..5732f65 100644
--- a/src/widgets/itemviews/qstyleditemdelegate.cpp
+++ b/src/widgets/itemviews/qstyleditemdelegate.cpp
@@ -44,7 +44,7 @@
 #ifndef QT_NO_ITEMVIEWS
 #include <qabstractitemmodel.h>
 #include <qapplication.h>
-#include <qplatformintegration_qpa.h>
+#include <qpa/qplatformintegration.h>
 #include <private/qguiapplication_p.h>
 #include <qbrush.h>
 #include <qlineedit.h>
diff --git a/src/widgets/kernel/kernel.pri b/src/widgets/kernel/kernel.pri
index 97430ba..9e3d82e 100644
--- a/src/widgets/kernel/kernel.pri
+++ b/src/widgets/kernel/kernel.pri
@@ -42,7 +42,7 @@ HEADERS += \
         kernel/qsoftkeymanager_common_p.h \
         kernel/qdesktopwidget_qpa_p.h \
         kernel/qwidgetwindow_qpa_p.h \
-        kernel/qplatformmenu_qpa.h
+        kernel/qplatformmenu.h
 
 SOURCES += \
 	kernel/qaction.cpp \
diff --git a/src/widgets/kernel/qapplication.cpp b/src/widgets/kernel/qapplication.cpp
index 734c737..369f9b9 100644
--- a/src/widgets/kernel/qapplication.cpp
+++ b/src/widgets/kernel/qapplication.cpp
@@ -72,7 +72,7 @@
 #include <QtWidgets/qgraphicsproxywidget.h>
 #include <QtGui/qstylehints.h>
 #include <QtGui/qinputmethod.h>
-#include <QtGui/qplatformtheme_qpa.h>
+#include <qpa/qplatformtheme.h>
 
 #include "private/qkeymapper_p.h"
 
@@ -92,7 +92,7 @@
 #include "qgesture.h"
 #include "private/qgesturemanager_p.h"
 #include "private/qguiapplication_p.h"
-#include "qplatformfontdatabase_qpa.h"
+#include <qpa/qplatformfontdatabase.h>
 #ifndef QT_NO_LIBRARY
 #include "qlibrary.h"
 #endif
diff --git a/src/widgets/kernel/qapplication_p.h b/src/widgets/kernel/qapplication_p.h
index b1f510c..9e92a6d 100644
--- a/src/widgets/kernel/qapplication_p.h
+++ b/src/widgets/kernel/qapplication_p.h
@@ -61,7 +61,7 @@
 #include "QtGui/qregion.h"
 #include "QtGui/qwindow.h"
 #include "qwidget.h"
-#include "QtGui/qplatformnativeinterface_qpa.h"
+#include <qpa/qplatformnativeinterface.h>
 #include "QtCore/qmutex.h"
 #include "QtCore/qtranslator.h"
 #include "QtCore/qbasictimer.h"
@@ -72,7 +72,7 @@
 #include <QTime>
 #include <QWindowSystemInterface>
 #include "private/qwindowsysteminterface_qpa_p.h"
-#include "QtGui/qplatformintegration_qpa.h"
+#include <qpa/qplatformintegration.h>
 #include "private/qguiapplication_p.h"
 
 QT_BEGIN_NAMESPACE
diff --git a/src/widgets/kernel/qapplication_qpa.cpp b/src/widgets/kernel/qapplication_qpa.cpp
index 0651d5b..998f06c 100644
--- a/src/widgets/kernel/qapplication_qpa.cpp
+++ b/src/widgets/kernel/qapplication_qpa.cpp
@@ -52,15 +52,15 @@
 #include "private/qevent_p.h"
 
 #include "qgenericpluginfactory_qpa.h"
-#include "private/qplatformintegrationfactory_qpa_p.h"
+#include <qpa/qplatformintegrationfactory_p.h>
 #include <qdesktopwidget.h>
-#include <QPlatformCursor>
-#include <QPlatformTheme>
+#include <qpa/qplatformcursor.h>
+#include <qpa/qplatformtheme.h>
 
 #include <qdebug.h>
 #include <QWindowSystemInterface>
 #include "private/qwindowsysteminterface_qpa_p.h"
-#include <QPlatformIntegration>
+#include <qpa/qplatformintegration.h>
 
 #include "qdesktopwidget_qpa_p.h"
 #include "qwidgetwindow_qpa_p.h"
diff --git a/src/widgets/kernel/qiconloader.cpp b/src/widgets/kernel/qiconloader.cpp
index e1828fd..38cee3e 100644
--- a/src/widgets/kernel/qiconloader.cpp
+++ b/src/widgets/kernel/qiconloader.cpp
@@ -48,7 +48,7 @@
 #include <QtWidgets/QApplication>
 #include <QtWidgets/QIconEnginePlugin>
 #include <QtGui/QPixmapCache>
-#include <QtGui/QPlatformTheme>
+#include <qpa/qplatformtheme.h>
 #include <QtWidgets/QIconEngine>
 #include <QtWidgets/QStyleOption>
 #include <QtCore/QList>
diff --git a/src/widgets/kernel/qplatformmenu.h b/src/widgets/kernel/qplatformmenu.h
new file mode 100644
index 0000000..cbd7eae
--- /dev/null
+++ b/src/widgets/kernel/qplatformmenu.h
@@ -0,0 +1,94 @@
+/****************************************************************************
+**
+** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/
+**
+** This file is part of the QtGui module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** GNU Lesser General Public License Usage
+** This file may be used under the terms of the GNU Lesser General Public
+** License version 2.1 as published by the Free Software Foundation and
+** appearing in the file LICENSE.LGPL included in the packaging of this
+** file. Please review the following information to ensure the GNU Lesser
+** General Public License version 2.1 requirements will be met:
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Nokia gives you certain additional
+** rights. These rights are described in the Nokia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU General
+** Public License version 3.0 as published by the Free Software Foundation
+** and appearing in the file LICENSE.GPL included in the packaging of this
+** file. Please review the following information to ensure the GNU General
+** Public License version 3.0 requirements will be met:
+** http://www.gnu.org/copyleft/gpl.html.
+**
+** Other Usage
+** Alternatively, this file may be used in accordance with the terms and
+** conditions contained in a signed written agreement between you and Nokia.
+**
+**
+**
+**
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMMENU_H
+#define QPLATFORMMENU_H
+
+#include <QtCore/qglobal.h>
+#include <QtCore/qpointer.h>
+#include <QtWidgets/qaction.h>
+
+QT_BEGIN_HEADER
+
+QT_BEGIN_NAMESPACE
+
+
+class QMenuPrivate;
+class Q_WIDGETS_EXPORT QPlatformMenuAction
+{
+public:
+    virtual ~QPlatformMenuAction();
+    QPointer<QAction> action;
+};
+
+class Q_WIDGETS_EXPORT QPlatformMenu {
+public:
+    QPlatformMenu();
+    virtual ~QPlatformMenu();
+
+    virtual bool merged(const QAction *action) const = 0;
+
+    virtual void addAction(QAction *action, QAction *before) = 0;
+    virtual void removeAction(QAction *action) = 0;
+    virtual void syncAction(QAction *action) = 0;
+
+    virtual void setMenuEnabled(bool enable);
+    virtual void syncSeparatorsCollapsible(bool enable);
+};
+
+class Q_WIDGETS_EXPORT QPlatformMenuBar {
+public:
+    QPlatformMenuBar();
+    virtual ~QPlatformMenuBar();
+
+    virtual void addAction(QAction *action, QAction *before = 0) = 0;
+    virtual void syncAction(QAction *action) = 0;
+    virtual void removeAction(QAction *action) = 0;
+
+    virtual void handleReparent(QWidget *newParent);
+};
+
+QT_END_NAMESPACE
+
+QT_END_HEADER
+
+#endif
+
diff --git a/src/widgets/kernel/qplatformmenu_qpa.cpp b/src/widgets/kernel/qplatformmenu_qpa.cpp
index 95a70d9..f28560e 100644
--- a/src/widgets/kernel/qplatformmenu_qpa.cpp
+++ b/src/widgets/kernel/qplatformmenu_qpa.cpp
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include "qplatformmenu_qpa.h"
+#include "qplatformmenu.h"
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/widgets/kernel/qplatformmenu_qpa.h b/src/widgets/kernel/qplatformmenu_qpa.h
deleted file mode 100644
index cbd7eae..0000000
--- a/src/widgets/kernel/qplatformmenu_qpa.h
+++ /dev/null
@@ -1,94 +0,0 @@
-/****************************************************************************
-**
-** Copyright (C) 2012 Nokia Corporation and/or its subsidiary(-ies).
-** Contact: http://www.qt-project.org/
-**
-** This file is part of the QtGui module of the Qt Toolkit.
-**
-** $QT_BEGIN_LICENSE:LGPL$
-** GNU Lesser General Public License Usage
-** This file may be used under the terms of the GNU Lesser General Public
-** License version 2.1 as published by the Free Software Foundation and
-** appearing in the file LICENSE.LGPL included in the packaging of this
-** file. Please review the following information to ensure the GNU Lesser
-** General Public License version 2.1 requirements will be met:
-** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
-**
-** In addition, as a special exception, Nokia gives you certain additional
-** rights. These rights are described in the Nokia Qt LGPL Exception
-** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
-**
-** GNU General Public License Usage
-** Alternatively, this file may be used under the terms of the GNU General
-** Public License version 3.0 as published by the Free Software Foundation
-** and appearing in the file LICENSE.GPL included in the packaging of this
-** file. Please review the following information to ensure the GNU General
-** Public License version 3.0 requirements will be met:
-** http://www.gnu.org/copyleft/gpl.html.
-**
-** Other Usage
-** Alternatively, this file may be used in accordance with the terms and
-** conditions contained in a signed written agreement between you and Nokia.
-**
-**
-**
-**
-**
-**
-** $QT_END_LICENSE$
-**
-****************************************************************************/
-
-#ifndef QPLATFORMMENU_H
-#define QPLATFORMMENU_H
-
-#include <QtCore/qglobal.h>
-#include <QtCore/qpointer.h>
-#include <QtWidgets/qaction.h>
-
-QT_BEGIN_HEADER
-
-QT_BEGIN_NAMESPACE
-
-
-class QMenuPrivate;
-class Q_WIDGETS_EXPORT QPlatformMenuAction
-{
-public:
-    virtual ~QPlatformMenuAction();
-    QPointer<QAction> action;
-};
-
-class Q_WIDGETS_EXPORT QPlatformMenu {
-public:
-    QPlatformMenu();
-    virtual ~QPlatformMenu();
-
-    virtual bool merged(const QAction *action) const = 0;
-
-    virtual void addAction(QAction *action, QAction *before) = 0;
-    virtual void removeAction(QAction *action) = 0;
-    virtual void syncAction(QAction *action) = 0;
-
-    virtual void setMenuEnabled(bool enable);
-    virtual void syncSeparatorsCollapsible(bool enable);
-};
-
-class Q_WIDGETS_EXPORT QPlatformMenuBar {
-public:
-    QPlatformMenuBar();
-    virtual ~QPlatformMenuBar();
-
-    virtual void addAction(QAction *action, QAction *before = 0) = 0;
-    virtual void syncAction(QAction *action) = 0;
-    virtual void removeAction(QAction *action) = 0;
-
-    virtual void handleReparent(QWidget *newParent);
-};
-
-QT_END_NAMESPACE
-
-QT_END_HEADER
-
-#endif
-
diff --git a/src/widgets/kernel/qwhatsthis.cpp b/src/widgets/kernel/qwhatsthis.cpp
index 5df69be..907a29f 100644
--- a/src/widgets/kernel/qwhatsthis.cpp
+++ b/src/widgets/kernel/qwhatsthis.cpp
@@ -55,7 +55,7 @@
 #include "qcursor.h"
 #include "qbitmap.h"
 #include "qtextdocument.h"
-#include "qplatformtheme_qpa.h"
+#include <qpa/qplatformtheme.h>
 #include "private/qtextdocumentlayout_p.h"
 #include "qtoolbutton.h"
 #include "qdebug.h"
diff --git a/src/widgets/kernel/qwidget.cpp b/src/widgets/kernel/qwidget.cpp
index 9abba54..dcd052a 100644
--- a/src/widgets/kernel/qwidget.cpp
+++ b/src/widgets/kernel/qwidget.cpp
@@ -67,7 +67,7 @@
 # include "qtoolbar.h"
 # include <private/qmainwindowlayout_p.h>
 #endif
-#include "qplatformwindow_qpa.h"
+#include <qpa/qplatformwindow.h>
 #include "private/qwidgetwindow_qpa_p.h"
 #include "qpainter.h"
 #include "qtooltip.h"
diff --git a/src/widgets/kernel/qwidget_qpa.cpp b/src/widgets/kernel/qwidget_qpa.cpp
index a817545..97cf921 100644
--- a/src/widgets/kernel/qwidget_qpa.cpp
+++ b/src/widgets/kernel/qwidget_qpa.cpp
@@ -47,12 +47,12 @@
 #include "private/qwidgetwindow_qpa_p.h"
 #include "private/qapplication_p.h"
 #include "QtWidgets/qdesktopwidget.h"
-#include "QtGui/qplatformwindow_qpa.h"
+#include <qpa/qplatformwindow.h>
 #include "QtGui/qsurfaceformat.h"
-#include "QtGui/qplatformopenglcontext_qpa.h"
+#include <qpa/qplatformopenglcontext.h>
 #include "QtGui/private/qwindow_p.h"
 
-#include <QtGui/QPlatformCursor>
+#include <qpa/qplatformcursor.h>
 #include <QtGui/QGuiApplication>
 #include <QtGui/QScreen>
 
diff --git a/src/widgets/styles/qcommonstyle.cpp b/src/widgets/styles/qcommonstyle.cpp
index b2b1d3f..3de94a8 100644
--- a/src/widgets/styles/qcommonstyle.cpp
+++ b/src/widgets/styles/qcommonstyle.cpp
@@ -45,7 +45,7 @@
 #include <qfile.h>
 #include <qapplication.h>
 #include <private/qguiapplication_p.h>
-#include <qplatformtheme_qpa.h>
+#include <qpa/qplatformtheme.h>
 #include <qbitmap.h>
 #include <qcache.h>
 #include <qdockwidget.h>
diff --git a/src/widgets/styles/qmacstyle_mac.mm b/src/widgets/styles/qmacstyle_mac.mm
index 05bd90a..662f0e2 100644
--- a/src/widgets/styles/qmacstyle_mac.mm
+++ b/src/widgets/styles/qmacstyle_mac.mm
@@ -100,7 +100,7 @@
 #include <QtWidgets/qgraphicsproxywidget.h>
 #include <QtWidgets/qgraphicsview.h>
 #include <private/qstylehelper_p.h>
-#include <QtGui/QPlatformFontDatabase>
+#include <qpa/qplatformfontdatabase.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/widgets/styles/qwindowsvistastyle.cpp b/src/widgets/styles/qwindowsvistastyle.cpp
index 6fce426..bcb24db 100644
--- a/src/widgets/styles/qwindowsvistastyle.cpp
+++ b/src/widgets/styles/qwindowsvistastyle.cpp
@@ -46,7 +46,7 @@
 #include <private/qstylehelper_p.h>
 #include <private/qsystemlibrary_p.h>
 #include <private/qapplication_p.h>
-#include <qplatformnativeinterface_qpa.h>
+#include <qpa/qplatformnativeinterface.h>
 
 #if !defined(QT_NO_STYLE_WINDOWSVISTA) || defined(QT_PLUGIN)
 
diff --git a/src/widgets/styles/qwindowsxpstyle.cpp b/src/widgets/styles/qwindowsxpstyle.cpp
index 18f1380..18a28bc 100644
--- a/src/widgets/styles/qwindowsxpstyle.cpp
+++ b/src/widgets/styles/qwindowsxpstyle.cpp
@@ -46,7 +46,7 @@
 #include <private/qobject_p.h>
 #include <private/qpaintengine_raster_p.h>
 #include <private/qapplication_p.h>
-#include <qplatformnativeinterface_qpa.h>
+#include <qpa/qplatformnativeinterface.h>
 #include <private/qstylehelper_p.h>
 #include <private/qwidget_p.h>
 #include <private/qsystemlibrary_p.h>
diff --git a/src/widgets/util/qsystemtrayicon_win.cpp b/src/widgets/util/qsystemtrayicon_win.cpp
index fa72e79..84becf4 100644
--- a/src/widgets/util/qsystemtrayicon_win.cpp
+++ b/src/widgets/util/qsystemtrayicon_win.cpp
@@ -52,7 +52,7 @@
 
 #include <private/qsystemlibrary_p.h>
 #include <private/qguiapplication_p.h>
-#include <QPlatformNativeInterface>
+#include <qpa/qplatformnativeinterface.h>
 #include <QSettings>
 #include <QDebug>
 #include <QHash>
diff --git a/src/widgets/util/qsystemtrayicon_x11.cpp b/src/widgets/util/qsystemtrayicon_x11.cpp
index 174c39d..e58d0d9 100644
--- a/src/widgets/util/qsystemtrayicon_x11.cpp
+++ b/src/widgets/util/qsystemtrayicon_x11.cpp
@@ -54,7 +54,7 @@
 #include <qguiapplication.h>
 #include <qscreen.h>
 #include <qbackingstore.h>
-#include <qplatformnativeinterface_qpa.h>
+#include <qpa/qplatformnativeinterface.h>
 #include <qdebug.h>
 
 #include <X11/Xlib.h>
diff --git a/src/widgets/widgets/qcombobox.cpp b/src/widgets/widgets/qcombobox.cpp
index bea4061..6a8e7b4 100644
--- a/src/widgets/widgets/qcombobox.cpp
+++ b/src/widgets/widgets/qcombobox.cpp
@@ -43,7 +43,7 @@
 
 #ifndef QT_NO_COMBOBOX
 #include <qstylepainter.h>
-#include <qplatformtheme_qpa.h>
+#include <qpa/qplatformtheme.h>
 #include <qlineedit.h>
 #include <qapplication.h>
 #include <qdesktopwidget.h>
diff --git a/src/widgets/widgets/qmenu.cpp b/src/widgets/widgets/qmenu.cpp
index 2abd4ce..5dc26f6 100644
--- a/src/widgets/widgets/qmenu.cpp
+++ b/src/widgets/widgets/qmenu.cpp
@@ -49,7 +49,7 @@
 #include "qtimer.h"
 #include "qlayout.h"
 #include "qpainter.h"
-#include "qplatformtheme_qpa.h"
+#include <qpa/qplatformtheme.h>
 #include "qapplication.h"
 #include "qdesktopwidget.h"
 #ifndef QT_NO_ACCESSIBILITY
@@ -71,7 +71,7 @@
 #include <private/qaction_p.h>
 #include <private/qsoftkeymanager_p.h>
 #include <private/qguiapplication_p.h>
-#include <qplatformtheme_qpa.h>
+#include <qpa/qplatformtheme.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/widgets/widgets/qmenu_p.h b/src/widgets/widgets/qmenu_p.h
index d637a9b..692fd19 100644
--- a/src/widgets/widgets/qmenu_p.h
+++ b/src/widgets/widgets/qmenu_p.h
@@ -61,7 +61,7 @@
 #include "QtCore/qbasictimer.h"
 #include "private/qwidget_p.h"
 
-#include <qplatformmenu_qpa.h>
+#include <qpa/qplatformmenu.h>
 
 QT_BEGIN_NAMESPACE
 
diff --git a/src/widgets/widgets/qmenubar.cpp b/src/widgets/widgets/qmenubar.cpp
index c9818e0..11ae61f 100644
--- a/src/widgets/widgets/qmenubar.cpp
+++ b/src/widgets/widgets/qmenubar.cpp
@@ -55,7 +55,7 @@
 #include <qtoolbar.h>
 #include <qtoolbutton.h>
 #include <qwhatsthis.h>
-#include <qplatformtheme_qpa.h>
+#include <qpa/qplatformtheme.h>
 #include "private/qguiapplication_p.h"
 
 #ifndef QT_NO_MENUBAR
diff --git a/src/widgets/widgets/qwidgetlinecontrol.cpp b/src/widgets/widgets/qwidgetlinecontrol.cpp
index 017cbee..6347593 100644
--- a/src/widgets/widgets/qwidgetlinecontrol.cpp
+++ b/src/widgets/widgets/qwidgetlinecontrol.cpp
@@ -46,7 +46,7 @@
 #include "qabstractitemview.h"
 #include "qclipboard.h"
 #include <private/qguiapplication_p.h>
-#include <qplatformtheme_qpa.h>
+#include <qpa/qplatformtheme.h>
 #include <qstylehints.h>
 #ifndef QT_NO_ACCESSIBILITY
 #include "qaccessible.h"
diff --git a/sync.profile b/sync.profile
index cc681b0..362118a 100644
--- a/sync.profile
+++ b/sync.profile
@@ -68,6 +68,82 @@
     "QtConcurrent" => "$basedir/src/modules/qt_concurrent.pri",
     "QtPlatformSupport" => "$basedir/src/modules/qt_platformsupport.pri",
 );
+%deprecatedheaders = (
+    "QtGui" =>  {
+        "qplatformaccessibility_qpa.h" => "qpa/qplatformaccessibility.h",
+        "QPlatformAccessibility" => "qpa/qplatformaccessibility.h",
+        "qplatformbackingstore_qpa.h" => "qpa/qplatformbackingstore.h",
+        "QPlatformBackingStore" => "qpa/qplatformbackingstore.h",
+        "qplatformclipboard_qpa.h" => "qpa/qplatformclipboard.h",
+        "QPlatformClipboard" => "qpa/qplatformclipboard.h",
+        "QPlatformColorDialogHelper" => "qpa/qplatformdialoghelper.h",
+        "qplatformcursor_qpa.h" => "qpa/qplatformcursor.h",
+        "QPlatformCursor" => "qpa/qplatformcursor.h",
+        "QPlatformCursorImage" => "qpa/qplatformcursor.h",
+        "QPlatformCursorPrivate" => "qpa/qplatformcursor.h",
+        "qplatformdrag_qpa.h" => "qpa/qplatformdrag.h",
+        "QPlatformDrag" => "qpa/qplatformdrag.h",
+        "QPlatformDragQtResponse" => "qpa/qplatformdrag.h",
+        "QPlatformDropQtResponse" => "qpa/qplatformdrag.h",
+        "qplatformdialoghelper_qpa.h" => "qpa/qplatformdialoghelper.h",
+        "QPlatformDialogHelper" => "qpa/qplatformdialoghelper.h",
+        "QPlatformFileDialogHelper" => "qpa/qplatformdialoghelper.h",
+        "qplatformfontdatabase_qpa.h" => "qpa/qplatformfontdatabase.h",
+        "QPlatformFontDatabase" => "qpa/qplatformfontdatabase.h",
+        "qplatforminputcontext_qpa.h" => "qpa/qplatforminputcontext.h",
+        "QPlatformInputContext" => "qpa/qplatforminputcontext.h",
+        "qplatforminputcontext_qpa_p.h" => "qpa/qplatforminputcontext_p.h",
+        "qplatformintegration_qpa.h" => "qpa/qplatformintegration.h",
+        "QPlatformIntegration" => "qpa/qplatformintegration.h",
+        "qplatformintegrationfactory_qpa_p.h" => "qpa/qplatformintegrationfactory_p.h",
+        "QPlatformIntegrationFactory" => "qpa/qplatformintegrationfactory_p.h",
+        "qplatformintegrationplugin_qpa.h" => "qpa/qplatformintegrationplugin.h",
+        "QPlatformIntegrationPlugin" => "qpa/qplatformintegrationplugin.h",
+        "qplatformnativeinterface_qpa.h" => "qpa/qplatformnativeinterface.h",
+        "QPlatformNativeInterface" => "qpa/qplatformnativeinterface.h",
+        "qplatformopenglcontext_qpa.h" => "qpa/qplatformopenglcontext.h",
+        "QPlatformOpenGLContext" => "qpa/qplatformopenglcontext.h",
+        "qplatformpixmap_qpa.h" => "qpa/qplatformpixmap.h",
+        "QPlatformPixmap" => "qpa/qplatformpixmap.h",
+        "qplatformscreen_qpa.h" => "qpa/qplatformscreen.h",
+        "QPlatformScreen" => "qpa/qplatformscreen.h",
+        "qplatformscreen_qpa_p.h" => "qpa/qplatformscreen_p.h",
+        "QPlatformScreenBuffer" => "qpa/qplatformscreenpageflipper.h",
+        "qplatformscreenpageflipper_qpa.h" => "qpa/qplatformscreenpageflipper.h",
+        "QPlatformScreenPageFlipper" => "qpa/qplatformscreenpageflipper.h",
+        "qplatformservices_qpa.h" => "qpa/qplatformservices.h",
+        "QPlatformServices" => "qpa/qplatformservices.h",
+        "qplatformsharedgraphicscache_qpa.h" => "qpa/qplatformsharedgraphicscache.h",
+        "QPlatformSharedGraphicsCache" => "qpa/qplatformsharedgraphicscache.h",
+        "qplatformsurface_qpa.h" => "qpa/qplatformsurface.h",
+        "QPlatformSurface" => "qpa/qplatformsurface.h",
+        "qplatformtheme_qpa.h" => "qpa/qplatformtheme.h",
+        "QPlatformTheme" => "qpa/qplatformtheme.h",
+        "qplatformthemefactory_qpa_p.h" => "qpa/qplatformthemefactory_p.h",
+        "qplatformthemeplugin_qpa.h" => "qpa/qplatformthemeplugin.h",
+        "QPlatformThemePlugin" => "qpa/qplatformthemeplugin.h",
+        "qplatformwindow_qpa.h" => "qpa/qplatformwindow.h",
+        "QPlatformWindow" => "qpa/qplatformwindow.h"
+    },
+    "QtWidgets" => {
+        "qplatformmenu_qpa.h" => "qpa/qplatformmenu.h",
+        "QPlatformMenu" => "qpa/qplatformmenu.h",
+        "QPlatformMenuAction" => "qpa/qplatformmenu.h",
+        "QPlatformMenuBar" => "qpa/qplatformmenu.h"
+    },
+    "QtPrintSupport" => {
+        "qplatformprintersupport_qpa.h" => "qpa/qplatformprintersupport.h",
+        "QPlatformPrinterSupport" => "qpa/qplatformprintersupport.h",
+        "QPlatformPrinterSupportPlugin" => "XXXXXXXXXXXXXXXXXXXX",
+        "qplatformprintplugin_qpa.h" => "qpa/qplatformprintplugin.h",
+        "QPlatformPrintPlugin" => "qpa/qplatformprintplugin.h"
+    },
+    "QtPlatformSupport" => {
+        "qplatforminputcontextfactory_qpa_p.h" => "qpa/qplatforminputcontextfactory_p.h",
+        "qplatforminputcontextplugin_qpa_p.h" => "qpa/qplatforminputcontextplugin_p.h",
+        "QPlatformInputContextPlugin" => "qpa/qplatforminputcontextplugin_p.h"
+    }
+);
 %explicitheaders = (
     "QtCore" => {
         "QVariantHash" => "qvariant.h",
diff --git a/tests/auto/gui/image/qpixmap/tst_qpixmap.cpp b/tests/auto/gui/image/qpixmap/tst_qpixmap.cpp
index c7652e4..eeac564 100644
--- a/tests/auto/gui/image/qpixmap/tst_qpixmap.cpp
+++ b/tests/auto/gui/image/qpixmap/tst_qpixmap.cpp
@@ -50,8 +50,8 @@
 #include <qpaintengine.h>
 #include <qsplashscreen.h>
 
-#include <qplatformpixmap_qpa.h>
-#include <qplatformintegration_qpa.h>
+#include <qpa/qplatformpixmap.h>
+#include <qpa/qplatformintegration.h>
 #include <private/qguiapplication_p.h>
 #include <private/qdrawhelper_p.h>
 
diff --git a/tests/auto/gui/kernel/qinputmethod/tst_qinputmethod.cpp b/tests/auto/gui/kernel/qinputmethod/tst_qinputmethod.cpp
index cfe26d2..5bbd495 100644
--- a/tests/auto/gui/kernel/qinputmethod/tst_qinputmethod.cpp
+++ b/tests/auto/gui/kernel/qinputmethod/tst_qinputmethod.cpp
@@ -43,7 +43,7 @@
 
 #include <private/qguiapplication_p.h>
 #include <private/qinputmethod_p.h>
-#include <qplatforminputcontext_qpa.h>
+#include <qpa/qplatforminputcontext.h>
 #include "../../../shared/platforminputcontext.h"
 
 class InputItem : public QObject
diff --git a/tests/auto/gui/kernel/qkeysequence/tst_qkeysequence.cpp b/tests/auto/gui/kernel/qkeysequence/tst_qkeysequence.cpp
index 5885845..766352f 100644
--- a/tests/auto/gui/kernel/qkeysequence/tst_qkeysequence.cpp
+++ b/tests/auto/gui/kernel/qkeysequence/tst_qkeysequence.cpp
@@ -42,7 +42,7 @@
 
 #include <QtTest/QtTest>
 #include <qkeysequence.h>
-#include <qplatformtheme_qpa.h>
+#include <qpa/qplatformtheme.h>
 #include <private/qkeysequence_p.h>
 #include <private/qguiapplication_p.h>
 #include <QTranslator>
diff --git a/tests/auto/opengl/qgl/tst_qgl.cpp b/tests/auto/opengl/qgl/tst_qgl.cpp
index 051e26f..5da44df 100644
--- a/tests/auto/opengl/qgl/tst_qgl.cpp
+++ b/tests/auto/opengl/qgl/tst_qgl.cpp
@@ -55,7 +55,7 @@
 #include <QVBoxLayout>
 
 #ifdef QT_BUILD_INTERNAL
-#include <qplatformpixmap_qpa.h>
+#include <qpa/qplatformpixmap.h>
 #include <QtOpenGL/private/qgl_p.h>
 #include <QtGui/private/qimage_p.h>
 #include <QtGui/private/qimagepixmapcleanuphooks_p.h>
diff --git a/tests/auto/other/languagechange/tst_languagechange.cpp b/tests/auto/other/languagechange/tst_languagechange.cpp
index 663f2ef..38f58fd 100644
--- a/tests/auto/other/languagechange/tst_languagechange.cpp
+++ b/tests/auto/other/languagechange/tst_languagechange.cpp
@@ -49,7 +49,7 @@
 #include <QtCore/QTranslator>
 #include <QtCore/QTemporaryDir>
 #include <private/qthread_p.h>
-#include <QtGui/QPlatformTheme>
+#include <qpa/qplatformtheme.h>
 #include <QtWidgets/QInputDialog>
 #include <QtWidgets/QColorDialog>
 #include <QtWidgets/QDialogButtonBox>
diff --git a/tests/auto/shared/platforminputcontext.h b/tests/auto/shared/platforminputcontext.h
index 2049ec7..b7f7e2b 100644
--- a/tests/auto/shared/platforminputcontext.h
+++ b/tests/auto/shared/platforminputcontext.h
@@ -39,7 +39,7 @@
 **
 ****************************************************************************/
 
-#include <qplatforminputcontext_qpa.h>
+#include <qpa/qplatforminputcontext.h>
 
 class PlatformInputContext : public QPlatformInputContext
 {
diff --git a/tests/auto/widgets/dialogs/qmessagebox/tst_qmessagebox.cpp b/tests/auto/widgets/dialogs/qmessagebox/tst_qmessagebox.cpp
index 1d391a1..6c91bb7 100644
--- a/tests/auto/widgets/dialogs/qmessagebox/tst_qmessagebox.cpp
+++ b/tests/auto/widgets/dialogs/qmessagebox/tst_qmessagebox.cpp
@@ -48,7 +48,7 @@
 #include <QApplication>
 #include <QPushButton>
 #include <QDialogButtonBox>
-#include <QPlatformTheme>
+#include <qpa/qplatformtheme.h>
 #include <private/qguiapplication_p.h>
 #if defined(Q_OS_MAC) && !defined(QT_NO_STYLE_MAC)
 #include <QMacStyle>
diff --git a/tests/auto/widgets/itemviews/qlistview/tst_qlistview.cpp b/tests/auto/widgets/itemviews/qlistview/tst_qlistview.cpp
index be649db..a6330aa 100644
--- a/tests/auto/widgets/itemviews/qlistview/tst_qlistview.cpp
+++ b/tests/auto/widgets/itemviews/qlistview/tst_qlistview.cpp
@@ -57,7 +57,7 @@
 #if defined(Q_OS_WIN) || defined(Q_OS_WINCE)
 #  include <windows.h>
 #  include <QtGui/QGuiApplication>
-#  include <QtGui/QPlatformNativeInterface>
+#include <qpa/qplatformnativeinterface.h>
 #endif // Q_OS_WIN
 
 #if defined(Q_OS_WIN) || defined(Q_OS_WINCE)
diff --git a/tests/auto/widgets/kernel/qaction/tst_qaction.cpp b/tests/auto/widgets/kernel/qaction/tst_qaction.cpp
index 51123af..71f655b 100644
--- a/tests/auto/widgets/kernel/qaction/tst_qaction.cpp
+++ b/tests/auto/widgets/kernel/qaction/tst_qaction.cpp
@@ -46,7 +46,7 @@
 #include <qevent.h>
 #include <qaction.h>
 #include <qmenu.h>
-#include <qplatformtheme_qpa.h>
+#include <qpa/qplatformtheme.h>
 #include <private/qguiapplication_p.h>
 
 class tst_QAction : public QObject
diff --git a/tests/auto/widgets/kernel/qwidget/tst_qwidget.cpp b/tests/auto/widgets/kernel/qwidget/tst_qwidget.cpp
index 6e88c6e..710b817 100644
--- a/tests/auto/widgets/kernel/qwidget/tst_qwidget.cpp
+++ b/tests/auto/widgets/kernel/qwidget/tst_qwidget.cpp
@@ -83,8 +83,8 @@
 #ifdef Q_OS_WIN
 #  include <QtCore/qt_windows.h>
 #  include <QtGui/private/qguiapplication_p.h>
-#  include <QtGui/QPlatformNativeInterface>
-#  include <QtGui/QPlatformIntegration>
+#include <qpa/qplatformnativeinterface.h>
+#include <qpa/qplatformintegration.h>
 
 static HWND winHandleOf(const QWidget *w)
 {
diff --git a/tests/auto/widgets/widgets/qcombobox/tst_qcombobox.cpp b/tests/auto/widgets/widgets/qcombobox/tst_qcombobox.cpp
index 90b5a88..18a8666 100644
--- a/tests/auto/widgets/widgets/qcombobox/tst_qcombobox.cpp
+++ b/tests/auto/widgets/widgets/qcombobox/tst_qcombobox.cpp
@@ -44,7 +44,7 @@
 #include "qcombobox.h"
 #include <private/qcombobox_p.h>
 #include <private/qguiapplication_p.h>
-#include <qplatformtheme_qpa.h>
+#include <qpa/qplatformtheme.h>
 
 #include <qfontcombobox.h>
 #include <qdesktopwidget.h>
diff --git a/tests/auto/widgets/widgets/qlineedit/tst_qlineedit.cpp b/tests/auto/widgets/widgets/qlineedit/tst_qlineedit.cpp
index 22e05a8..91827ec 100644
--- a/tests/auto/widgets/widgets/qlineedit/tst_qlineedit.cpp
+++ b/tests/auto/widgets/widgets/qlineedit/tst_qlineedit.cpp
@@ -48,7 +48,7 @@
 #include "qvalidator.h"
 #include "qcompleter.h"
 #include "qstandarditemmodel.h"
-#include "qplatformtheme_qpa.h"
+#include <qpa/qplatformtheme.h>
 #include "qstylehints.h"
 #include <private/qguiapplication_p.h>