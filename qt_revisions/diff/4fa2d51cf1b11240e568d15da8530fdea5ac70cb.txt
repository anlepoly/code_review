diff --git a/tests/auto/corelib/kernel/qobject/tst_qobject.cpp b/tests/auto/corelib/kernel/qobject/tst_qobject.cpp
index 81d0c95..dec34a8 100644
--- a/tests/auto/corelib/kernel/qobject/tst_qobject.cpp
+++ b/tests/auto/corelib/kernel/qobject/tst_qobject.cpp
@@ -3364,7 +3364,7 @@ void tst_QObject::deleteQObjectWhenDeletingEvent()
     };
 
     QObject o;
-    QGuiApplication::postEvent(&o, new MyEvent);
+    QCoreApplication::postEvent(&o, new MyEvent);
     QCoreApplication::removePostedEvents(&o); // here you would get a deadlock
 }
 
diff --git a/tests/auto/corelib/kernel/qobject/tst_qobject.pro b/tests/auto/corelib/kernel/qobject/tst_qobject.pro
index e138526..d74f2bc 100644
--- a/tests/auto/corelib/kernel/qobject/tst_qobject.pro
+++ b/tests/auto/corelib/kernel/qobject/tst_qobject.pro
@@ -1,6 +1,6 @@
-CONFIG += testcase
+CONFIG += testcase console
 TARGET = tst_qobject
-QT = core-private network gui testlib
+QT = core-private network testlib
 SOURCES = tst_qobject.cpp
 
 # this is here for a reason, moc_oldnormalizedobject.cpp is not auto-generated, it was generated by